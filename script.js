(function(){var la={"0.js":"basis.data","1.js":"basis.event","2.js":"basis.entity","3.js":"basis.data.dataset","4.js":"basis.utils.info","5.js":"basis.utils.benchmark","6.js":"basis.utils.highlight"},ka={"0.css":"","0.js":function(h,A,d,D,J,u,H,X){function z(b,da){return function(){b.apply(this,arguments);da.apply(this,arguments)}}function E(b){var da=I[b];if(!da)for(var m=[],a={},c=1,da=I[b]={actions:m,handler:a};b;){if(b&1){var f=N[c];m.push(f.action);for(var e in f.handler)a[e]=a[e]?z(a[e],f.handler[e]):
f.handler[e]}c<<=1;b>>=1}return da}function Q(b,a){for(;a&&a!==b&&a!==a.delegate;)a=a.delegate;return a===b}function L(b,a,m){var c=b.delegate;c&&(b.root=c.root,b.target=c.target,b.data=c.data,b.state=c.state);if(b.root!==a){if(c=b.listen.root)a&&a!==b&&a.removeHandler(c,b),b.root&&b.root!==b&&b.root.addHandler(c,b);b.emit_rootChanged(a)}if(b.target!==m){if(c=b.listen.target)m&&m!==b&&m.removeHandler(c,b),b.target&&b.target!==b&&b.target.addHandler(c,b);b.emit_targetChanged(m)}for(b=b.delegates_;b;)b.delegate&&
L(b.delegate,a,m),b=b.next}function Y(b,a){var m={},c;b&&b.length&&(c=m.inserted=b);a&&a.length&&(c=m.deleted=a);if(c)return m}function R(b,a){if(b&&b.itemCount){if(a&&a.itemCount){var m=[],c=[],e;for(e in b.items_){var f=b.items_[e];!1==f.basisObjectId in a.items_&&c.push(f)}for(e in a.items_)f=a.items_[e],!1==f.basisObjectId in b.items_&&m.push(f);return Y(m,c)}if(b.itemCount)return{deleted:b.getItems()}}else if(a&&a.itemCount)return{inserted:a.getItems()}}function y(b,a,m,c){var f=b[c]||null,e=
null;"function"==typeof m&&(m=m.call(b,b));m instanceof S&&(e=new Z(b,a,m,$),m=m.dataset);m instanceof d.Token&&(m=T.from(m));m instanceof T&&(e=new Z(b,a,m,ga),m=y(e,e.proxy,m.value,"adapter_"));!1==m instanceof ca&&(m=null);c&&f!==e&&(f&&(f.source.removeHandler(f.handler,f),f.adapter_&&y(f,null,null,"adapter_")),e&&e.source.addHandler(e.handler,e),b[c]=e);return m}function t(b){return Array.isArray(b)?b.map(function(b){return{data:b}}):{data:b}}function g(b){b&&b.constructor===Object||(b={value:b});
return new w({data:b})}d.require("./1.js");D=this.path;J=d.Class;var v=d.cleaner,F=d.object.values;H=d.fn.$self;var n=d.event.Emitter;u=d.event.create;var C=d.event.events,B={},U=[],q={},r={priority:[],values:{},add:function(b,a){var m=b.toLowerCase();r[b]=m;q[m]=b;this.values[m]=b;a=a?this.priority.indexOf(a):-1;-1==a?this.priority.push(m):this.priority.splice(a,0,m)},getList:function(){return F(q)}};r.add("READY");r.add("DEPRECATED");r.add("UNDEFINED");r.add("ERROR");r.add("PROCESSING");var N={},
M=1,G={NONE:0,ALL:0,link:function(b,a,m){b+=a.basisObjectId;var c=m.subscribers_;c||(c=m.subscribers_={});c[b]||(c[b]=a,1==(m.subscriberCount+=1)&&m.emit_subscribersChanged(1))},unlink:function(b,a,m){b+=a.basisObjectId;(a=m.subscribers_)&&a[b]&&(delete a[b],0==(m.subscriberCount-=1)&&(m.emit_subscribersChanged(-1),m.subscribers_=null))},add:function(b,a,m){N[M]={handler:a,action:m};G[b]=M;G.ALL|=M;M<<=1},addProperty:function(b,a){var m={};m[a||b+"Changed"]=function(a,m){m&&G.unlink(b,a,m);a[b]&&
G.link(b,a,a[b])};this.add(b.toUpperCase(),m,function(a,m){m[b]&&a(b,m,m[b])})}},I={};G.addProperty("delegate");G.addProperty("target");G.addProperty("dataset");var K=J(n,{className:D+".AbstractData",state:r.UNDEFINED,emit_stateChanged:u("stateChanged","oldState"),active:!1,emit_activeChanged:u("activeChanged"),subscribeTo:G.NONE,subscriberCount:0,subscribers_:null,emit_subscribersChanged:u("subscribersChanged","delta"),syncEvents:J.oneFunctionProperty(function(){this.isSyncRequired()&&this.syncAction()},
{stateChanged:!0,subscribersChanged:!0}),syncAction:null,init:function(){n.prototype.init.call(this);this.active&&this.addHandler(E(this.subscribeTo).handler);var b=this.syncAction;b&&(this.syncAction=null,this.setSyncAction(b))},setState:function(b,a){var m=String(b);if(!q[m])throw 142;if(this.state!=m||this.state.data!=a){var c=this.state;this.state=Object(m);this.state.data=a;this.emit_stateChanged(c);return!0}return!1},deprecate:function(){this.state!=r.PROCESSING&&this.setState(r.DEPRECATED)},
setActive:function(b){b=!!b;if(this.active!=b){this.active=b;this.emit_activeChanged();if(b){b=E(this.subscribeTo);for(var a=0,m;m=b.actions[a];a++)m(G.link,this);this.addHandler(b.handler)}else{b=E(this.subscribeTo);for(a=0;m=b.actions[a++];)m(G.unlink,this);this.removeHandler(b.handler)}return!0}return!1},setSubscription:function(b){var a=this.subscribeTo,m=b&G.ALL;if(b=a^m){this.subscribeTo=m;if(this.active){var c=E(a),m=E(m);this.removeHandler(c.handler);this.addHandler(m.handler);for(c=1;b;)b&
1&&(m=N[c],a&c?m.action(G.unlink,this):m.action(G.link,this)),c<<=1,b>>=1}return!0}return!1},isSyncRequired:function(){return 0<this.subscriberCount&&(this.state==r.UNDEFINED||this.state==r.DEPRECATED)},setSyncAction:function(b){var a=this.syncAction;"function"!=typeof b&&(b=null);(this.syncAction=b)?(a||this.addHandler(this.syncEvents),this.isSyncRequired()&&this.syncAction()):a&&this.removeHandler(this.syncEvents)},destroy:function(){if(this.active)for(var b=E(this.subscribeTo),a=0,m;m=b.actions[a];a++)m(G.unlink,
this);n.prototype.destroy.call(this);this.state=r.UNDEFINED}}),a={},c={},e=function(b){this.set(this.fn(b))},f={destroy:function(b){this.value.unlink(b,this.fn)}},p={destroy:function(b){this.set(null)}},T=J(K,{className:D+".Value",emit_change:u("change","oldValue")&&function(b){C.change.call(this,b);for(var a=this;a=a.links_;)a.fn.call(a.context,this.value,b)},value:null,initValue:null,proxy:null,locked:!1,lockedValue_:null,links_:null,setNullOnEmitterDestroy:!0,bindingBridge:{attach:function(b,a,
m){b.link(m,a,!0)},detach:function(b,a,m){b.unlink(m,a)},get:function(b){return b.value}},init:function(){K.prototype.init.call(this);this.proxy&&(this.value=this.proxy(this.value));this.setNullOnEmitterDestroy&&this.value instanceof n&&this.value.addHandler(p,this);this.initValue=this.value},set:function(b){var a=this.value;b=this.proxy?this.proxy(b):b;var m=b!==a;m&&(this.setNullOnEmitterDestroy&&(a instanceof n&&a.removeHandler(p,this),b instanceof n&&b.addHandler(p,this)),this.value=b,this.locked||
this.emit_change(a));return m},reset:function(){this.set(this.initValue)},lock:function(){this.locked||(this.locked=!0,this.lockedValue_=this.value)},unlock:function(){if(this.locked){var b=this.lockedValue_;this.lockedValue_=null;this.locked=!1;this.value!==b&&this.emit_change(b)}},compute:function(b,c){c||(c=b,b=null);var m=this,e=d.event.createHandler(b,function(b){this.set(c(b,m.value))}),f=e.events.concat(String(c),this.basisObjectId).join("_"),p=a[f];if(!p){var k={};e.destroy=function(b){delete k[b.basisObjectId];
this.destroy()};this.addHandler({change:function(){for(var b in k){var a=k[b];a.token.set(c(a.object,this.value))}},destroy:function(){for(var b in k){var a=k[b];a.object.removeHandler(e,a.token);a.token.destroy()}m=k=null}});p=a[f]=function(b){var a=b.basisObjectId,f=k[a];f||(f=new d.Token(c(b,m.value)),b.addHandler(e,f),f=k[a]={token:f,object:b});return f.token};p.deferred=function(){return function(b){return p(b).deferred()}}}return p},as:function(b,a){if(this.links_)for(var c=this;c=c.links_;)if(c.context instanceof
d.Token&&c.context.fn==String(b))return a?c.context.deferred():c.context;c=new d.Token;c.fn=b;this.link(c,e);return a?c.deferred():c},deferred:function(b){return this.as(b,!0)},link:function(b,a,m){if("function"!=typeof a){var e=String(a);(a=c[e])||(a=c[e]=function(b){this[e]=b})}this.links_={value:this,context:b,fn:a,links_:this.links_};b instanceof n&&b.addHandler(f,this.links_);m||a.call(b,this.value);return b},unlink:function(b,a){for(var c=this,e;e=c,c=c.links_;)c.context!==b||a&&c.fn!==a||(c.fn=
d.fn.$undef,e.links_=c.links_,c.context instanceof n&&c.context.removeHandler(f,c))},destroy:function(){K.prototype.destroy.call(this);this.setNullOnEmitterDestroy&&this.value instanceof n&&this.value.removeHandler(p,this);for(var b=this;b=b.links_;)b.context instanceof n&&b.context.removeHandler(f,b);this.links_=this.lockedValue_=this.value=this.initValue=this.proxy=null}}),k={};T.from=function(b,a,c){var e;if(!b)return null;if(b instanceof n){c||(c=a,a=null);a=d.event.createHandler(a,function(b){this.set(c(b))});
var f=a.events.concat(String(c),b.basisObjectId).join("_");e=k[f];e||(c=d.getter(c),e=k[f]=new T({value:c(b)}),a.destroy=function(b){delete k[f];this.destroy()},b.addHandler(a,e))}e||(f=b.basisObjectId,a=b.bindingBridge,f&&a&&(e=k[f],e||(e=k[f]=new T({value:a.get(b)}),a.attach(b,e.set,e))));if(!e)throw 143;return e};T.factory=function(b,a){return function(c){return T.from(c,b,a)}};var w=J(K,{className:D+".Object",subscribeTo:G.DELEGATE+G.TARGET,data:null,emit_update:u("update","delta")&&function(b){var a=
this.delegates_;for(C.update.call(this,b);a;)a.delegate&&a.delegate.emit_update(b),a=a.next},emit_stateChanged:function(b){var a=this.delegates_;for(K.prototype.emit_stateChanged.call(this,b);a;)a.delegate&&(a.delegate.state=this.state,a.delegate.emit_stateChanged(b)),a=a.next},delegate:null,delegates_:null,emit_delegateChanged:u("delegateChanged","oldDelegate"),target:null,emit_targetChanged:u("targetChanged","oldTarget"),root:null,emit_rootChanged:u("rootChanged","oldRoot"),init:function(){this.root=
this;K.prototype.init.call(this);var b=this.delegate;b?(this.target=this.delegate=null,this.data=b.data,this.state=b.state,this.setDelegate(b)):(this.data||(this.data={}),null!==this.target&&(this.target=this))},setDelegate:function(b){if(b&&b instanceof w){if(b.delegate&&Q(this,b))return!1}else b=null;if(this.delegate!==b){var a=this.state,c=this.data,e=this.delegate,f=this.target,p=this.root,k={},d=!1,aa=this.listen.delegate;if(e){aa&&e.removeHandler(aa,this);for(var W=e.delegates_;W;){if(W.delegate===
this){W.delegate=null;e===e?e.delegates_=W.next:e.next=W.next;break}W=W.next}}if(b){this.delegate=b;b.delegates_={delegate:this,next:b.delegates_};for(var O in b.data)!1===O in c&&(d=!0,k[O]=void 0);for(O in c)c[O]!==b.data[O]&&(d=!0,k[O]=c[O]);aa&&b.addHandler(aa,this)}else for(O in this.target=this.delegate=null,this.root=this,this.data={},c)this.data[O]=c[O];L(this,p,f);d&&this.emit_update(k);a===this.state||String(a)==this.state&&a.data===this.state.data||this.emit_stateChanged(a);this.emit_delegateChanged(e);
return!0}return!1},setState:function(b,a){return this.delegate?this.root.setState(b,a):K.prototype.setState.call(this,b,a)},update:function(b){if(this.delegate)return this.root.update(b);if(b){var a={},c=!1,e;for(e in b)this.data[e]!==b[e]&&(c=!0,a[e]=this.data[e],this.data[e]=b[e]);if(c)return this.emit_update(a),a}return!1},destroy:function(){K.prototype.destroy.call(this);var b=this.delegates_;for(this.delegates_=null;b;)b.delegate.setDelegate(),b=b.next;this.delegate&&this.setDelegate();this.data=
B;this.target=this.root=null}});h=J(w,{className:D+".Slot"});var ba={destroy:function(){delete this.map[this.itemId]}};H=J(null,{className:D+".KeyObjectMap",itemClass:w,keyGetter:H,map_:null,extendConstructor_:!0,init:function(){this.map_={};v.add(this)},resolve:function(b){return this.get(this.keyGetter(b),b)},create:function(b,a){var c={};b instanceof w?c.delegate=b:c.data={id:b,title:b};return new this.itemClass(c)},get:function(b,a){var c=b instanceof w?b.basisObjectId:b,e=this.map_[c];!e&&a&&
(e=this.map_[c]=this.create(b,a),e.addHandler(ba,{map:this.map_,itemId:c}));return e},destroy:function(){v.remove(this);for(var b=F(this.map_),a=0,c;c=b[a++];)c.destroy()}});var S=J(w,{className:D+".DatasetWrapper",subscribeTo:w.prototype.subscribeTo+G.DATASET,listen:{dataset:{itemsChanged:function(b,a){this.itemCount=b.itemCount;this.emit_itemsChanged(a)},destroy:function(){this.setDataset()}}},dataset:null,datasetAdapter_:null,emit_datasetChanged:u("datasetChanged","oldDataset"),emit_itemsChanged:u("itemsChanged",
"delta"),init:function(){w.prototype.init.call(this);var b=this.dataset;b&&(this.dataset=null,this.setDataset(b))},setDataset:function(b){b=y(this,this.setDataset,b,"datasetAdapter_");if(this.dataset!==b){var a=this.listen.dataset,c=this.dataset,e;a&&(c&&c.removeHandler(a,this),b&&b.addHandler(a,this));this.itemCount=b?b.itemCount:0;(e=R(c,b))&&this.emit_itemsChanged(e);this.dataset=b;this.emit_datasetChanged(c)}},has:function(a){return this.dataset?this.dataset.has(a):null},getItems:function(){return this.dataset?
this.dataset.getItems():[]},pick:function(){return this.dataset?this.dataset.pick():null},top:function(a){return this.dataset?this.dataset.top(a):[]},forEach:function(a){if(this.dataset)return this.dataset.forEach(a)},destroy:function(){(this.dataset||this.datasetAdapter_)&&this.setDataset();w.prototype.destroy.call(this)}}),ca=J(K,{className:D+".AbstractDataset",itemCount:0,items_:null,members_:null,cache_:null,emit_itemsChanged:u("itemsChanged","delta")&&function(a){var c,e=0,f=0,p;if(c=a.inserted)for(;p=
c[e];)this.items_[p.basisObjectId]=p,e++;if(c=a.deleted)for(;p=c[f];)delete this.items_[p.basisObjectId],f++;this.itemCount+=e-f;this.cache_=e==this.itemCount?a.inserted:null;C.itemsChanged.call(this,a)},init:function(){K.prototype.init.call(this);this.members_={};this.items_={}},has:function(a){return!(!a||!this.items_[a.basisObjectId])},getItems:function(){this.cache_||(this.cache_=F(this.items_));return this.cache_},pick:function(){for(var a in this.items_)return this.items_[a];return null},top:function(a){var c=
[];if(a)for(var e in this.items_)if(c.push(this.items_[e])>=a)break;return c},forEach:function(a){for(var c=this.getItems(),e=0;e<c.length;e++)a(c[e])},clear:function(){},destroy:function(){this.clear();K.prototype.destroy.call(this);this.cache_=U;this.itemCount=0;this.items_=this.members_=null}});D=J(ca,{className:D+".Dataset",listen:{item:{destroy:function(a){this.remove([a])}}},init:function(){ca.prototype.init.call(this);var a=this.items;a&&(this.items=null,this.set(a))},add:function(a){var c=
this.members_,e=this.listen.item,f=[],p;a&&!Array.isArray(a)&&(a=[a]);for(var k=0;k<a.length;k++){var d=a[k];if(d instanceof w){var g=d.basisObjectId;c[g]||(c[g]=d,e&&d.addHandler(e,this),f.push(d))}}f.length&&this.emit_itemsChanged(p={inserted:f});return p},remove:function(a){var c=this.members_,e=this.listen.item,f=[],p;a&&!Array.isArray(a)&&(a=[a]);for(var k=0;k<a.length;k++){var d=a[k];if(d instanceof w){var g=d.basisObjectId;c[g]&&(e&&d.removeHandler(e,this),delete c[g],f.push(d))}}f.length&&
this.emit_itemsChanged(p={deleted:f});return p},set:function(a){if(!this.itemCount)return this.add(a);if(!a||!a.length)return this.clear();for(var c=this.members_,e=this.listen.item,f={},p=[],k=[],d,g,aa,W=0;W<a.length;W++)d=a[W],d instanceof w&&(g=d.basisObjectId,f[g]=d,c[g]||(c[g]=d,e&&d.addHandler(e,this),k.push(d)));for(g in c)f[g]||(d=c[g],e&&d.removeHandler(e,this),delete c[g],p.push(d));(aa=Y(k,p))&&this.emit_itemsChanged(aa);return aa},sync:function(a){a=this.set(a)||{};var c=a.deleted;setAccumulateState(!0);
if(c)for(var e=0,f;f=c[e];e++)f.destroy();setAccumulateState(!1);return a.inserted},clear:function(){var a=this.getItems(),c=this.listen.item,e;if(a.length){if(c)for(e=0;e<a.length;e++)a[e].removeHandler(c,this);this.emit_itemsChanged(e={deleted:a});this.members_={}}return e}});var Z=function(a,c,e,f){this.context=a;this.fn=c;this.source=e;this.handler=f};Z.prototype.adapter_=null;Z.prototype.proxy=function(){this.fn.call(this.context,this.source)};var $={datasetChanged:function(a){this.fn.call(this.context,
a)},destroy:function(){this.fn.call(this.context,null)}},ga={change:function(a){this.fn.call(this.context,a)},destroy:function(){this.fn.call(this.context,null)}};D.setAccumulateState=function(){function a(){var c=w;w={};for(var b in c){var e=c[b];p.call(e.dataset,e)}}function c(a){var b=this.basisObjectId,e=a.inserted,l=a.deleted,s=w[b];if(e&&l)s&&(delete w[b],p.call(s.dataset,s)),p.call(this,a);else{if(s){var x=s[e?"inserted":"deleted"];if(x){x.push.apply(x,e||l);return}p.call(s.dataset,s)}w[b]=
a;a.dataset=this}}function e(){g=null;k&&(k=0,f.emit_itemsChanged=p,a())}var f=ca.prototype,p=f.emit_itemsChanged,k=0,g,w={};return function(aa){aa?(0==k&&(f.emit_itemsChanged=c,g||(g=d.setImmediate(e))),k++):(k-=0<k,0==k&&(f.emit_itemsChanged=p,a()))}}();A.exports={STATE:r,SUBSCRIPTION:G,AbstractData:K,Value:T,Object:w,Slot:h,KeyObjectMap:H,AbstractDataset:ca,Dataset:D,DatasetWrapper:S,DatasetAdapter:Z,isConnected:Q,getDatasetDelta:R,resolveDataset:y,wrapData:t,wrapObject:g,wrap:function(a,c){var e=
c?g:t;return Array.isArray(a)?a.map(e):e(a)}}},"1.js":function(h,A,d,D,J,u,H,X){function z(d){var h=Q[d];h||(h=function(){for(var h=this,t,g;h=h.handler;){g=h.callbacks[d];if("function"==typeof g){if(!t){t=[this];for(var v=0;v<arguments.length;v++)t.push(arguments[v])}g.apply(h.context||this,t)}g=h.callbacks["*"];if("function"==typeof g){if(!t)for(t=[this],v=0;v<arguments.length;v++)t.push(arguments[v]);g.call(h.context||this,{sender:this,type:d,args:t})}}},Q[d]=h);return h}h=d.Class;var E={},Q={},
L=function(){};h=h(null,{className:this.path+".Emitter",extendConstructor_:!0,handler:null,emit_destroy:z("destroy"),listen:h.nestedExtendProperty(),init:function(){this.handler&&!this.handler.callbacks&&(this.handler={callbacks:this.handler,context:this,handler:null})},addHandler:function(d,h){this.handler={callbacks:d,context:h||this,handler:this.handler}},removeHandler:function(d,h){var y=this,t;for(h=h||this;t=y,y=y.handler;)if(y.callbacks===d&&y.context===h){y.callbacks=E;t.handler=y.handler;
break}},destroy:function(){this.destroy=L;this.emit_destroy();this.handler=null}});A.exports={create:z,createHandler:function(d,h){var y={events:[]};if(d){d=String(d).trim().split(/\s+|\s*,\s*/).sort();for(var y={events:d},t=0,g;g=d[t];t++)"destroy"!=g&&(y[g]=h)}return y},events:Q,Emitter:h}},"2.js":function(h,A,d,D,J,u,H,X){function z(a){w[a]=w[a]||0;return a+w[a]++}function E(a,c){var b=S[a];if(b){for(var l=0,s;s=b[l];l++)s[0][s[1]]=c;delete S[a]}ba[a]=c}function Q(a,c,b){if(ba[a])return ba[a];
var l=S[a];l||(l=S[a]=[]);l.push([c,b]);return ca}function L(){var a=r(arguments),c=a.pop(),b=a[0],l=a[1],s=a[2],x;if("function"!=typeof c)throw 145;switch(a.length){case 0:x=function(){return c()};break;case 1:x=function(a,l,s){return b in a?c(l[b]):s};break;case 2:x=function(a,s,x){return b in a||l in a?c(s[b],s[l]):x};break;case 3:x=function(a,x,e){return b in a||l in a||s in a?c(x[b],x[l],x[s]):e};break;default:x=function(l,s,x){for(var b=!1,e=[],f=0,O;O=a[f];f++)b=b||O in l,e.push(s[O]);return b?
c.apply(null,e):x}}x.args=a;return x.calc=x}function Y(){return L.apply(null,r(arguments).concat(function(){for(var a=[],c=arguments.length;0<c--;){if(null==arguments[c])return null;a.push(arguments[c])}return a.join("-")}))}function R(a,c){var b=["has"],l=[C],s=[],x;for(x in a)if(C.call(a,x)){var P="v"+s.length,e="f"+s.length,f=a[x];b.push(P,e);l.push(f,c[x]);s.push('"'+x+'":has.call(data,"'+x+'")?'+e+'(data["'+x+'"],'+P+"):"+P+("function"==typeof f?"(data)":""))}s=s.sort().join(",");(x=ia[s])||
(x=ia[s]=new Function(b,"return function(data){return {"+s+"};};"));return x.apply(null,l)}function y(a,c){if(!Array.isArray(a))return null;if(!Array.isArray(c)||a.length!=c.length)return a||null;for(var b=0;b<a.length;b++)if(a[b]!==c[b])return a;return c}function t(a,c,b){if(!a.all.itemCount){a.aliases[c]=c;b="string"==typeof b||Array.isArray(b)||"function"==typeof b&&b.calc!==b?{type:b}:d.object.slice(b);if("type"in b){"string"==typeof b.type&&(b.type=Q(b.type,a.fields,c));if(Array.isArray(b.type)){var l=
b.type.slice();1==l.length?(b.type=d.fn.$const(l[0]),b.defValue=l[0]):(b.type=function(a,b){return-1!=l.indexOf(a)?a:b},b.defValue=-1!=l.indexOf(b.defValue)?b.defValue:l[0])}b.type===Array&&(b.type=y);"function"!=typeof b.type&&(b.type=q)}var s=b.type||q;-1!=[f,p,T,k].indexOf(s)&&(b.id=!0);b.id&&(a.index||(a.index=new Z(String)),a.idFields[c]=!0,a.idField||a.compositeKey?(a.idField=null,a.compositeKey=Y.apply(null,B(a.idFields))):a.idField=c);b.calc?v(a,c,b.calc):a.fields[c]=s;a.defaults[c]="defValue"in
b?b.defValue:s();a.entityClass.prototype["get_"+c]=function(a){return a&&this.modified&&c in this.modified?this.modified[c]:this.data[c]};a.entityClass.prototype["set_"+c]=function(a,l){return this.set(c,a,l)};ea[c]||(ea[c]={destroy:function(){this.set(c,null)}})}}function g(a,b,c){c in a.fields&&!1==b in a.aliases&&(a.aliases[b]=c)}function v(a,b,c){if(!b||!a.fields[b]){a.calcs||(a.calcs=[]);var l=a.calcs,s=a.deps,x=c.args||[],P={args:x,wrapper:c},e=a.calcs.length,f=0;if(x)for(var p=0,ja;ja=l[p];p++)-1!=
x.indexOf(ja.key)&&(f=p+1);if(b){P.key=b;for(p=0;ja=l[p];p++)if(-1!=ja.args.indexOf(b)){e=p;break}if(f>e)return;a.idField&&b==a.idField&&(a.compositeKey=c);s[b]=x.reduce(function(a,l){for(var b=s[l]||[l],c=0;c<b.length;c++)d.array.add(a,b[c]);return a},[]);for(var k in s)c=s[k].indexOf(b),-1!=c&&Array.prototype.splice.apply(s[k],[c,1].concat(s[b]));a.fields[b]=function(a,l){return l}}else e=f;l.splice(Math.min(e,f),0,P)}}d.require("./1.js");d.require("./0.js");d.require("./3.js");var F=this.path,
n=d.Class,C=Object.prototype.hasOwnProperty,B=d.object.keys,U=d.object.extend,q=d.fn.$self,r=d.array.from,N=d.event.Emitter;h=d.event.create;var M=d.data.Object,G=d.data.Slot,I=d.data.Dataset;u=d.data.dataset.Subset;var K=d.data.dataset.Split,a={},c=[],e={string:!0,number:!0},f=function(a){return isNaN(a)?null:Number(a)},p=function(a){return isNaN(a)?null:Number(a)},T=function(a){return isNaN(a)?null:parseInt(a,10)},k=function(a){return null==a?null:String(a)},w={},ba={},S={},ca=function(){},Z=d.Class(null,
{className:F+".Index",items:null,fn:String,init:function(a){this.items={};"function"==typeof a&&(this.fn=a)},calcWrapper:function(a,b){var c=this.fn(a,b);if(c!==b&&C.call(this.items,c))throw 144;return c},get:function(a,b){var c=C.call(this.items,a)&&this.items[a];if(c&&(!b||c.entityType===b))return c},add:function(a,b){var c=C.call(this.items,a)&&this.items[a];if(b&&(!c||c===b))return this.items[a]=b,!0},remove:function(a,b){if(this.items[a]===b)return delete this.items[a],!0},destroy:function(){this.items=
null}});H=function(a,b){return function(c){return a.prototype[b].call(this,c&&c.map(this.wrapper))}};D=function(a,b){return function(){this.name||(this.name=z(b));a.prototype.init.call(this)}};J=function(a){return function(a){var b=d.object.slice(this.items_),l=[];if(a){I.setAccumulateState(!0);for(var c=0;c<a.length;c++){var x=this.wrapper(a[c]);x&&(b[x.basisObjectId]=!1)}I.setAccumulateState(!1)}for(var P in this.items_)!1==P in b&&l.push(this.items_[P]);I.setAccumulateState(!0);for(P in b)b[P]&&
b[P].destroy();I.setAccumulateState(!1);return l.length?l:null}};var $=n(I,{className:F+".EntitySet",name:null,wrapper:q,init:D(I,"EntitySet"),sync:J(I),set:H(I,"set"),add:H(I,"add"),remove:H(I,"remove"),destroy:function(){I.prototype.destroy.call(this);this.wrapper=null}}),ga=n($,{className:F+".ReadOnlyEntitySet",set:d.fn.$false,add:d.fn.$false,remove:d.fn.$false,clear:d.fn.$false});u=n(u,{className:F+".EntityCollection",name:null,init:D(u,"EntityCollection"),sync:J(u)});D=n(K,{className:F+".EntityGrouping",
name:null,subsetClass:ga,init:D(K,"EntityGrouping"),sync:J(K),getSubset:function(a,b){var c=K.prototype.getSubset.call(this,a,b);c&&c.dataset&&(c.dataset.wrapper=this.wrapper);return c}});var b=function(a,c){if(this instanceof b){a||(a=q);if(!c||ba[c])c=z("UntitledEntitySetType");var e=new da({entitySetClass:{wrapper:a}}),l=e.entitySetClass,s=function(a,l){return null!=a?(!1==l instanceof $&&(l=e.createEntitySet()),l.set(a instanceof I?a.getItems():r(a)),l):null};"string"==typeof a&&(l.prototype.wrapper=
Q(a,l.prototype,"wrapper"));E(c,s);U(s,{type:e,typeName:c,toString:function(){return this.typeName+"()"},entitySetType:e,extend:function(){return l.extend.apply(l,arguments)},extendClass:function(){l.extend.apply(l,arguments);return s},reader:function(a){if(Array.isArray(a)){var b=l.prototype.wrapper;return a.map(b.reader||b)}return a},extendReader:function(a){var l=s.reader;s.reader=function(b){Array.isArray(b)&&a(b);return l(b)}}});return s}},da=n(null,{className:F+".EntitySetConstructor",entitySetClass:$,
extendConstructor_:!0,createEntitySet:function(){return new this.entitySetClass}}),m=function(a){if(this instanceof m){var b;b=a.singleton?function(a){var b=c.get();b?a&&b.update(a):b=new l(a||{});return b}:function(a,b){if(null!=a){if(a===b||a.entityType===c)return a;var P,f=c.idField;if(e[typeof a]){if(!f)return;if(b=c.index.get(a,c))return b;P=a;a={};a[f]=P}else c.compositeKey?P=c.compositeKey(a,a):f&&(P=a[f]),null!=P&&(b=c.index.get(P,c));b&&b.entityType===c?b.update(a):b=new l(a);return b}};
var c=new ha(a||{},b),l=c.entityClass;E(c.name,b);U(b,{all:c.all,type:c,typeName:c.name,entityType:c,toString:function(){return this.typeName+"()"},reader:function(a){return c.reader(a)},addField:function(a,l){c.addField(a,l)},addCalcField:function(a,l){c.addCalcField(a,l)},get:function(a){return c.get(a)},getSlot:function(a,l){return c.getSlot(a,l)},extend:function(){return l.extend.apply(l,arguments)},extendClass:function(){return l.extend.apply(l,arguments)},extendReader:function(a){var l=b.reader;
b.reader=function(b){b&&"object"==typeof b&&a(b);return l(b)}}});return b}},ea={},ia={},ha=n(null,{className:F+".EntityType",wrapper:null,all:null,fields:null,idFields:null,defaults:null,aliases:null,slots:null,singleton:!1,index:null,entityClass:null,init:function(a,b){this.name=a.name;if(!this.name||ba[this.name])this.name=z("UntitledEntityType");this.fields={};this.deps={};this.idFields={};this.defaults={};this.aliases={};this.slots={};var e=a.index;e&&e instanceof Z&&(this.index=e);this.wrapper=
b;this.all=new ga(d.object.complete({wrapper:b},a.all));if(this.singleton=!!a.singleton){var l;this.get=function(){return l};this.all.addHandler({itemsChanged:function(a,b){l=b.inserted?b.inserted[0]:null}},this)}this.entityClass=V(this,this.all,this.fields,this.slots);this.entityClass.extend({entityType:this,type:b,typeName:this.name,state:a.state||this.entityClass.prototype.state});for(var s in a.fields)t(this,s,a.fields[s]);for(s in a.aliases)g(this,s,a.aliases[s]);a.constrains&&a.constrains.forEach(function(a){v(this,
null,a)},this);this.entityClass.prototype.generateData=R(this.defaults,this.fields);e={};for(s in this.defaults)e[s]=void 0;this.entityClass.prototype.initDelta=e;c.push(this)},reader:function(a){var b={};if(e[typeof a])return this.idField?a:null;if(!a||null==a)return null;for(var c in a){var l=this.aliases[c];if(l){var s=this.fields[l].reader;b[l]=s?s(a[c]):a[c]}}return b},get:function(a){a=this.getId(a);if(null!=a)return this.index.get(a,this)},getId:function(a){if((this.idField||this.compositeKey)&&
null!=a){if(e[typeof a])return a;if(a&&a.entityType===this)return a.__id__;a instanceof M&&(a=a.data);return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var c=C.call(this.slots,b)&&this.slots[b];c||(e[typeof a]&&(c={},this.idField&&!this.compositeKey&&(c[this.idField]=a),a=c),c=this.slots[b]=new G({delegate:this.get(b)||null,data:a}));return c}}}),fa=n(M,{className:F+".BaseEntity",target:!0,setDelegate:function(){},modified:null,emit_rollbackUpdate:h("rollbackUpdate")}),
V=function(b,c,e,l){function s(a,l,c){var s=b.calcs,e=a.data,f=!1,p=a.__id__,d;try{if(s)for(var k=0,m;m=s[k];k++){var g=m.key,w=e[g],h=m.wrapper(l,e,w);g&&h!==w&&(e[g]=h,l[g]=w,f=!0)}d=b.compositeKey?b.compositeKey(l,e,p):b.idField&&b.idField in l?e[b.idField]:p;d!==p&&b.index.calcWrapper(d,p)}catch(T){f=!1;d=p;for(g in l)a.data[g]=l[g];if(c&&!a.modified)for(g in c){a.modified=c;break}}d!==p&&(a.__id__=d,x(a,p,d));return f}function x(a,c,s){var e=b.index;null!=c&&(e.remove(c,a),C.call(l,c)&&l[c].setDelegate());
null!=s&&(e.add(s,a),C.call(l,s)&&l[s].setDelegate(a))}return n(fa,{className:F+".Entity",extendConstructor_:!1,init:function(a){this.delegate=null;this.data=this.generateData(a);fa.prototype.init.call(this);this.fieldHandlers_={};for(var b in this.data)(a=this.data[b])&&a!==this&&a instanceof N&&a.addHandler(ea[b],this)&&(this.fieldHandlers_[b]=!0);s(this,this.initDelta);c.emit_itemsChanged({inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+
")]"},getId:function(){return this.__id__},get:function(a,b){return b&&this.modified&&a in this.modified?this.modified[a]:this.data[a]},set:function(a,l,c,x){var f=e[a];if(!f)return!1;var p,d=this.modified;f===y&&d&&a in d&&(l=y(l,d[a]));l=f(l,this.data[a]);f=this.data[a];if(l===f||l&&f&&l.constructor===Date&&f.constructor===Date&&+l===+f)!c&&d&&a in d&&(p={rollback:{key:a,value:d[a]}},delete d[a],B(d).length||(this.modified=null));else a:{p={};if(!b.idFields[a])if(c)d||(this.modified=d={}),!1===
a in d?(p.rollback={key:a,value:void 0},d[a]=f):d[a]===l&&(p.rollback={key:a,value:l},delete d[a],B(d).length||(this.modified=null));else if(d&&a in d)if(d[a]!==l){p.rollback={key:a,value:d[a]};d[a]=l;break a}else return!1;this.data[a]=l;this.fieldHandlers_[a]&&(f.removeHandler(ea[a],this),this.fieldHandlers_[a]=!1);l&&l!==this&&l instanceof N&&l.addHandler(ea[a],this)&&(this.fieldHandlers_[a]=!0);p.key=a;p.value=f;p.delta={};p.delta[a]=f}if(!x&&p){a=p.key;c=p.delta||{};var k;p.rollback&&(k={},k[p.rollback.key]=
p.rollback.value);s(this,c,k)&&(a=!0);a&&(this.emit_update(c),p.delta=c);k&&this.emit_rollbackUpdate(k)}return p||!1},update:function(a,b){var l=!1,c={};if(a){var e,x={},f,d;for(d in a)if(f=this.set(d,a[d],b,!0))f.key&&(l=!0,c[f.key]=f.value),f.rollback&&(e=!0,x[f.rollback.key]=f.rollback.value);s(this,c,x)&&(l=!0);l&&this.emit_update(c);e&&this.emit_rollbackUpdate(x)}return l?c:!1},generateData:function(){return{}},reset:function(){this.update(this.generateData({}))},clear:function(){var a={},l;
for(l in this.data)a[l]=void 0;return this.update(a)},commit:function(a){var l=this.modified;this.modified=null;a&&this.update(a);l&&this.emit_rollbackUpdate(l)},rollback:function(a){var l=this.modified;l&&a&&(Array.isArray(a)||(a=[a]),l=d.object.slice(l,a.reduce(function(a,l){return a.concat(b.deps[l]||l)},[])));this.update(l,!0)},destroy:function(){for(var l in this.fieldHandlers_)this.fieldHandlers_[l]&&this.data[l].removeHandler(ea[l],this);this.fieldHandlers_=a;null!=this.__id__&&x(this,this.__id__,
null);M.prototype.destroy.call(this);c.emit_itemsChanged({deleted:[this]});this.data=a;this.modified=null}})};A.exports={isEntity:function(a){return a&&a instanceof fa},createType:function(a,b){var c=a||{};"string"==typeof a?c={name:c,fields:b||{}}:b&&(c=d.object.merge(c,{fields:b}));return new m(c)},createSetType:function(a,c){return 1<arguments.length?new b(c,a):new b(a)},validate:function(){for(var a in S)d.dev.warn(F+": type `"+a+"` is not defined, but used by "+S[a].length+" type(s)")},getTypeByName:function(a){return ba[a]},
get:function(a,b){var c=ba[a];if(c)return c.get(b)},NumericId:f,NumberId:p,IntId:T,StringId:k,Index:Z,CalculateField:L,calc:L,EntityType:m,Entity:V,BaseEntity:fa,EntitySetType:b,EntitySet:$,ReadOnlyEntitySet:ga,Collection:u,Grouping:D}},"3.js":function(h,A,d,D,J,u,H,X){function z(a,c){var e={},f;a&&a.length&&(f=e.inserted=a);c&&c.length&&(f=e.deleted=c);if(f)return e}function E(a,c){return function f(c){if(!c)return null;if(c.__extend__)return c;"string"==typeof c||Array.isArray(c)||(c="object"==
typeof c?d.object.keys(c):null);return R(d.event.createHandler(c,a),{__extend__:f})}(c)}function Q(a,c,e,f){return new q(R({keyGetter:c,itemClass:e,create:function(a,c){var e=q.prototype.create.call(this,a,c);e.setDataset(new f({ruleValue:a}));return e}},a))}function L(a,c){if(!a.length)return 0;var e=c.value,f=c.object.basisObjectId,d,g,k,w,h=0,n=a.length-1;do if(k=h+n>>1,w=a[k],d=w.value,e<d)n=k-1;else if(e>d)h=k+1;else if(g=w.object.basisObjectId,f<g)n=k-1;else if(f>g)h=k+1;else return k;while(h<=
n);return k+(d==e?g<f:d<e)}function Y(a,c){return+(a.value>c.value)||-(a.value<c.value)||a.object.basisObjectId-c.object.basisObjectId}d.require("./1.js");d.require("./0.js");u=this.path;H=d.Class;var R=d.object.extend,y=d.object.values,t=d.getter,g=d.fn.$self,v=d.fn.$true,F=d.fn.$false,n=d.array.from,C=d.event.create,B=d.data.SUBSCRIPTION,U=d.data.Object,q=d.data.KeyObjectMap,r=d.data.AbstractDataset,N=d.data.Dataset;X=d.data.DatasetWrapper;B.add("SOURCE",{sourceChanged:function(a,c){c&&B.unlink("source",
a,c);a.source&&B.link("source",a,a.source)},sourcesChanged:function(a,c){var e;if(e=c.inserted)for(var f=0;e[f];f++)B.link("source",a,e[f]);if(e=c.deleted)for(f=0;e[f];f++)B.unlink("source",a,e[f])}},function(a,c){for(var e=c.sources||(c.source?[c.source]:[]),f=0,d;d=e[f++];)a("source",c,d)});B.addProperty("minuend");B.addProperty("subtrahend");var M=H(r,{className:u+".Merge",subscribeTo:B.SOURCE,emit_sourcesChanged:C("sourcesChanged","delta"),sources:null,rule:function(a,c){return 0<a},listen:{source:{itemsChanged:function(a,
c){var e=this.members_,f={},d,g;if(c.inserted)for(var k=0;d=c.inserted[k];k++)g=d.basisObjectId,e[g]?e[g].count++:e[g]={count:1,object:d},f[g]=e[g];if(c.deleted)for(k=0;d=c.deleted[k];k++)g=d.basisObjectId,f[g]=e[g],e[g].count--;this.applyRule(f)},destroy:function(a){this.removeSource(a)}}},init:function(){r.prototype.init.call(this);var a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){"function"!=typeof a&&(a=M.UNION);this.rule!==a&&(this.rule=a,this.applyRule())},
applyRule:function(a){var c=this.members_,e=this.rule,f=this.sources.length,d=[],g=[],k,w;a||(a=c);for(var h in a)a=c[h],k=f&&a.count&&e(a.count,f),k!=!!this.items_[h]&&(k?d:g).push(a.object),0==a.count&&delete c[h];(w=z(d,g))&&this.emit_itemsChanged(w);return w},addSource:function(a){if(a instanceof r&&d.array.add(this.sources,a)){this.listen.source&&a.addHandler(this.listen.source,this);var c=this.members_,e;for(e in a.items_)c[e]?c[e].count++:c[e]={count:1,object:a.items_[e]};this.applyRule();
this.emit_sourcesChanged({inserted:[a]});return!0}},removeSource:function(a){if(d.array.remove(this.sources,a)){this.listen.source&&a.removeHandler(this.listen.source,this);var c=this.members_,e;for(e in a.items_)c[e].count--;this.applyRule();this.emit_sourcesChanged({deleted:[a]});return!0}},setSources:function(a){for(var c=n(this.sources),e=0,f;f=a[e];e++)f instanceof r&&(d.array.remove(c,f)||this.addSource(f));c.forEach(this.removeSource,this)},clear:function(){n(this.sources).forEach(this.removeSource,
this)},destroy:function(){r.prototype.destroy.call(this);this.sources=null}});M.UNION=M.prototype.rule;M.INTERSECTION=function(a,c){return a==c};M.DIFFERENCE=function(a,c){return 1==a};M.MORE_THAN_ONE_INCLUDE=function(a,c){return 1==c||1<a};M.AT_LEAST_ONE_EXCLUDE=function(a,c){return 1==c||a<c};var G=function(a){return!this.has(a)};h=H(r,{className:u+".Subtract",subscribeTo:B.MINUEND+B.SUBTRAHEND,minuend:null,emit_minuendChanged:C("minuendChanged","oldMinuend"),subtrahend:null,emit_subtrahendChanged:C("subtrahendChanged",
"oldSubtrahend"),listen:{minuend:{itemsChanged:function(a,c){if(this.subtrahend){var e=z(c.inserted&&c.inserted.filter(G,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));e&&this.emit_itemsChanged(e)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{itemsChanged:function(a,c){if(this.minuend){var e=z(c.deleted&&c.deleted.filter(G,this),c.inserted&&c.inserted.filter(this.has,this));e&&this.emit_itemsChanged(e)}},destroy:function(){this.setOperands(this.minuend,null)}}},
init:function(){r.prototype.init.call(this);var a=this.minuend,c=this.subtrahend;this.subtrahend=this.minuend=null;(a||c)&&this.setOperands(a,c)},setOperands:function(a,c){var e,f=!1;!1==a instanceof r&&(a=null);!1==c instanceof r&&(c=null);var d=this.minuend,g=this.subtrahend;if(d!==a){f=!0;this.minuend=a;var k=this.listen.minuend;k&&(d&&d.removeHandler(k,this),a&&a.addHandler(k,this));this.emit_minuendChanged(d)}if(g!==c){f=!0;this.subtrahend=c;if(k=this.listen.subtrahend)g&&g.removeHandler(k,this),
c&&c.addHandler(k,this);this.emit_subtrahendChanged(g)}if(!f)return!1;if(a&&c){var f=[],d=[],w;for(w in this.items_)a.items_[w]&&!c.items_[w]||f.push(this.items_[w]);for(w in a.items_)this.items_[w]||c.items_[w]||d.push(a.items_[w]);(e=z(d,f))&&this.emit_itemsChanged(e)}else this.itemCount&&this.emit_itemsChanged(e={deleted:this.getItems()});return e},setMinuend:function(a){return this.setOperands(a,this.subtrahend)},setSubtrahend:function(a){return this.setOperands(this.minuend,a)},clear:function(){this.setOperands()}});
var I=H(r,{className:u+".SourceDataset",subscribeTo:B.SOURCE,source:null,emit_sourceChanged:C("sourceChanged","oldSource"),sourceAdapter_:null,sourceMap_:null,listen:{source:{destroy:function(){this.sourceAdapter_||this.setSource()}}},init:function(){this.sourceMap_={};r.prototype.init.call(this);var a=this.source;a&&(this.source=null,this.setSource(a))},setSource:function(a){a=d.data.resolveDataset(this,this.setSource,a,"sourceAdapter_");if(this.source!==a){var c=this.source,e=this.listen.source;
this.source=a;if(e){var f=e.itemsChanged;c&&(c.removeHandler(e,this),f&&f.call(this,c,{deleted:c.getItems()}));a&&(a.addHandler(e,this),f&&f.call(this,a,{inserted:a.getItems()}))}this.emit_sourceChanged(c)}},clear:function(){this.setSource()},destroy:function(){r.prototype.destroy.call(this);this.sourceMap_=null}}),K=H(I,{className:u+".MapFilter",map:g,filter:F,rule:t(v),ruleEvents:E(function(a){var c=this.map?this.map(a):object;if(!1==c instanceof U||this.filter(c))c=null;var e=this.sourceMap_[a.basisObjectId],
f=e.member;if(f!==c){var d=this.members_,g,k,w;e.member=c;f&&(e=f.basisObjectId,this.removeMemberRef&&this.removeMemberRef(f,a),0==--d[e]&&(delete d[e],w=[f]));c&&(f=c.basisObjectId,this.addMemberRef&&this.addMemberRef(c,a),d[f]?d[f]++:(d[f]=1,k=[c]));(g=z(k,w))&&this.emit_itemsChanged(g)}},"update"),addMemberRef:null,removeMemberRef:null,listen:{source:{itemsChanged:function(a,c){var e=this.sourceMap_,f=this.members_,d=[],g=[],k,w,h,n=this.ruleEvents;N.setAccumulateState(!0);if(c.inserted)for(var q=
0;k=c.inserted[q];q++){h=this.map?this.map(k):k;if(!1==h instanceof U||this.filter(h))h=null;n&&k.addHandler(n,this);e[k.basisObjectId]={sourceObject:k,member:h};h&&(w=h.basisObjectId,f[w]?f[w]++:(f[w]=1,d.push(h)),this.addMemberRef&&this.addMemberRef(h,k))}if(c.deleted)for(q=0;k=c.deleted[q];q++)w=k.basisObjectId,h=e[w].member,n&&k.removeHandler(n,this),delete e[w],h&&(w=h.basisObjectId,0==--f[w]&&(delete f[w],g.push(h)),this.removeMemberRef&&this.removeMemberRef(h,k));N.setAccumulateState(!1);(c=
z(d,g))&&this.emit_itemsChanged(c)}}},setMap:function(a){"function"!=typeof a&&(a=g);if(this.map!==a)return this.map=a,this.applyRule()},setFilter:function(a){"function"!=typeof a&&(a=F);if(this.filter!==a)return this.filter=a,this.applyRule()},setRule:function(a){"function"!=typeof a&&(a=v);if(this.rule!==a)return this.rule=a,this.applyRule()},applyRule:function(){var a=this.sourceMap_,c=this.members_,e,f,d,g,k,h=[],n=[],q,r;for(r in a){k=a[r];g=k.sourceObject;e=k.member;f=this.map?this.map(g):g;
if(!1==f instanceof U||this.filter(f))f=null;e!=f&&(k.member=f,e&&(d=e.basisObjectId,this.removeMemberRef&&this.removeMemberRef(e,g),c[d]--),f&&(e=f.basisObjectId,this.addMemberRef&&this.addMemberRef(f,g),e in c?c[e]++:(c[e]=1,h.push(f))))}for(d in this.items_)0==c[d]&&(delete c[d],n.push(this.items_[d]));(q=z(h,n))&&this.emit_itemsChanged(q);return q}});D=H(K,{className:u+".Subset",filter:function(a){return!this.rule(a)}});J=H(K,{className:u+".Split",subsetClass:r,subsetWrapperClass:X,keyMap:null,
map:function(a){return this.keyMap.resolve(a)},setRule:function(a){"function"!=typeof a&&(a=v);if(this.rule!==a)return this.rule=a,this.keyMap.keyGetter=a,this.applyRule()},addMemberRef:function(a,c){a.dataset.emit_itemsChanged({inserted:[c]})},removeMemberRef:function(a,c){a.dataset.emit_itemsChanged({deleted:[c]})},init:function(){this.keyMap&&!1!=this.keyMap instanceof q||(this.keyMap=Q(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));K.prototype.init.call(this)},getSubset:function(a,
c){return this.keyMap.get(a,c)},destroy:function(){K.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});C=H(I,{className:u+".Slice",rule:t(v),ruleEvents:E(function(a){var c=this.sourceMap_[a.basisObjectId];a=this.rule(a);var e=this.index_;if(a!==c.value){var f=L(e,c),d=e[f-1],g=e[f+1];c.value=a;if(d&&(d.value>a||d.value==a&&d.object.basisObjectId>c.object.basisObjectId)||g&&(g.value<a||g.value==a&&g.object.basisObjectId<c.object.basisObjectId))e.splice(f,1),e.splice(L(e,c),0,c),
this.applyRule()}},"update"),index_:null,orderDesc:!1,offset:0,limit:10,listen:{source:{itemsChanged:function(a,c){var e=this.sourceMap_,f=this.index_,d=this.ruleEvents,g=!1,k=!1,h,n=c.inserted,q=c.deleted;if(q){q.length>f.length-q.length&&(g=!0,k=q.length!=f.length,f.length=0);for(var r=0,v;v=q[r];r++)g||(h=e[v.basisObjectId],f.splice(L(f,h),1)),delete e[v.basisObjectId],d&&v.removeHandler(d,this);if(k)for(var t in e)h=e[t],f.splice(L(f,h),0,h)}if(n){k=!f.length;for(r=0;v=n[r];r++)h={object:v,value:this.rule(v)},
e[v.basisObjectId]=h,k?f.push(h):f.splice(L(f,h),0,h),d&&v.addHandler(d,this);k&&f.sort(Y)}this.applyRule()}}},emit_rangeChanged:C("rangeChanged","oldOffset","oldLimit"),init:function(){this.index_=[];I.prototype.init.call(this)},setRange:function(a,c){var e=this.offset,f=this.limit,d=!1;if(e!=a||f!=c)this.offset=a,this.limit=c,d=this.applyRule(),this.emit_rangeChanged(e,f);return d},setOffset:function(a){return this.setRange(a,this.limit)},setLimit:function(a){return this.setRange(this.offset,a)},
setRule:function(a,c){a=t(a);this.orderDesc=!!c;if(this.rule!=a){for(var e=this.index_,f=0;f<e.length;f++)e[f].value=a(e[f].object);this.rule=a;e.sort(Y)}return this.applyRule()},applyRule:function(){var a=this.offset,c=a+this.limit;this.orderDesc&&(a=this.index_.length-c,c=a+this.limit);for(var e=d.object.slice(this.members_),a=this.index_.slice(Math.max(0,a),Math.max(0,c)),c=[],f,g=0,h;h=a[g];g++){var k=h.object.basisObjectId;e[k]?delete e[k]:(c.push(h.object),this.members_[k]=h.object)}for(k in e)delete this.members_[k];
(f=z(c,y(e)))&&this.emit_itemsChanged(f);return f},destroy:function(){I.prototype.destroy.call(this);this.index_=null}});u=H(I,{className:u+".Cloud",subsetClass:r,subsetWrapperClass:X,rule:t(F),ruleEvents:E(function(a){var c=this.sourceMap_,e=this.members_,f=a.basisObjectId,d=c[f].list,c=c[f].list={},f=this.rule(a),g,k=[],h=[],n;if(Array.isArray(f))for(var q=0;q<f.length;q++)(n=this.keyMap.get(f[q],!0))&&!n.has(a)&&(r=n.basisObjectId,c[r]=n,d[r]||(n.dataset.emit_itemsChanged({inserted:[a]}),e[r]?
e[r]++:(k.push(n),e[r]=1)));for(var r in d)c[r]||(n=d[r],n.dataset.emit_itemsChanged({deleted:[a]}),--e[r]||(delete e[r],h.push(n)));(g=z(k,h))&&this.emit_itemsChanged(g)},"update"),keyMap:null,map:g,listen:{source:{itemsChanged:function(a,c){var e=this.sourceMap_,f=this.members_,d=this.ruleEvents,g,k,h,n=[],q=[];N.setAccumulateState(!0);if(g=c.inserted)for(var r=0,v;v=g[r];r++){var t=this.rule(v),y={object:v,list:{}};e[v.basisObjectId]=y;if(Array.isArray(t))for(var b=0,E={};b<t.length;b++)(k=this.keyMap.get(t[b],
!0))&&!E[k.basisObjectId]&&(h=k.basisObjectId,E[h]=!0,y.list[h]=k,k.dataset.emit_itemsChanged({inserted:[v]}),f[h]?f[h]++:(n.push(k),f[h]=1));d&&v.addHandler(d,this)}if(g=c.deleted)for(r=0;v=g[r];r++){k=v.basisObjectId;t=e[k].list;delete e[k];for(h in t)k=t[h],k.dataset.emit_itemsChanged({deleted:[v]}),--f[h]||(delete f[h],q.push(k));d&&v.removeHandler(d,this)}N.setAccumulateState(!1);(c=z(n,q))&&this.emit_itemsChanged(c)}}},init:function(){this.keyMap&&!1!=this.keyMap instanceof q||(this.keyMap=
Q(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));I.prototype.init.call(this)},getSubset:function(a,c){return this.keyMap.get(a,c)},destroy:function(){I.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});A.exports={createRuleEvents:E,Merge:M,Subtract:h,SourceDataset:I,MapFilter:K,Subset:D,Split:J,Slice:C,Cloud:u}},"4.js":function(h,A,d,D,J,u,H,X){function z(d){if(0<d.basisGetterId_){var h="getter(";if("string"==typeof d.base)h+='"'+d.base.replace(/"/g,'\\"')+'"';
else if(d.mod)h+=z(d.base);else return z(d.base);d.mod&&(h="string"==typeof d.mod?h+(', "'+d.mod.replace(/"/g,'\\"')+'"'):h+(", "+z(d.mod)));return h+")"}return Function.prototype.toString.call(d)}A.exports={fn:function(h){var u=Function.prototype.toString.call(h),L=u.match(/^\s*function(\s+\S+)?\s*\((\s*(?:\S+|\/\*[^*]+\*\/)(\s*(?:,\s*\S+|\/\*[^*]+\*\/))*\s*)?(?:[\r\n]+[^\)]*)?\)/),A=u.replace(/^\s*\(?\s*function[^(]*\([^\)]*\)[^{]*\{|\}\s*\)?\s*$/g,"");h=z(h);var R=(L&&L[2]||"").replace(/\s*,\s*/g,
", ");L||d.dev.log("Function parse error: "+u);return{source:u,name:(L&&L[1]||"anonymous").trim(),fullname:name+"("+R+")",args:R,body:A,getter:h!=u?h:!1}}}},"5.js":function(h,A,d,D,J,u,H,X){var z="undefined"!==typeof performance?performance:Date,E="webkitNow"in z?"webkitNow":"now";A.exports={time:function(d){return arguments.length?parseInt(z[E]()-d):z[E]()},test:function(d,h){for(var u=this.time(),z=0;z<d;z++)h(z);return this.time(u)}}},"6.js":function(h,A,d,D,J,u,H,X){var z=d.number.lead,E=d.string.repeat,
Q={};h={add:function(d,h){Q[d]=h}};h.add("text",d.array);h.add("js",function(){var d=RegExp("\\b(break|case|catch|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|super|switch|this|throw|true|try|typeof|var|while|with)\\b","g");return function(h){function u(g,n,t,q){v!=n&&y.push(h.substring(v,n).replace(d,'<span class="token-keyword">$1</span>'));v=t+1;g&&y.push('<span class="token-'+g+'">'+h.substring(n,t+1)+"</span>"+(q||""))}for(var y=[],t=h.split(""),g,v=0,z,
n=0;n<t.length;n++)if("'"==t[n]||'"'==t[n])for(z=t[n],g=n;++n<t.length;){"\\"==t[n]&&("\n"==t[n+1]?(u("string",g,n),g=++n+1):n+=2);if(t[n]==z){u("string",g,n);break}if("\n"==t[n])break}else if("/"==t[n])if(g=n,n++,"/"==t[n]){for(;++n<t.length&&"\n"!=t[n];);u("comment",g,n-1)}else if("*"==t[n])for(;++n<t.length;)if("*"==t[n]&&"/"==t[n+1]){u("comment",g,++n);break}else"\n"==t[n]&&(u("comment",g,n-1,"\n"),v=g=n+1);u(null,h.length);return y}}());h.add("css",function(){var d=RegExp("(^|[^a-z0-9-])((?:-webkit-|-o-|-ms-|-moz-|-khtml-)?(?:transition|transition-delay|transition-duration|transition-property|transition-timing-function|transform|transform-origin|background-origin|background-clip|background-size|border-image|border-image-outset|border-image-repeat|border-image-slice|border-image-source|border-image-width|border-radius|border-top-right-radius|border-bottom-right-radius|border-bottom-left-radius|border-top-left-radius|box-decoration-break|box-shadow|column-count|column-fill|column-gap|column-rule|column-rule-color|column-rule-style|column-rule-width|columns|column-span|column-width)|(?:azimuth|background-attachment|background-color|background-image|background-position|background-repeat|background|border-collapse|border-color|border-spacing|border-style|border-top|border-right|border-bottom|border-left|border-top-color|border-right-color|border-bottom-color|border-left-color|border-top-style|border-right-style|border-bottom-style|border-left-style|border-top-width|border-right-width|border-bottom-width|border-left-width|border-width|border|bottom|caption-side|clear|clip|color|content|counter-increment|counter-reset|cue-after|cue-before|cue|cursor|direction|display|elevation|empty-cells|float|font-family|font-size|font-style|font-variant|font-weight|font|height|left|letter-spacing|line-height|list-style-image|list-style-position|list-style-type|list-style|margin-right|margin-left|margin-top|margin-bottom|margin|max-height|max-width|min-height|min-width|orphans|outline-color|outline-style|outline-width|outline|overflow|padding-top|padding-right|padding-bottom|padding-left|padding|page-break-after|page-break-before|page-break-inside|pause-after|pause-before|pause|pitch-range|pitch|play-during|position|quotes|richness|right|speak-header|speak-numeral|speak-punctuation|speak|speech-rate|stress|table-layout|text-align|text-decoration|text-indent|text-transform|top|unicode-bidi|vertical-align|visibility|voice-family|volume|white-space|widows|width|word-spacing|z-index))(s|:|$)",
"gi"),h=RegExp("\\b(left-side|far-left|left|center-left|center-right|center|far-right|right-side|right|behind|leftwards|rightwards|inherit|scroll|fixed|transparent|none|repeat-x|repeat-y|repeat|no-repeat|collapse|separate|auto|top|bottom|both|open-quote|close-quote|no-open-quote|no-close-quote|crosshair|default|pointer|move|e-resize|ne-resize|nw-resize|n-resize|se-resize|sw-resize|s-resize|text|wait|help|ltr|rtl|inline|block|list-item|run-in|compact|marker|table|inline-table|table-row-group|table-header-group|table-footer-group|table-row|table-column-group|table-column|table-cell|table-caption|below|level|above|higher|lower|show|hide|caption|icon|menu|message-box|small-caption|status-bar|normal|wider|narrower|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded|italic|oblique|small-caps|bold|bolder|lighter|inside|outside|disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-greek|lower-alpha|lower-latin|upper-alpha|upper-latin|hebrew|armenian|georgian|cjk-ideographic|hiragana|katakana|hiragana-iroha|katakana-iroha|crop|cross|invert|visible|hidden|always|avoid|x-low|low|medium|high|x-high|static|relative|absolute|portrait|landscape|spell-out|once|digits|continuous|code|x-slow|slow|fast|x-fast|faster|slower|justify|underline|overline|line-through|blink|capitalize|uppercase|lowercase|embed|bidi-override|baseline|sub|super|text-top|middle|text-bottom|silent|x-soft|soft|loud|x-loud|pre|nowrap|serif|sans-serif|cursive|fantasy|monospace|empty|string|strict|loose|char|true|false|dotted|dashed|solid|double|groove|ridge|inset|outset|larger|smaller|xx-small|x-small|small|large|x-large|xx-large|all|newspaper|distribute|distribute-all-lines|distribute-center-last|inter-word|inter-ideograph|inter-cluster|kashida|ideograph-alpha|ideograph-numeric|ideograph-parenthesis|ideograph-space|keep-all|break-all|break-word|lr-tb|tb-rl|thin|thick|inline-block|w-resize|hand|distribute-letter|distribute-space|whitespace|ignore)\\b",
"g");return function(u){function y(g,n,q,v){if(z!=n){var y=u.substring(z,n);C&&(y=B?y.replace(h,'<span class="token-value">$1</span>'):y.replace(d,'$1<span class="token-key">$2</span>$3'));t.push(y)}z=q+1;g&&t.push('<span class="token-'+g+'">'+u.substring(n,q+1)+"</span>"+(v||""))}for(var t=[],g=u.split(""),v=0,z=0,n,C=!1,B=!1,A=!1,q=0;q<g.length;q++)if("'"==g[q]||'"'==g[q])for(n=g[q],v=q;++q<g.length;){if(g[q]==n){y("string",v,q);break}if("\n"==g[q])break;"\\"==g[q]&&"\n"==g[q+1]&&(y("string",v,
q),v=++q+1)}else if("/"==g[q]){if(v=q,q++,"*"==g[q])for(;++q<g.length;)if("*"==g[q]&&"/"==g[q+1]){y("comment",v,++q);break}else"\n"==g[q]&&(y("comment",v,q-1,"\n"),z=v=q+1)}else"{"==g[q]?(C=!0,A=B=!1,v=q+1,y("",v,q)):"("==g[q]?B&&(A=!0):")"==g[q]?B&&(A=!1):":"==g[q]?C&&!A&&(v=q+1,y("",v,q),B=!0):";"==g[q]?C&&!A&&(v=q+1,y("",v,q),B=!1):"}"==g[q]&&(B=C=!1);y(null,u.length);return t}}());A.exports={highlight:function(d,h,u){u||(u={});d=(Q[h]||Q.text)(function(d){d=d.trimRight().replace(/\r\n|\n\r|\r/g,
"\n");u.keepFormat||(d=d.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));d=d.replace(/\n[ \t]+/g,function(d){return d.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!u.keepFormat){for(var g=1E3,h=d.split(/\n+/),t=Number(null!=d.match(/^function/));t<h.length;t++){var y=h[t].match(/^\s*/);y[0].length<g&&(g=y[0].length);if(0==g)break}0<g&&(d=d.replace(RegExp("(^|\\n) {"+g+"}","g"),"$1"))}return d=d.replace(RegExp("(^|\\n)( +)","g"),function(d,g,h){return g+E(" ",h.length)})}(d||"").replace(/</g,"&lt;")).join("").split("\n");
h=String(d.length).length;for(var y=[],t=u.noLineNumber?"":" hasLineNumber",g=0;g<d.length;g++)y.push('<div class="line '+(g%2?"odd":"even")+t+'"><span class="lineContent">'+(u.noLineNumber?"":'<input class="lineNumber" value="'+z(g+1,h)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>')+(d[g]+"\r\n")+"</span></div>");return y.join("")},useStyle:d.fn.runOnce(function(){d.resource("./0.css")().startUse()})}}};(function(h){function A(a,b){for(var c in b)a[c]=
b[c];return a}function d(a,b){for(var c in b)!1==c in a&&(a[c]=b[c]);return a}function D(a){var b=[],c;for(c in a)b.push(c);return b}function J(a,b){var c={};if(!b)return A(c,a);for(var e=0,d;d=b[e++];)d in a&&(c[d]=a[d]);return c}function u(){return y(arguments).reduce(A,{})}function H(a,b,c){var e=[],d;for(d in a)e.push(b.call(c,d,a[d]));return e}function X(a){return a}function z(){}function E(a){var b=e[a.url];if(b)for(var c=0;c<b.length;c++)b[c](a.get(),a.url)}function Q(a,b,c){try{return new Function(b,
c)}catch(e){C.error("Compilation error at "+a+("line"in e?":"+(e.line-1):"")+": "+e)}}function L(a){var b=a.split(".")[0],c=a.replace(/\./g,"/")+".js";!1==a in w&&(!1==b in S&&(S[b]=r.baseURI),b==a&&(ba[S[b]+c]=b),w[a]=S[b]+c);return w[a]}function Y(a){a=a.split(".");var b;b=a[0];var c=k[b];c||(c=k[b]=new ca(b),c.namespaces_={},c.namespaces_[b]=c,N.noConflict||(h[b]=c));for(var c=b=c,e=1,d;d=a[e];e++){if(!c[d]){var f=a.slice(0,e+1).join(".");c[d]=new ca(f);b.namespaces_[f]=c[d]}c=c[d]}return k[a.join(".")]=
c}function R(a,c){if(N.extProto)for(var b in c)a.prototype[b]=function(a,b){return function(){var b=[this];Array.prototype.push.apply(b,arguments);return c[a].apply(c,b)}}(b,a.name||a.toString().match(/^\s*function\s*(\w*)\s*\(/)[1])}function y(a,b){if(null!=a){var c=a.length;if("undefined"==typeof c||"[object Function]"==v.call(a))return[a];b||(b=0);if(0<c-b){for(var e=[],d=0,f=b;f<c;)e[d++]=a[f++];return e}}return[]}function t(a,b,c){for(var e=[],d="function"==typeof b,f=0;f<a;f++)e[f]=d?b.call(c,
f,e):b;return e}var g=h.document,v=Object.prototype.toString,F=function(){function a(b){if(c.test(b)){var l=b.split("."),e=l[0],d=l[1],s=l[2];switch(l.length){case 1:b=function(a){return null!=a?a[e]:a};break;case 2:b=function(a){return null!=a?a[e][d]:a};break;case 3:b=function(a){return null!=a?a[e][d][s]:a};break;default:b=function(a){if(null!=a){a=a[e][d][s];for(var b=3,c;c=l[b];b++)a=a[c]}return a}}return b}return new Function("object","return object != null ? object."+b+" : object")}var b=1,
c=/^[a-z$_][a-z$_0-9]*(\.[a-z$_][a-z$_0-9]*)*$/i,e=[],d={},f={};return function(c,x){var g,h,k;if(!c||c===n)return n;"function"==typeof c?(k=c.basisGetterId_)?g=e[Math.abs(k)-1]:(g=function(a){return c(a)},g.base=c,g.__extend__=F,k=e.push(g),c.basisGetterId_=-k,g.basisGetterId_=k):(g=d[c])?k=g.basisGetterId_:(g=a(c),g.base=c,g.__extend__=F,k=e.push(g),g.basisGetterId_=k,d[c]=g);h=null!=x&&typeof x;if(!h)return g;var q=f[k],p;if("string"==h)p=h+x;else if("function"==h)p=x.basisModId_;else if("object"!=
h)return g;if(p&&q&&q[p])return q[p];"function"==typeof g.base&&(g=g.base);switch(h){case "string":h=function(a){return m.format(x,g(a))};break;case "function":p||(p=h+b++,x.basisModId_=p);h=function(a){return x(g(a))};break;default:h=function(a){return x[g(a)]}}h.base=g.base||g;h.__extend__=F;p&&(q||(q={},f[k]=q),q[p]=h,h.mod=x,h.basisGetterId_=e.push(h));return h}}(),n=A(function(){},{__extend__:F}),C=function(){var a={log:z,info:z,warn:z,error:z};"undefined"!=typeof console&&H(a,function(b){a[b]=
"bind"in Function.prototype&&"function"==typeof console[b]?Function.prototype.bind.call(console[b],console):function(){Function.prototype.apply.call(console[b],console,arguments)}});return a}(),B=h.setImmediate||h.msSetImmediate,U=h.clearImmediate||h.msSetImmediate;B&&(B=B.bind(h));U&&(U=U.bind(h));B||function(){var a=function(){var a={},b=1;B=function(){a[++b]={fn:arguments[0],args:y(arguments,1)};c(b);return b};U=function(b){delete a[b]};return function(b){var c=a[b];if(c)try{"function"==typeof c.fn?
c.fn.apply(void 0,c.args):(h.execScript||function(a){h.eval.call(h,a)})(String(c.fn))}finally{delete a[b]}}}(),b=function(b){setTimeout(function(){a(b)},0)},c=b;if(h.process&&"function"==typeof process.nextTick)c=function(b){process.nextTick(function(){a(b)})};else if(h.MessageChannel)c=function(b){var c=new h.MessageChannel;c.port1.onmessage=function(){a(b)};c.port2.postMessage("")};else{var e=h.postMessage&&!h.importScripts;if(e){var d=h.onmessage;h.onmessage=function(){e=!1};h.postMessage("","*");
h.onmessage=d}e?(d=function(b){b&&b.source==h&&(b=String(b.data).split("basisjs.setImmediate")[1])&&a(b)},h.addEventListener?h.addEventListener("message",d,!0):h.attachEvent("onmessage",d),c=function(a){h.postMessage("basisjs.setImmediate"+a,"*")}):g&&"onreadystatechange"in g.createElement("script")&&(c=function ma(e){"undefined"!=typeof V&&(c=b,V.head.ready(function(){c=function(b){var c=g.createElement("script");c.onreadystatechange=function(){a(b);c.onreadystatechange=null;V.remove(c);c=null};
V.head.add(c)}}));c===ma?b(e):c(e)})}}();var q="object"==typeof process&&"[object process]"==v.call(process),r=function(){var a=/^([^\/]+:|\/)/,b=/^[a-zA-Z0-9\-]+:\/?/,c=/^(?:[a-zA-Z0-9\-]+:)?\/\/[^\/]+\/?/,e=/[\?#].*$/,d={},f="",g;q?(f=require("path").resolve(".").replace(/\\/g,"/"),g=f.replace(/^[^\/]*/,""),f=f.replace(/\/.*/,"")):(g=location.pathname.replace(/[^\/]+$/,""),f=location.protocol+"//"+location.host);return d={baseURI:g,origin:f,normalize:function(a){a=(a||"").replace(b,"/").replace(c,
"/").replace(e,"");for(var l=[],d=a.split("/"),f=0;f<d.length;f++)".."==d[f]?(1<l.length||l[0])&&l.pop():!d[f]&&f||"."==d[f]||l.push(d[f]);return l.join("/")||("/"===a[0]?"/":"")},dirname:function(a){a=d.normalize(a);return a.replace(/\/([^\/]*)$|^[^\/]+$/,"")||("/"==a[0]?"/":".")},extname:function(a){return(a=d.normalize(a).match(/[^\/](\.[^\/\.]*)$/))?a[1]:""},basename:function(a,b){var c=d.normalize(a).match(/[^\\\/]*$/),c=c?c[0]:"";b==d.extname(c)&&(c=c.substring(0,c.length-b.length));return c},
resolve:function(b,c){for(var e=y(arguments).reverse(),f=[],s=!1,x=0;!s&&x<e.length;x++)"string"==typeof e[x]&&(f.unshift(e[x]),s=a.test(e[x]));s||f.unshift("/"==g?"":g);return d.normalize(f.join("/"))},relative:function(a,b){"string"!=typeof b&&(b=a,a=g);a=d.normalize(a);b=d.normalize(b);if("/"==a[0]&&"/"!=b[0])return a;if("/"==b[0]&&"/"!=a[0])return b;for(var c=a.replace(/^\/$/,"").split(/\//),l=b.replace(/^\/$/,"").split(/\//),e=[],f=0;l[f]==c[f]&&"string"==typeof c[f];)f++;for(c=c.length-f;0<
c;c--)e.push("..");return e.concat(l.slice(f).filter(Boolean)).join("/")}}}(),N={path:{basis:""}},M=function(){function a(b){return"function"==typeof b&&!!b.basisClassId_}function b(a){for(var c=this;c&&c!==a;)c=c.superClass_;return c===a}function c(h,m){var n=f++;"function"!=typeof h&&(h=k);var p=function(){};p.prototype=h.prototype;for(var p=new p,n={basisClassId_:n,superClass_:h,extendConstructor_:!!h.extendConstructor_,isSubclassOf:b,subclass:function(){return c.apply(null,[t].concat(y(arguments)))},
extend:e,__extend__:function(b){return b&&b!==g&&("object"==typeof b||"function"==typeof b&&!a(b))?k.create.call(null,t,b):b},prototype:p},q=1,r;r=arguments[q];q++)n.extend(r);var t=n.extendConstructor_?function(a){this.basisObjectId=d.id++;var b,c;for(c in a)b=this[c],this[c]=b&&b.__extend__?b.__extend__(a[c]):a[c];this.init();this.postInit()}:function(){this.basisObjectId=d.id++;this.init.apply(this,arguments);this.postInit()};p.constructor=t;for(var u in p)p[u]===g&&(p[u]=t);A(t,n);return t}function e(b){var c=
this.prototype;"function"!=typeof b||a(b)||(b=b(this.superClass_.prototype));b.prototype&&(b=b.prototype);for(var d in b){var f=b[d],s=c[d];"className"==d||"extendConstructor_"==d?this[d]=f:c[d]=s&&s.__extend__?s.__extend__(f):f}h&&b[d="toString"]!==v&&(c[d]=b[d]);return this}var d={id:1},f=1,g={},h=function(){for(var a in{toString:1})return!1;return!0}(),k=A(c,{className:"basis.Class",extendConstructor_:!1,prototype:{basisObjectId:0,constructor:null,init:function(){},postInit:function(){},destroy:function(){for(var a in this)hasOwnProperty.call(this,
a)&&(this[a]=null);this.destroy=z}}}),m=function(a,b,c){return{__extend__:function(a){if(!a||a&&a.__extend__)return a;var c=function(){};c.prototype=this;c=new c;b(c,a);return c}}.__extend__(a||{})},n=function(a){return m(a,A,"extensibleProperty")};return A(k,{SELF:g,create:c,isClass:a,customExtendProperty:m,extensibleProperty:n,nestedExtendProperty:function(a){return m(a,function(a,b){for(var c in b){var l=a[c];a[c]=l&&l.__extend__?l.__extend__(b[c]):n(b[c])}},"nestedExtendProperty")},oneFunctionProperty:function(a,
b){var c=function(b){var l={__extend__:c};if(b){if(b.__extend__)return b;for(var d in b)b[d]&&(l[d]=a)}return l};return c(b||{})}})}(),G=M(null,{className:"basis.Token",value:null,handler:null,deferredToken:null,bindingBridge:{attach:function(a,b,c){a.attach(b,c)},detach:function(a,b,c){a.detach(b,c)},get:function(a){return a.get()}},init:function(a){this.value=a},get:function(){return this.value},set:function(a){this.value!==a&&(this.value=a,this.apply())},attach:function(a,b){this.handler={fn:a,
context:b,handler:this.handler}},detach:function(a,b){for(var c=this,d;d=c,c=c.handler;)if(c.fn===a&&c.context===b){c.fn=z;d.handler=c.handler;break}},apply:function(){for(var a=this.get(),b=this;b=b.handler;)b.fn.call(b.context,a)},deferred:function(){var a=this.deferredToken;a||(a=this.deferredToken=new O.DeferredToken(this.value),this.attach(a.set,a));return a},destroy:function(){this.deferredToken&&(this.deferredToken.destroy(),this.deferredToken=null);this.value=this.handler=null;this.detach=
this.attach=z}}),I=function(){function a(){var l=b;b={};c=null;for(var d in l)l[d].apply()}var b={},c;return function(d){d.basisObjectId in b||(b[d.basisObjectId]=d,c||B(a))}}(),K=G.subclass({className:"basis.DeferredToken",set:function(a){this.value!==a&&(this.value=a,I(this))},deferred:function(){return this}}),a={},c={},e={};(function(){var a="undefined"!=typeof ka?ka:null;if(a){for(var b in a)c[r.resolve(b)]=a[b];ka=null}})();var f=function(a,b){if(b||!c.hasOwnProperty(a)){var d="";if(q)try{d=
require("fs").readFileSync(a,"utf-8")}catch(e){}else{var f=new XMLHttpRequest;f.open("GET",a,!1);f.setRequestHeader("If-Modified-Since",(new Date(0)).toGMTString());f.setRequestHeader("X-Basis-Resource",1);f.send("");200<=f.status&&400>f.status&&(d=f.responseText)}c[a]=d}return c[a]},p=function(b){b=r.resolve(b);if(!a[b]){var d=p.extensions[r.extname(b)],e=!1,g=!1,h,k=function(){if(e)return h;var a=f(b);d?g||(g=!0,h=d(a,b)):h=a;e=!0;E(k);k.apply();return h};A(k,A(new G,{url:b,fetch:function(){return k()},
toString:function(){return"[basis.resource "+b+"]"},isResolved:function(){return e},update:function(a){a=String(a);e&&a==c[b]||(c[b]=a,d?g&&!d.permanent&&(h=d(a,b),E(k),k.apply()):(h=a,e=!0,E(k),k.apply()))},reload:function(){var a=c[b],d=f(b,!0);d!=a&&(e=!1,k.update(d))},get:function(a){return a?f(b):k()},ready:function(a,b){if(e&&(a.call(b,k()),d&&d.permanent))return;k.attach(a,b);return k}}));a[b]=k}return a[b]};A(p,{isResource:function(b){return b?a[b.url]===b:!1},isResolved:function(a){return(a=
p.get(a))?a.isResolved():!1},exists:function(b){return a.hasOwnProperty(r.resolve(b))},get:function(a){a=r.resolve(a);return p.exists(a)?p(a):null},getFiles:function(b){return D(b?c:a).map(r.relative)},extensions:{".js":A(function(a,b){var c=ba[b];if(!c){var e=!0,c=r.dirname(b)+"/"+r.basename(b,r.extname(b)),f;for(f in N.path){var g=N.path[f]+f+"/";if(b.substr(0,g.length)==g){e=!1;c=c.substr(N.path[f].length);break}}c=c.replace(/\./g,"_").replace(/^\//g,"").replace(/\//g,".");e&&(c="implicit."+c)}k[c]||
(f=Y(c),f.exports=T({path:f.path,exports:f.exports},b,a).exports,f.exports&&f.exports.constructor===Object&&d(f,f.exports));return k[c].exports},{permanent:!0}),".css":function(a,b){var c=W.resources[b];c?c.updateCssText(a):c=new W(b);return c},".json":function(a,b){if("object"==typeof a)return a;var c;try{a=String(a),c=O.json.parse(a)}catch(d){}return c||null}}});var T=function(a,b,c){var d=r.dirname(b)+"/",e=c;a.exports||(a.exports={});"function"!=typeof e&&(e=Q(b,"exports module basis global __filename __dirname resource require".split(" "),
'"use strict";\n'+c));"function"==typeof e&&e.call(a.exports,a.exports,a,O,h,b,d,function(a){return p(r.resolve(d,a))},function(a,b){return Z(a,b||d)});return a},k={},w={},ba={},S=J(N.path);(function(a){if(a="undefined"!=typeof la?la:null)for(var b in a){var c=r.resolve(b),d=a[b];ba[c]=d;w[d]=c}})();var ca=M(null,{className:"basis.Namespace",init:function(a){this.name=a;this.exports={path:this.name}},toString:function(){return"[basis.namespace "+this.path+"]"},extend:function(a){A(this.exports,a);
return d(this,a)}}),Z=function(){if(q){var a=module.constructor.prototype;return function(b,c){if(/[^a-z0-9_\.]/i.test(b)&&".js"!=r.extname(b))return b=r.resolve(c,b),require(b);var e=a._compile,f=Y(b);a._compile=function(a,b){this.basis=O;a='var node_require = require;\nvar basis = module.basis;\nvar resource = function(filename){ return basis.resource(__dirname + "/" + filename) };\nvar require = function(filename, baseURI){ return basis.require(filename, baseURI || __dirname) };\n'+a;e.call(A(this,
f),a,b)};var g=require(__dirname+"/"+b.replace(/\./g,"/"));(f.exports=g)&&g.constructor===Object&&d(f,g);a._compile=e;return g}}return function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==r.extname(a)?r.resolve(b,a):L(a);return p(a).fetch()}}();d(Function.prototype,{bind:function(a){var b=this,c=y(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});d(Array,{isArray:function(a){return"[object Array]"===v.call(a)}});d(Array.prototype,
{indexOf:function(a,b){b=parseInt(b,10)||0;if(0>b)return-1;for(;b<this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){var c=this.length;b=parseInt(b,10);for(b=isNaN(b)||b>=c?c-1:(b+c)%c;0<=b;b--)if(this[b]===a)return b;return-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0},some:function(a,b){for(var c=0,d=this.length;c<
d;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1},filter:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);return c},map:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c},reduce:function(a,b){var c=this.length,d=arguments.length;if(0==c&&1==d)throw 1;var e,f=0;1<d&&(e=b,f=1);for(d=0;d<c;d++)d in this&&(e=f++?a.call(null,e,this[d],d,this):this[d]);return e}});var $={flatten:function(a){return a.concat.apply([],
a)},repeat:function(a,b){return $.flatten(t(parseInt(b,10)||0,a))},search:function(a,b,c,d){a.lastSearchIndex=-1;c=F(c||X);d=parseInt(d,10)||0;for(var e=a.length;d<e;d++)if(c(a[d])===b)return a[a.lastSearchIndex=d]},lastSearch:function(a,b,c,d){a.lastSearchIndex=-1;c=F(c||X);var e=a.length;d=isNaN(d)||null==d?e:parseInt(d,10);for(e=d>e?e:d;0<e--;)if(c(a[e])===b)return a[a.lastSearchIndex=e]},add:function(a,b){return-1==a.indexOf(b)&&!!a.push(b)},remove:function(a,b){var c=a.indexOf(b);return-1!=c&&
!!a.splice(c,1)},has:function(a,b){return-1!=a.indexOf(b)},sortAsObject:function(a,b,c,d){b=F(b);d=d?-1:1;return a.map(function(a,c){return{i:c,v:b(a)}}).sort(c||function(a,b){return d*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(b){return a[b.i]},a)}};R(Array,$);if(![1,2].splice(1).length){var ga=Array.prototype.splice;Array.prototype.splice=function(){var a=y(arguments);2>a.length&&(a[1]=this.length);return ga.apply(this,a)}}var b=/([\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$])/g,da=/\{([a-z\d_]+)(?::([\.0])(\d+)|:(\?))?\}/gi;
d(String,{toLowerCase:function(a){return String(a).toLowerCase()},toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()}});d(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});var m={toObject:function(a,b){try{return(new Function("return 0,"+
a))()}catch(c){if(b)throw 2;}},repeat:function(a,b){return Array(parseInt(b,10)+1||0).join(a)},qw:function(a){return(a=a.trim())?a.split(/\s+/):[]},forRegExp:function(a){return a.replace(b,"\\$1")},format:function(a,b){var c=y(arguments,1);"object"==typeof b&&A(c,b);return a.replace(da,function(a,b,d,e,f){a=b in c?c[b]:f?"":a;return d&&!isNaN(a)?(a=Number(a),"."==d?a.toFixed(e):ha.lead(a,e)):a})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},camelize:function(a){return a.replace(/-(.)/g,
function(a,b){return b.toUpperCase()})},dasherize:function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}};R(String,m);if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length){var ea=String.prototype.split;String.prototype.split=function(a,b){if(!a||!1==a instanceof RegExp||""==a.source)return ea.apply(this,arguments);var c=[],d=0,e;for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));e=a.exec(this);)e[0]=this.substring(d,e.index),c.push.apply(c,e),d=a.lastIndex;
c.push(this.substr(d));return c}}if("2"!="12".substr(-1)){var ia=String.prototype.substr;String.prototype.substr=function(a,b){return ia.call(this,0>a?Math.max(0,this.length+a):a,b)}}var ha={fit:function(a,b,c){return!isNaN(b)&&a<b?Number(b):!isNaN(c)&&a>c?Number(c):a},lead:function(a,b,c){return String(a).replace(/\d+/,function(a){return 1<(b-=a.length-1)?Array(b).join(c||0)+a:a})},group:function(a,b,c){return String(a).replace(/\d+/,function(a){return a.replace(/\d/g,function(d,e){return!e+(a.length-
e)%(b||3)?d:(c||" ")+d})})},format:function(a,b,c,d,e,f){a=a.toFixed(b);if(c||f)a=a.replace(/(\d+)(\.?)/,function(a,b,d){return(c?O.number.group(Number(b),3,c):b)+(d?f||d:"")});d&&(a=a.replace(/^-?/,"$&"+(d||"")));return a+(e||"")}};R(Number,ha);d(Date,{now:function(){return Number(new Date)}});var fa=function(){function a(){if("complete"==g.readyState&&g.body&&!c++)for(;d;)d.callback.call(d.context),d=d.next}function b(){try{g.documentElement.doScroll("left"),a()}catch(c){setTimeout(b,1)}}var c=
!g||"complete"==g.readyState&&!!g.body,d;if(!c)if(g.addEventListener)g.addEventListener("DOMContentLoaded",a,!1),h.addEventListener("load",a,!1);else{g.attachEvent("onreadystatechange",a);h.attachEvent("onload",a);try{!h.frameElement&&g.documentElement.doScroll&&b()}catch(e){}}return function(a,b){c?a.call(b):d={callback:a,context:b,next:d}}}(),V=function(){function a(b){if(g&&!f[b]&&(f[b]=g[b]||g.getElementsByTagName(b)[0],f[b])){var c=h[b];delete h[b];for(var d=0,e;e=c[d];d++)e[0].call(e[1],f[b])}return f[b]}
function b(){var d=this[0],e=this[1],f=this[2];c(e);var g=a(d);g?(!0===f&&(f=g.firstChild),f&&f.parentNode===g||(f=null),g.insertBefore(e,f)):h[d].push([b,[d,e,f]])}function c(a){for(var b in h){var d=$.search(h[b],a,function(a){return a[1]&&a[1][1]});d&&$.remove(h[b],d)}a&&a.parentNode&&1==a.parentNode.nodeType&&a.parentNode.removeChild(a)}function d(){e&&a("head")&&a("body")&&(e=clearInterval(e))}var e,f={},h={head:[],body:[]};!g||a("head")&&a("body")||(e=setInterval(d,5),fa(d));return{head:{ready:function(a,
b){h.head?h.head.push([a,b]):a.call(b,f.head)},add:function(a,c){b.call(["head",a,c])}},body:{ready:function(a,b){h.body?h.body.push([a,b]):a.call(b,f.body)},add:function(a,c){b.call(["body",a,c])}},remove:c}}(),aa=function(){function a(d){c.globalDestroy=!0;c.add=z;for(c.remove=z;d=b.pop();)if("function"==typeof d.destroy)try{d.destroy()}catch(e){}else for(var f in d)d[f]=null;b.length=0}var b=[];if("attachEvent"in h)h.attachEvent("onunload",a);else if("addEventListener"in h)h.addEventListener("unload",
a,!1);else return{add:z,remove:z};var c={add:function(a){null!=a&&b.push(a)},remove:function(a){$.remove(b,a)}};return c}(),W=function(){function a(b){k.setAttribute("href",b);V.head.add(k,!0)}function b(){k.setAttribute("href",location.href);V.remove(k)}function c(){a(this.baseURI);this.element||(this.element=g.createElement("style"),f||(this.textNode=this.element.appendChild(g.createTextNode(""))));V.head.add(this.element);this.syncCssText();b()}var d={},e=!0,f;try{f=!g.createElement("style").appendChild(g.createTextNode(""))}catch(h){f=
!0}aa.add({destroy:function(){e=!1;for(var a in d)d[a].destroy();d=null}});var k=g&&g.createElement("base"),m=M(null,{className:"basis.CssResource",inUse:0,url:"",baseURI:"",cssText:"",resource:null,element:null,textNode:null,init:function(a){this.url=r.resolve(a);this.baseURI=r.dirname(a)+"/";d[a]=this},updateCssText:function(c){this.cssText!=c&&(this.cssText=c,this.inUse&&this.element&&(a(this.baseURI),this.syncCssText(),b()))},syncCssText:function(){this.textNode?this.textNode.nodeValue=this.cssText:
this.element.styleSheet.cssText=this.cssText},startUse:function(){if(!this.inUse){if(!this.resource){var a=p(this.url);this.resource=a;this.cssText=a.get(!0)}V.head.ready(c,this)}this.inUse+=1},stopUse:function(){this.inUse&&(this.inUse-=1,!this.inUse&&this.element&&V.remove(this.element))},destroy:function(){this.element&&e&&V.remove(this.element);this.cssText=this.resource=this.textNode=this.element=null}});m.resources=d;return m}(),O=Y("basis").extend({version:"1.2.0-dev",NODE_ENV:q,config:N,platformFeature:{},
resolveNSFilename:L,patch:function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==r.extname(a)?r.resolve(a):L(a);e[a]?e[a].push(b):e[a]=[b];var c=p.get(a);c&&c.isResolved()&&b(c.get(),c.url)},namespace:Y,require:Z,resource:p,asset:function(a){return a},setImmediate:B,clearImmediate:U,nextTick:function(){B.apply(null,arguments)},Class:M,Token:G,DeferredToken:K,getter:F,ready:fa,cleaner:aa,console:C,path:r,doc:V,object:{extend:A,complete:d,keys:D,values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},
slice:J,splice:function(a,b){var c={};if(!b)return A(c,a);for(var d=0,e;e=b[d++];)e in a&&(c[e]=a[e],delete a[e]);return c},merge:u,iterate:H},fn:{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:function(a){return null==a||void 0==a},$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:X,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},
$null:function(){return null},$undef:z,getter:F,nullGetter:n,wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,d,e;return d=function(){c++||(d.inited=!0,d.data=e=a.apply(b||this,arguments));return e}},lazyInitAndRun:function(a,b,c){var d=0,e,f;return e=function(){d++||(e.inited=!0,e.data=f=a.call(c||this));b.apply(f,arguments);return f}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}},array:A(y,u($,{from:y,
create:t})),string:u(m,{isEmpty:function(a){return null==a||""==String(a)},isNotEmpty:function(a){return null!=a&&""!=String(a)}}),number:ha,bool:{invert:function(a){return!a}},json:{parse:"undefined"!=typeof JSON?JSON.parse:function(a){return m.toObject(a,!0)}}});Y("basis.dev").extend(C);N.autoload&&Z(N.autoload)})(this)}).call(this)