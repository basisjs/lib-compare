(function(){var ma={"0.js":"basis.data","1.js":"basis.event","2.js":"basis.entity","3.js":"basis.data.dataset","4.js":"basis.utils.info","5.js":"basis.utils.benchmark"},la={"0.js":function(g,x,e,y,G,v,z,$){function t(b,da){return function(){b.apply(this,arguments);da.apply(this,arguments)}}function u(b){var da=D[b];if(!da)for(var l=[],a={},c=1,da=D[b]={actions:l,handler:a};b;){if(b&1){var f=J[c];l.push(f.action);for(var d in f.handler)a[d]=a[d]?t(a[d],f.handler[d]):f.handler[d]}c<<=1;b>>=1}return da}
function K(b,a){for(;a&&a!==b&&a!==a.delegate;)a=a.delegate;return a===b}function N(b,a,l){var c=b.delegate;c&&(b.root=c.root,b.target=c.target,b.data=c.data,b.state=c.state);if(b.root!==a){if(c=b.listen.root)a&&a!==b&&a.removeHandler(c,b),b.root&&b.root!==b&&b.root.addHandler(c,b);b.emit_rootChanged(a)}if(b.target!==l){if(c=b.listen.target)l&&l!==b&&l.removeHandler(c,b),b.target&&b.target!==b&&b.target.addHandler(c,b);b.emit_targetChanged(l)}for(b=b.delegates_;b;)b.delegate&&N(b.delegate,a,l),b=
b.next}function V(b,a){var l={},c;b&&b.length&&(c=l.inserted=b);a&&a.length&&(c=l.deleted=a);if(c)return l}function ba(b,a){if(b&&b.itemCount){if(a&&a.itemCount){var l=[],c=[],d;for(d in b.items_){var f=b.items_[d];!1==f.basisObjectId in a.items_&&c.push(f)}for(d in a.items_)f=a.items_[d],!1==f.basisObjectId in b.items_&&l.push(f);return V(l,c)}if(b.itemCount)return{deleted:b.getItems()}}else if(a&&a.itemCount)return{inserted:a.getItems()}}function L(b,a,l,c){var f=b[c]||null,d=null;"function"==typeof l&&
(l=l.call(b,b));l instanceof R&&(d=new W(b,a,l,X),l=l.dataset);l instanceof e.Token&&(l=p.from(l));l instanceof p&&(d=new W(b,a,l,ga),l=L(d,d.proxy,l.value,"adapter_"));!1==l instanceof ca&&(l=null);c&&f!==d&&(f&&(f.source.removeHandler(f.handler,f),f.adapter_&&L(f,null,null,"adapter_")),d&&d.source.addHandler(d.handler,d),b[c]=d);return l}function aa(b){return Array.isArray(b)?b.map(function(b){return{data:b}}):{data:b}}function q(b){b&&b.constructor===Object||(b={value:b});return new m({data:b})}
e.require("./1.js");y=this.path;G=e.Class;var Q=e.cleaner,A=e.object.values;z=e.fn.$self;var C=e.event.Emitter;v=e.event.create;var H=e.event.events,E={},S=[],O={},s={priority:[],values:{},add:function(b,a){var l=b.toLowerCase();s[b]=l;O[l]=b;this.values[l]=b;a=a?this.priority.indexOf(a):-1;-1==a?this.priority.push(l):this.priority.splice(a,0,l)},getList:function(){return A(O)}};s.add("READY");s.add("DEPRECATED");s.add("UNDEFINED");s.add("ERROR");s.add("PROCESSING");var J={},I=1,B={NONE:0,ALL:0,link:function(b,
a,l){b+=a.basisObjectId;var c=l.subscribers_;c||(c=l.subscribers_={});c[b]||(c[b]=a,1==(l.subscriberCount+=1)&&l.emit_subscribersChanged(1))},unlink:function(b,a,l){b+=a.basisObjectId;(a=l.subscribers_)&&a[b]&&(delete a[b],0==(l.subscriberCount-=1)&&(l.emit_subscribersChanged(-1),l.subscribers_=null))},add:function(b,a,l){J[I]={handler:a,action:l};B[b]=I;B.ALL|=I;I<<=1},addProperty:function(b,a){var l={};l[a||b+"Changed"]=function(a,l){l&&B.unlink(b,a,l);a[b]&&B.link(b,a,a[b])};this.add(b.toUpperCase(),
l,function(a,l){l[b]&&a(b,l,l[b])})}},D={};B.addProperty("delegate");B.addProperty("target");B.addProperty("dataset");var F=G(C,{className:y+".AbstractData",state:s.UNDEFINED,emit_stateChanged:v("stateChanged","oldState"),active:!1,emit_activeChanged:v("activeChanged"),subscribeTo:B.NONE,subscriberCount:0,subscribers_:null,emit_subscribersChanged:v("subscribersChanged","delta"),syncEvents:G.oneFunctionProperty(function(){this.isSyncRequired()&&this.syncAction()},{stateChanged:!0,subscribersChanged:!0}),
syncAction:null,init:function(){C.prototype.init.call(this);this.active&&this.addHandler(u(this.subscribeTo).handler);var b=this.syncAction;b&&(this.syncAction=null,this.setSyncAction(b))},setState:function(b,a){var l=String(b);if(!O[l])throw 142;if(this.state!=l||this.state.data!=a){var c=this.state;this.state=Object(l);this.state.data=a;this.emit_stateChanged(c);return!0}return!1},deprecate:function(){this.state!=s.PROCESSING&&this.setState(s.DEPRECATED)},setActive:function(b){b=!!b;if(this.active!=
b){this.active=b;this.emit_activeChanged();if(b){b=u(this.subscribeTo);for(var a=0,l;l=b.actions[a];a++)l(B.link,this);this.addHandler(b.handler)}else{b=u(this.subscribeTo);for(a=0;l=b.actions[a++];)l(B.unlink,this);this.removeHandler(b.handler)}return!0}return!1},setSubscription:function(b){var a=this.subscribeTo,l=b&B.ALL;if(b=a^l){this.subscribeTo=l;if(this.active){var c=u(a),l=u(l);this.removeHandler(c.handler);this.addHandler(l.handler);for(c=1;b;)b&1&&(l=J[c],a&c?l.action(B.unlink,this):l.action(B.link,
this)),c<<=1,b>>=1}return!0}return!1},isSyncRequired:function(){return 0<this.subscriberCount&&(this.state==s.UNDEFINED||this.state==s.DEPRECATED)},setSyncAction:function(b){var a=this.syncAction;"function"!=typeof b&&(b=null);(this.syncAction=b)?(a||this.addHandler(this.syncEvents),this.isSyncRequired()&&this.syncAction()):a&&this.removeHandler(this.syncEvents)},destroy:function(){if(this.active)for(var b=u(this.subscribeTo),a=0,l;l=b.actions[a];a++)l(B.unlink,this);C.prototype.destroy.call(this);
this.state=s.UNDEFINED}}),a={},c={},d=function(b){this.set(this.fn(b))},f={destroy:function(b){this.value.unlink(b,this.fn)}},n={destroy:function(b){this.set(null)}},p=G(F,{className:y+".Value",emit_change:v("change","oldValue")&&function(b){H.change.call(this,b);for(var a=this;a=a.links_;)a.fn.call(a.context,this.value,b)},value:null,initValue:null,proxy:null,locked:!1,lockedValue_:null,links_:null,setNullOnEmitterDestroy:!0,bindingBridge:{attach:function(b,a,l){b.link(l,a,!0)},detach:function(b,
a,l){b.unlink(l,a)},get:function(b){return b.value}},init:function(){F.prototype.init.call(this);this.proxy&&(this.value=this.proxy(this.value));this.setNullOnEmitterDestroy&&this.value instanceof C&&this.value.addHandler(n,this);this.initValue=this.value},set:function(b){var a=this.value;b=this.proxy?this.proxy(b):b;var l=b!==a;l&&(this.setNullOnEmitterDestroy&&(a instanceof C&&a.removeHandler(n,this),b instanceof C&&b.addHandler(n,this)),this.value=b,this.locked||this.emit_change(a));return l},
reset:function(){this.set(this.initValue)},lock:function(){this.locked||(this.locked=!0,this.lockedValue_=this.value)},unlock:function(){if(this.locked){var b=this.lockedValue_;this.lockedValue_=null;this.locked=!1;this.value!==b&&this.emit_change(b)}},compute:function(b,c){c||(c=b,b=null);var l=this,d=e.event.createHandler(b,function(b){this.set(c(b,l.value))}),f=d.events.concat(String(c),this.basisObjectId).join("_"),n=a[f];if(!n){var h={};d.destroy=function(b){delete h[b.basisObjectId];this.destroy()};
this.addHandler({change:function(){for(var b in h){var a=h[b];a.token.set(c(a.object,this.value))}},destroy:function(){for(var b in h){var a=h[b];a.object.removeHandler(d,a.token);a.token.destroy()}l=h=null}});n=a[f]=function(b){var a=b.basisObjectId,f=h[a];f||(f=new e.Token(c(b,l.value)),b.addHandler(d,f),f=h[a]={token:f,object:b});return f.token};n.deferred=function(){return function(b){return n(b).deferred()}}}return n},as:function(b,a){if(this.links_)for(var c=this;c=c.links_;)if(c.context instanceof
e.Token&&c.context.fn==String(b))return a?c.context.deferred():c.context;c=new e.Token;c.fn=b;this.link(c,d);return a?c.deferred():c},deferred:function(b){return this.as(b,!0)},link:function(b,a,l){if("function"!=typeof a){var d=String(a);(a=c[d])||(a=c[d]=function(b){this[d]=b})}this.links_={value:this,context:b,fn:a,links_:this.links_};b instanceof C&&b.addHandler(f,this.links_);l||a.call(b,this.value);return b},unlink:function(b,a){for(var c=this,d;d=c,c=c.links_;)c.context!==b||a&&c.fn!==a||(c.fn=
e.fn.$undef,d.links_=c.links_,c.context instanceof C&&c.context.removeHandler(f,c))},destroy:function(){F.prototype.destroy.call(this);this.setNullOnEmitterDestroy&&this.value instanceof C&&this.value.removeHandler(n,this);for(var b=this;b=b.links_;)b.context instanceof C&&b.context.removeHandler(f,b);this.links_=this.lockedValue_=this.value=this.initValue=this.proxy=null}}),h={};p.from=function(b,a,c){var d;if(!b)return null;if(b instanceof C){c||(c=a,a=null);a=e.event.createHandler(a,function(b){this.set(c(b))});
var f=a.events.concat(String(c),b.basisObjectId).join("_");d=h[f];d||(c=e.getter(c),d=h[f]=new p({value:c(b)}),a.destroy=function(b){delete h[f];this.destroy()},b.addHandler(a,d))}d||(f=b.basisObjectId,a=b.bindingBridge,f&&a&&(d=h[f],d||(d=h[f]=new p({value:a.get(b)}),a.attach(b,d.set,d))));if(!d)throw 143;return d};p.factory=function(b,a){return function(c){return p.from(c,b,a)}};var m=G(F,{className:y+".Object",subscribeTo:B.DELEGATE+B.TARGET,data:null,emit_update:v("update","delta")&&function(b){var a=
this.delegates_;for(H.update.call(this,b);a;)a.delegate&&a.delegate.emit_update(b),a=a.next},emit_stateChanged:function(b){var a=this.delegates_;for(F.prototype.emit_stateChanged.call(this,b);a;)a.delegate&&(a.delegate.state=this.state,a.delegate.emit_stateChanged(b)),a=a.next},delegate:null,delegates_:null,emit_delegateChanged:v("delegateChanged","oldDelegate"),target:null,emit_targetChanged:v("targetChanged","oldTarget"),root:null,emit_rootChanged:v("rootChanged","oldRoot"),init:function(){this.root=
this;F.prototype.init.call(this);var b=this.delegate;b?(this.target=this.delegate=null,this.data=b.data,this.state=b.state,this.setDelegate(b)):(this.data||(this.data={}),null!==this.target&&(this.target=this))},setDelegate:function(b){if(b&&b instanceof m){if(b.delegate&&K(this,b))return!1}else b=null;if(this.delegate!==b){var a=this.state,c=this.data,d=this.delegate,f=this.target,n=this.root,h={},e=!1,Y=this.listen.delegate;if(d){Y&&d.removeHandler(Y,this);for(var U=d.delegates_;U;){if(U.delegate===
this){U.delegate=null;d===d?d.delegates_=U.next:d.next=U.next;break}U=U.next}}if(b){this.delegate=b;b.delegates_={delegate:this,next:b.delegates_};for(var M in b.data)!1===M in c&&(e=!0,h[M]=void 0);for(M in c)c[M]!==b.data[M]&&(e=!0,h[M]=c[M]);Y&&b.addHandler(Y,this)}else for(M in this.target=this.delegate=null,this.root=this,this.data={},c)this.data[M]=c[M];N(this,n,f);e&&this.emit_update(h);a===this.state||String(a)==this.state&&a.data===this.state.data||this.emit_stateChanged(a);this.emit_delegateChanged(d);
return!0}return!1},setState:function(b,a){return this.delegate?this.root.setState(b,a):F.prototype.setState.call(this,b,a)},update:function(b){if(this.delegate)return this.root.update(b);if(b){var a={},c=!1,d;for(d in b)this.data[d]!==b[d]&&(c=!0,a[d]=this.data[d],this.data[d]=b[d]);if(c)return this.emit_update(a),a}return!1},destroy:function(){F.prototype.destroy.call(this);var b=this.delegates_;for(this.delegates_=null;b;)b.delegate.setDelegate(),b=b.next;this.delegate&&this.setDelegate();this.data=
E;this.target=this.root=null}});g=G(m,{className:y+".Slot"});var Z={destroy:function(){delete this.map[this.itemId]}};z=G(null,{className:y+".KeyObjectMap",itemClass:m,keyGetter:z,map_:null,extendConstructor_:!0,init:function(){this.map_={};Q.add(this)},resolve:function(b){return this.get(this.keyGetter(b),b)},create:function(b,a){var c={};b instanceof m?c.delegate=b:c.data={id:b,title:b};return new this.itemClass(c)},get:function(b,a){var c=b instanceof m?b.basisObjectId:b,d=this.map_[c];!d&&a&&
(d=this.map_[c]=this.create(b,a),d.addHandler(Z,{map:this.map_,itemId:c}));return d},destroy:function(){Q.remove(this);for(var b=A(this.map_),a=0,c;c=b[a++];)c.destroy()}});var R=G(m,{className:y+".DatasetWrapper",subscribeTo:m.prototype.subscribeTo+B.DATASET,listen:{dataset:{itemsChanged:function(b,a){this.itemCount=b.itemCount;this.emit_itemsChanged(a)},destroy:function(){this.setDataset()}}},dataset:null,datasetAdapter_:null,emit_datasetChanged:v("datasetChanged","oldDataset"),emit_itemsChanged:v("itemsChanged",
"delta"),init:function(){m.prototype.init.call(this);var b=this.dataset;b&&(this.dataset=null,this.setDataset(b))},setDataset:function(b){b=L(this,this.setDataset,b,"datasetAdapter_");if(this.dataset!==b){var a=this.listen.dataset,c=this.dataset,d;a&&(c&&c.removeHandler(a,this),b&&b.addHandler(a,this));this.itemCount=b?b.itemCount:0;(d=ba(c,b))&&this.emit_itemsChanged(d);this.dataset=b;this.emit_datasetChanged(c)}},has:function(a){return this.dataset?this.dataset.has(a):null},getItems:function(){return this.dataset?
this.dataset.getItems():[]},pick:function(){return this.dataset?this.dataset.pick():null},top:function(a){return this.dataset?this.dataset.top(a):[]},forEach:function(a){if(this.dataset)return this.dataset.forEach(a)},destroy:function(){(this.dataset||this.datasetAdapter_)&&this.setDataset();m.prototype.destroy.call(this)}}),ca=G(F,{className:y+".AbstractDataset",itemCount:0,items_:null,members_:null,cache_:null,emit_itemsChanged:v("itemsChanged","delta")&&function(a){var c,d=0,f=0,n;if(c=a.inserted)for(;n=
c[d];)this.items_[n.basisObjectId]=n,d++;if(c=a.deleted)for(;n=c[f];)delete this.items_[n.basisObjectId],f++;this.itemCount+=d-f;this.cache_=d==this.itemCount?a.inserted:null;H.itemsChanged.call(this,a)},init:function(){F.prototype.init.call(this);this.members_={};this.items_={}},has:function(a){return!(!a||!this.items_[a.basisObjectId])},getItems:function(){this.cache_||(this.cache_=A(this.items_));return this.cache_},pick:function(){for(var a in this.items_)return this.items_[a];return null},top:function(a){var c=
[];if(a)for(var d in this.items_)if(c.push(this.items_[d])>=a)break;return c},forEach:function(a){for(var c=this.getItems(),d=0;d<c.length;d++)a(c[d])},clear:function(){},destroy:function(){this.clear();F.prototype.destroy.call(this);this.cache_=S;this.itemCount=0;this.items_=this.members_=null}});y=G(ca,{className:y+".Dataset",listen:{item:{destroy:function(a){this.remove([a])}}},init:function(){ca.prototype.init.call(this);var a=this.items;a&&(this.items=null,this.set(a))},add:function(a){var c=
this.members_,d=this.listen.item,f=[],n;a&&!Array.isArray(a)&&(a=[a]);for(var h=0;h<a.length;h++){var e=a[h];if(e instanceof m){var p=e.basisObjectId;c[p]||(c[p]=e,d&&e.addHandler(d,this),f.push(e))}}f.length&&this.emit_itemsChanged(n={inserted:f});return n},remove:function(a){var c=this.members_,d=this.listen.item,f=[],n;a&&!Array.isArray(a)&&(a=[a]);for(var h=0;h<a.length;h++){var e=a[h];if(e instanceof m){var p=e.basisObjectId;c[p]&&(d&&e.removeHandler(d,this),delete c[p],f.push(e))}}f.length&&
this.emit_itemsChanged(n={deleted:f});return n},set:function(a){if(!this.itemCount)return this.add(a);if(!a||!a.length)return this.clear();for(var c=this.members_,d=this.listen.item,f={},n=[],h=[],e,p,Y,U=0;U<a.length;U++)e=a[U],e instanceof m&&(p=e.basisObjectId,f[p]=e,c[p]||(c[p]=e,d&&e.addHandler(d,this),h.push(e)));for(p in c)f[p]||(e=c[p],d&&e.removeHandler(d,this),delete c[p],n.push(e));(Y=V(h,n))&&this.emit_itemsChanged(Y);return Y},sync:function(a){a=this.set(a)||{};var c=a.deleted;setAccumulateState(!0);
if(c)for(var d=0,f;f=c[d];d++)f.destroy();setAccumulateState(!1);return a.inserted},clear:function(){var a=this.getItems(),c=this.listen.item,d;if(a.length){if(c)for(d=0;d<a.length;d++)a[d].removeHandler(c,this);this.emit_itemsChanged(d={deleted:a});this.members_={}}return d}});var W=function(a,c,d,f){this.context=a;this.fn=c;this.source=d;this.handler=f};W.prototype.adapter_=null;W.prototype.proxy=function(){this.fn.call(this.context,this.source)};var X={datasetChanged:function(a){this.fn.call(this.context,
a)},destroy:function(){this.fn.call(this.context,null)}},ga={change:function(a){this.fn.call(this.context,a)},destroy:function(){this.fn.call(this.context,null)}};y.setAccumulateState=function(){function a(){var c=m;m={};for(var b in c){var d=c[b];n.call(d.dataset,d)}}function c(a){var b=this.basisObjectId,d=a.inserted,k=a.deleted,r=m[b];if(d&&k)r&&(delete m[b],n.call(r.dataset,r)),n.call(this,a);else{if(r){var w=r[d?"inserted":"deleted"];if(w){w.push.apply(w,d||k);return}n.call(r.dataset,r)}m[b]=
a;a.dataset=this}}function d(){p=null;h&&(h=0,f.emit_itemsChanged=n,a())}var f=ca.prototype,n=f.emit_itemsChanged,h=0,p,m={};return function(Y){Y?(0==h&&(f.emit_itemsChanged=c,p||(p=e.setImmediate(d))),h++):(h-=0<h,0==h&&(f.emit_itemsChanged=n,a()))}}();x.exports={STATE:s,SUBSCRIPTION:B,AbstractData:F,Value:p,Object:m,Slot:g,KeyObjectMap:z,AbstractDataset:ca,Dataset:y,DatasetWrapper:R,DatasetAdapter:W,isConnected:K,getDatasetDelta:ba,resolveDataset:L,wrapData:aa,wrapObject:q,wrap:function(a,c){var d=
c?q:aa;return Array.isArray(a)?a.map(d):d(a)}}},"1.js":function(g,x,e,y,G,v,z,$){function t(e){var g=K[e];g||(g=function(){for(var g=this,t,q;g=g.handler;){q=g.callbacks[e];if("function"==typeof q){if(!t){t=[this];for(var u=0;u<arguments.length;u++)t.push(arguments[u])}q.apply(g.context||this,t)}q=g.callbacks["*"];if("function"==typeof q){if(!t)for(t=[this],u=0;u<arguments.length;u++)t.push(arguments[u]);q.call(g.context||this,{sender:this,type:e,args:t})}}},K[e]=g);return g}g=e.Class;var u={},K=
{},N=function(){};g=g(null,{className:this.path+".Emitter",extendConstructor_:!0,handler:null,emit_destroy:t("destroy"),listen:g.nestedExtendProperty(),init:function(){this.handler&&!this.handler.callbacks&&(this.handler={callbacks:this.handler,context:this,handler:null})},addHandler:function(e,g){this.handler={callbacks:e,context:g||this,handler:this.handler}},removeHandler:function(e,g){var t=this,v;for(g=g||this;v=t,t=t.handler;)if(t.callbacks===e&&t.context===g){t.callbacks=u;v.handler=t.handler;
break}},destroy:function(){this.destroy=N;this.emit_destroy();this.handler=null}});x.exports={create:t,createHandler:function(e,g){var t={events:[]};if(e){e=String(e).trim().split(/\s+|\s*,\s*/).sort();for(var t={events:e},u=0,q;q=e[u];u++)"destroy"!=q&&(t[q]=g)}return t},events:K,Emitter:g}},"2.js":function(g,x,e,y,G,v,z,$){function t(a){m[a]=m[a]||0;return a+m[a]++}function u(a,c){var b=R[a];if(b){for(var k=0,r;r=b[k];k++)r[0][r[1]]=c;delete R[a]}Z[a]=c}function K(a,c,b){if(Z[a])return Z[a];var k=
R[a];k||(k=R[a]=[]);k.push([c,b]);return ca}function N(){var a=s(arguments),c=a.pop(),b=a[0],k=a[1],r=a[2],w;if("function"!=typeof c)throw 145;switch(a.length){case 0:w=function(){return c()};break;case 1:w=function(a,k,r){return b in a?c(k[b]):r};break;case 2:w=function(a,r,w){return b in a||k in a?c(r[b],r[k]):w};break;case 3:w=function(a,w,d){return b in a||k in a||r in a?c(w[b],w[k],w[r]):d};break;default:w=function(k,r,b){for(var w=!1,d=[],f=0,M;M=a[f];f++)w=w||M in k,d.push(r[M]);return w?c.apply(null,
d):b}}w.args=a;return w.calc=w}function V(){return N.apply(null,s(arguments).concat(function(){for(var a=[],c=arguments.length;0<c--;){if(null==arguments[c])return null;a.push(arguments[c])}return a.join("-")}))}function ba(a){var c=[],b=[],k=[],r;for(r in a)if(H.call(a,r)){var w="v"+c.length,P=a[r];k.push(w);b.push(P);c.push('"'+r+'":'+("function"==typeof P?'data&&"'+r+'" in data==false?'+w+'(data):data["'+r+'"]':w))}a=c.sort().join(",");(c=ia[a])||(c=ia[a]=new Function(k,"return function(data){return {"+
a+"};};"));return c.apply(null,b)}function L(a,c){if(!Array.isArray(a))return null;if(!Array.isArray(c)||a.length!=c.length)return a||null;for(var b=0;b<a.length;b++)if(a[b]!==c[b])return a;return c}function aa(a,c,b){if(!a.all.itemCount){a.aliases[c]=c;b="string"==typeof b||Array.isArray(b)||"function"==typeof b&&b.calc!==b?{type:b}:e.object.slice(b);if("type"in b){"string"==typeof b.type&&(b.type=K(b.type,a.fields,c));if(Array.isArray(b.type)){var k=b.type.slice();1==k.length?(b.type=e.fn.$const(k[0]),
b.defValue=k[0]):(b.type=function(a,b){return-1!=k.indexOf(a)?a:b},b.defValue=-1!=k.indexOf(b.defValue)?b.defValue:k[0])}b.type===Array&&(b.type=L);"function"!=typeof b.type&&(b.type=O)}var r=b.type||O;-1!=[f,n,p,h].indexOf(r)&&(b.id=!0);b.id&&(a.index||(a.index=new W(String)),a.idFields[c]=!0,a.idField||a.compositeKey?(a.idField=null,a.compositeKey=V.apply(null,E(a.idFields))):a.idField=c);b.calc?Q(a,c,b.calc):a.fields[c]=r;a.defaults[c]="defValue"in b?b.defValue:r();a.entityClass.prototype["get_"+
c]=function(a){return a&&this.modified&&c in this.modified?this.modified[c]:this.data[c]};a.entityClass.prototype["set_"+c]=function(a,k){return this.set(c,a,k)};ea[c]||(ea[c]={destroy:function(){this.set(c,null)}})}}function q(a,b,c){c in a.fields&&!1==b in a.aliases&&(a.aliases[b]=c)}function Q(a,b,c){if(!b||!a.fields[b]){a.calcs||(a.calcs=[]);var k=a.calcs,r=a.deps,w=c.args||[],P={args:w,wrapper:c},d=a.calcs.length,f=0;if(w)for(var n=0,ka;ka=k[n];n++)-1!=w.indexOf(ka.key)&&(f=n+1);if(b){P.key=
b;for(n=0;ka=k[n];n++)if(-1!=ka.args.indexOf(b)){d=n;break}if(f>d)return;a.idField&&b==a.idField&&(a.compositeKey=c);r[b]=w.reduce(function(a,k){for(var b=r[k]||[k],c=0;c<b.length;c++)e.array.add(a,b[c]);return a},[]);for(var h in r)c=r[h].indexOf(b),-1!=c&&Array.prototype.splice.apply(r[h],[c,1].concat(r[b]));a.fields[b]=function(a,k){return k}}else d=f;k.splice(Math.min(d,f),0,P)}}e.require("./1.js");e.require("./0.js");e.require("./3.js");var A=this.path,C=e.Class,H=Object.prototype.hasOwnProperty,
E=e.object.keys,S=e.object.extend,O=e.fn.$self,s=e.array.from,J=e.event.Emitter;g=e.event.create;var I=e.data.Object,B=e.data.Slot,D=e.data.Dataset;v=e.data.dataset.Subset;var F=e.data.dataset.Split,a={},c=[],d={string:!0,number:!0},f=function(a){return isNaN(a)?null:Number(a)},n=function(a){return isNaN(a)?null:Number(a)},p=function(a){return isNaN(a)?null:parseInt(a,10)},h=function(a){return null==a?null:String(a)},m={},Z={},R={},ca=function(){},W=e.Class(null,{className:A+".Index",items:null,fn:String,
init:function(a){this.items={};"function"==typeof a&&(this.fn=a)},calcWrapper:function(a,b){var c=this.fn(a,b);if(c!==b&&H.call(this.items,c))throw 144;return c},get:function(a,b){var c=H.call(this.items,a)&&this.items[a];if(c&&(!b||c.entityType===b))return c},add:function(a,b){var c=H.call(this.items,a)&&this.items[a];if(b&&(!c||c===b))return this.items[a]=b,!0},remove:function(a,b){if(this.items[a]===b)return delete this.items[a],!0},destroy:function(){this.items=null}});z=function(a,b){return function(c){return a.prototype[b].call(this,
c&&c.map(this.wrapper))}};y=function(a,b){return function(){this.name||(this.name=t(b));a.prototype.init.call(this)}};G=function(a){return function(a){var b=e.object.slice(this.items_),k=[];if(a){D.setAccumulateState(!0);for(var c=0;c<a.length;c++){var w=this.wrapper(a[c]);w&&(b[w.basisObjectId]=!1)}D.setAccumulateState(!1)}for(var P in this.items_)!1==P in b&&k.push(this.items_[P]);D.setAccumulateState(!0);for(P in b)b[P]&&b[P].destroy();D.setAccumulateState(!1);return k.length?k:null}};var X=C(D,
{className:A+".EntitySet",name:null,wrapper:O,init:y(D,"EntitySet"),sync:G(D),set:z(D,"set"),add:z(D,"add"),remove:z(D,"remove"),destroy:function(){D.prototype.destroy.call(this);this.wrapper=null}}),ga=C(X,{className:A+".ReadOnlyEntitySet",set:e.fn.$false,add:e.fn.$false,remove:e.fn.$false,clear:e.fn.$false});v=C(v,{className:A+".EntityCollection",name:null,init:y(v,"EntityCollection"),sync:G(v)});y=C(F,{className:A+".EntityGrouping",name:null,subsetClass:ga,init:y(F,"EntityGrouping"),sync:G(F),
getSubset:function(a,b){var c=F.prototype.getSubset.call(this,a,b);c&&c.dataset&&(c.dataset.wrapper=this.wrapper);return c}});var b=function(a,c){if(this instanceof b){a||(a=O);if(!c||Z[c])c=t("UntitledEntitySetType");var d=new da({entitySetClass:{wrapper:a}}),k=d.entitySetClass,r=function(a,k){return null!=a?(!1==k instanceof X&&(k=d.createEntitySet()),k.set(a instanceof D?a.getItems():s(a)),k):null};"string"==typeof a&&(k.prototype.wrapper=K(a,k.prototype,"wrapper"));u(c,r);S(r,{type:d,typeName:c,
toString:function(){return this.typeName+"()"},entitySetType:d,extend:function(){return k.extend.apply(k,arguments)},extendClass:function(){k.extend.apply(k,arguments);return r},reader:function(a){if(Array.isArray(a)){var b=k.prototype.wrapper;return a.map(b.reader||b)}return a},extendReader:function(a){var k=r.reader;r.reader=function(b){Array.isArray(b)&&a(b);return k(b)}}});return r}},da=C(null,{className:A+".EntitySetConstructor",entitySetClass:X,extendConstructor_:!0,createEntitySet:function(){return new this.entitySetClass}}),
l=function(a){if(this instanceof l){var b;b=a.singleton?function(a){var b=c.get();b?a&&b.update(a):b=new k(a||{});return b}:function(a,b){if(null!=a){if(a===b||a.entityType===c)return a;var P,ja=c.idField;if(d[typeof a]){if(!ja)return;if(b=c.index.get(a,c))return b;P=a;a={};a[ja]=P}else c.compositeKey?P=c.compositeKey(a,a):ja&&(P=a[ja]),null!=P&&(b=c.index.get(P,c));b&&b.entityType===c?b.update(a):b=new k(a);return b}};var c=new ha(a||{},b),k=c.entityClass;u(c.name,b);S(b,{all:c.all,type:c,typeName:c.name,
entityType:c,toString:function(){return this.typeName+"()"},reader:function(a){return c.reader(a)},addField:function(a,k){c.addField(a,k)},addCalcField:function(a,k){c.addCalcField(a,k)},get:function(a){return c.get(a)},getSlot:function(a,k){return c.getSlot(a,k)},extend:function(){return k.extend.apply(k,arguments)},extendClass:function(){return k.extend.apply(k,arguments)},extendReader:function(a){var k=b.reader;b.reader=function(b){b&&"object"==typeof b&&a(b);return k(b)}}});return b}},ea={},ia=
{},ha=C(null,{className:A+".EntityType",wrapper:null,all:null,fields:null,idFields:null,defaults:null,aliases:null,slots:null,singleton:!1,index:null,entityClass:null,init:function(a,b){this.name=a.name;if(!this.name||Z[this.name])this.name=t("UntitledEntityType");this.fields={};this.deps={};this.idFields={};this.defaults={};this.aliases={};this.slots={};var d=a.index;d&&d instanceof W&&(this.index=d);this.wrapper=b;this.all=new ga(e.object.complete({wrapper:b},a.all));if(this.singleton=!!a.singleton){var k;
this.get=function(){return k};this.all.addHandler({itemsChanged:function(a,b){k=b.inserted?b.inserted[0]:null}},this)}this.entityClass=T(this,this.all,this.fields,this.slots);this.entityClass.extend({entityType:this,type:b,typeName:this.name,state:a.state||this.entityClass.prototype.state});for(var r in a.fields)aa(this,r,a.fields[r]);for(r in a.aliases)q(this,r,a.aliases[r]);a.constrains&&a.constrains.forEach(function(a){Q(this,null,a)},this);this.entityClass.prototype.getDefaults=ba(this.defaults);
d={};for(r in this.defaults)d[r]=void 0;this.entityClass.prototype.initDelta=d;c.push(this)},reader:function(a){var b={};if(d[typeof a])return this.idField?a:null;if(!a||null==a)return null;for(var c in a){var k=this.aliases[c];if(k){var r=this.fields[k].reader;b[k]=r?r(a[c]):a[c]}}return b},get:function(a){a=this.getId(a);if(null!=a)return this.index.get(a,this)},getId:function(a){if((this.idField||this.compositeKey)&&null!=a){if(d[typeof a])return a;if(a&&a.entityType===this)return a.__id__;a instanceof
I&&(a=a.data);return this.compositeKey?this.compositeKey(a,a):a[this.idField]}},getSlot:function(a){var b=this.getId(a);if(null!=b){var c=H.call(this.slots,b)&&this.slots[b];c||(d[typeof a]&&(c={},this.idField&&!this.compositeKey&&(c[this.idField]=a),a=c),c=this.slots[b]=new B({delegate:this.get(b)||null,data:a}));return c}}}),fa=C(I,{className:A+".BaseEntity",target:!0,setDelegate:function(){},modified:null,emit_rollbackUpdate:g("rollbackUpdate")}),T=function(b,c,d,k){function r(a,k,c){var r=b.calcs,
d=a.data,f=!1,n=a.__id__,e;try{if(r)for(var h=0,l;l=r[h];h++){var p=l.key,m=d[p],g=l.wrapper(k,d,m);p&&g!==m&&(d[p]=g,k[p]=m,f=!0)}e=b.compositeKey?b.compositeKey(k,d,n):b.idField&&b.idField in k?d[b.idField]:n;e!==n&&b.index.calcWrapper(e,n)}catch(t){f=!1;e=n;for(p in k)a.data[p]=k[p];if(c&&!a.modified)for(p in c){a.modified=c;break}}e!==n&&(a.__id__=e,w(a,n,e));return f}function w(a,c,r){var d=b.index;null!=c&&(d.remove(c,a),H.call(k,c)&&k[c].setDelegate());null!=r&&(d.add(r,a),H.call(k,r)&&k[r].setDelegate(a))}
return C(fa,{className:A+".Entity",extendConstructor_:!1,init:function(a){this.delegate=null;this.data=this.getDefaults(a);fa.prototype.init.call(this);this.fieldHandlers_={};var b,k;for(k in d)b=this.data[k],k in a&&(b=d[k](a[k],b),this.data[k]=b),b&&b!==this&&b instanceof J&&b.addHandler(ea[k],this)&&(this.fieldHandlers_[k]=!0);r(this,this.initDelta);c.emit_itemsChanged({inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},getId:function(){return this.__id__},
get:function(a,b){return b&&this.modified&&a in this.modified?this.modified[a]:this.data[a]},set:function(a,k,c,w){var f=d[a];if(!f)return!1;var n,e=this.modified;f===L&&e&&a in e&&(k=L(k,e[a]));k=f(k,this.data[a]);f=this.data[a];if(k===f||k&&f&&k.constructor===Date&&f.constructor===Date&&+k===+f)!c&&e&&a in e&&(n={rollback:{key:a,value:e[a]}},delete e[a],E(e).length||(this.modified=null));else a:{n={};if(!b.idFields[a])if(c)e||(this.modified=e={}),!1===a in e?(n.rollback={key:a,value:void 0},e[a]=
f):e[a]===k&&(n.rollback={key:a,value:k},delete e[a],E(e).length||(this.modified=null));else if(e&&a in e)if(e[a]!==k){n.rollback={key:a,value:e[a]};e[a]=k;break a}else return!1;this.data[a]=k;this.fieldHandlers_[a]&&(f.removeHandler(ea[a],this),this.fieldHandlers_[a]=!1);k&&k!==this&&k instanceof J&&k.addHandler(ea[a],this)&&(this.fieldHandlers_[a]=!0);n.key=a;n.value=f;n.delta={};n.delta[a]=f}if(!w&&n){a=n.key;c=n.delta||{};var h;n.rollback&&(h={},h[n.rollback.key]=n.rollback.value);r(this,c,h)&&
(a=!0);a&&(this.emit_update(c),n.delta=c);h&&this.emit_rollbackUpdate(h)}return n||!1},update:function(a,k){var b=!1,c={};if(a){var d,w={},f,n;for(n in a)if(f=this.set(n,a[n],k,!0))f.key&&(b=!0,c[f.key]=f.value),f.rollback&&(d=!0,w[f.rollback.key]=f.rollback.value);r(this,c,w)&&(b=!0);b&&this.emit_update(c);d&&this.emit_rollbackUpdate(w)}return b?c:!1},getDefaults:function(){return{}},reset:function(){this.update(this.getDefaults(this.data))},clear:function(){var a={},k;for(k in this.data)a[k]=void 0;
return this.update(a)},commit:function(a){var k=this.modified;this.modified=null;a&&this.update(a);k&&this.emit_rollbackUpdate(k)},rollback:function(a){var k=this.modified;k&&a&&(Array.isArray(a)||(a=[a]),k=e.object.slice(k,a.reduce(function(a,k){return a.concat(b.deps[k]||k)},[])));this.update(k,!0)},destroy:function(){for(var k in this.fieldHandlers_)this.fieldHandlers_[k]&&this.data[k].removeHandler(ea[k],this);this.fieldHandlers_=a;null!=this.__id__&&w(this,this.__id__,null);I.prototype.destroy.call(this);
c.emit_itemsChanged({deleted:[this]});this.data=a;this.modified=null}})};x.exports={isEntity:function(a){return a&&a instanceof fa},createType:function(a,b){var c=a||{};"string"==typeof a?c={name:c,fields:b||{}}:b&&(c=e.object.merge(c,{fields:b}));return new l(c)},createSetType:function(a,c){return 1<arguments.length?new b(c,a):new b(a)},validate:function(){for(var a in R)e.dev.warn(A+": type `"+a+"` is not defined, but used by "+R[a].length+" type(s)")},getTypeByName:function(a){return Z[a]},get:function(a,
b){var c=Z[a];if(c)return c.get(b)},NumericId:f,NumberId:n,IntId:p,StringId:h,Index:W,CalculateField:N,calc:N,EntityType:l,Entity:T,BaseEntity:fa,EntitySetType:b,EntitySet:X,ReadOnlyEntitySet:ga,Collection:v,Grouping:y}},"3.js":function(g,x,e,y,G,v,z,$){function t(a,c){var d={},f;a&&a.length&&(f=d.inserted=a);c&&c.length&&(f=d.deleted=c);if(f)return d}function u(a,c){return function f(c){if(!c)return null;if(c.__extend__)return c;"string"==typeof c||Array.isArray(c)||(c="object"==typeof c?e.object.keys(c):
null);return ba(e.event.createHandler(c,a),{__extend__:f})}(c)}function K(a,c,d,f){return new O(ba({keyGetter:c,itemClass:d,create:function(a,c){var d=O.prototype.create.call(this,a,c);d.setDataset(new f({ruleValue:a}));return d}},a))}function N(a,c){if(!a.length)return 0;var d=c.value,f=c.object.basisObjectId,e,p,h,m,g=0,t=a.length-1;do if(h=g+t>>1,m=a[h],e=m.value,d<e)t=h-1;else if(d>e)g=h+1;else if(p=m.object.basisObjectId,f<p)t=h-1;else if(f>p)g=h+1;else return h;while(g<=t);return h+(e==d?p<
f:e<d)}function V(a,c){return+(a.value>c.value)||-(a.value<c.value)||a.object.basisObjectId-c.object.basisObjectId}e.require("./1.js");e.require("./0.js");v=this.path;z=e.Class;var ba=e.object.extend,L=e.object.values,aa=e.getter,q=e.fn.$self,Q=e.fn.$true,A=e.fn.$false,C=e.array.from,H=e.event.create,E=e.data.SUBSCRIPTION,S=e.data.Object,O=e.data.KeyObjectMap,s=e.data.AbstractDataset,J=e.data.Dataset;$=e.data.DatasetWrapper;E.add("SOURCE",{sourceChanged:function(a,c){c&&E.unlink("source",a,c);a.source&&
E.link("source",a,a.source)},sourcesChanged:function(a,c){var d;if(d=c.inserted)for(var f=0;d[f];f++)E.link("source",a,d[f]);if(d=c.deleted)for(f=0;d[f];f++)E.unlink("source",a,d[f])}},function(a,c){for(var d=c.sources||(c.source?[c.source]:[]),f=0,e;e=d[f++];)a("source",c,e)});E.addProperty("minuend");E.addProperty("subtrahend");var I=z(s,{className:v+".Merge",subscribeTo:E.SOURCE,emit_sourcesChanged:H("sourcesChanged","delta"),sources:null,rule:function(a,c){return 0<a},listen:{source:{itemsChanged:function(a,
c){var d=this.members_,f={},e,p;if(c.inserted)for(var h=0;e=c.inserted[h];h++)p=e.basisObjectId,d[p]?d[p].count++:d[p]={count:1,object:e},f[p]=d[p];if(c.deleted)for(h=0;e=c.deleted[h];h++)p=e.basisObjectId,f[p]=d[p],d[p].count--;this.applyRule(f)},destroy:function(a){this.removeSource(a)}}},init:function(){s.prototype.init.call(this);var a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){"function"!=typeof a&&(a=I.UNION);this.rule!==a&&(this.rule=a,this.applyRule())},
applyRule:function(a){var c=this.members_,d=this.rule,f=this.sources.length,e=[],p=[],h,m;a||(a=c);for(var g in a)a=c[g],h=f&&a.count&&d(a.count,f),h!=!!this.items_[g]&&(h?e:p).push(a.object),0==a.count&&delete c[g];(m=t(e,p))&&this.emit_itemsChanged(m);return m},addSource:function(a){if(a instanceof s&&e.array.add(this.sources,a)){this.listen.source&&a.addHandler(this.listen.source,this);var c=this.members_,d;for(d in a.items_)c[d]?c[d].count++:c[d]={count:1,object:a.items_[d]};this.applyRule();
this.emit_sourcesChanged({inserted:[a]});return!0}},removeSource:function(a){if(e.array.remove(this.sources,a)){this.listen.source&&a.removeHandler(this.listen.source,this);var c=this.members_,d;for(d in a.items_)c[d].count--;this.applyRule();this.emit_sourcesChanged({deleted:[a]});return!0}},setSources:function(a){for(var c=C(this.sources),d=0,f;f=a[d];d++)f instanceof s&&(e.array.remove(c,f)||this.addSource(f));c.forEach(this.removeSource,this)},clear:function(){C(this.sources).forEach(this.removeSource,
this)},destroy:function(){s.prototype.destroy.call(this);this.sources=null}});I.UNION=I.prototype.rule;I.INTERSECTION=function(a,c){return a==c};I.DIFFERENCE=function(a,c){return 1==a};I.MORE_THAN_ONE_INCLUDE=function(a,c){return 1==c||1<a};I.AT_LEAST_ONE_EXCLUDE=function(a,c){return 1==c||a<c};var B=function(a){return!this.has(a)};g=z(s,{className:v+".Subtract",subscribeTo:E.MINUEND+E.SUBTRAHEND,minuend:null,emit_minuendChanged:H("minuendChanged","oldMinuend"),subtrahend:null,emit_subtrahendChanged:H("subtrahendChanged",
"oldSubtrahend"),listen:{minuend:{itemsChanged:function(a,c){if(this.subtrahend){var d=t(c.inserted&&c.inserted.filter(B,this.subtrahend),c.deleted&&c.deleted.filter(this.has,this));d&&this.emit_itemsChanged(d)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{itemsChanged:function(a,c){if(this.minuend){var d=t(c.deleted&&c.deleted.filter(B,this),c.inserted&&c.inserted.filter(this.has,this));d&&this.emit_itemsChanged(d)}},destroy:function(){this.setOperands(this.minuend,null)}}},
init:function(){s.prototype.init.call(this);var a=this.minuend,c=this.subtrahend;this.subtrahend=this.minuend=null;(a||c)&&this.setOperands(a,c)},setOperands:function(a,c){var d,f=!1;!1==a instanceof s&&(a=null);!1==c instanceof s&&(c=null);var e=this.minuend,p=this.subtrahend;if(e!==a){f=!0;this.minuend=a;var h=this.listen.minuend;h&&(e&&e.removeHandler(h,this),a&&a.addHandler(h,this));this.emit_minuendChanged(e)}if(p!==c){f=!0;this.subtrahend=c;if(h=this.listen.subtrahend)p&&p.removeHandler(h,this),
c&&c.addHandler(h,this);this.emit_subtrahendChanged(p)}if(!f)return!1;if(a&&c){var f=[],e=[],m;for(m in this.items_)a.items_[m]&&!c.items_[m]||f.push(this.items_[m]);for(m in a.items_)this.items_[m]||c.items_[m]||e.push(a.items_[m]);(d=t(e,f))&&this.emit_itemsChanged(d)}else this.itemCount&&this.emit_itemsChanged(d={deleted:this.getItems()});return d},setMinuend:function(a){return this.setOperands(a,this.subtrahend)},setSubtrahend:function(a){return this.setOperands(this.minuend,a)},clear:function(){this.setOperands()}});
var D=z(s,{className:v+".SourceDataset",subscribeTo:E.SOURCE,source:null,emit_sourceChanged:H("sourceChanged","oldSource"),sourceAdapter_:null,sourceMap_:null,listen:{source:{destroy:function(){this.sourceAdapter_||this.setSource()}}},init:function(){this.sourceMap_={};s.prototype.init.call(this);var a=this.source;a&&(this.source=null,this.setSource(a))},setSource:function(a){a=e.data.resolveDataset(this,this.setSource,a,"sourceAdapter_");if(this.source!==a){var c=this.source,d=this.listen.source;
this.source=a;if(d){var f=d.itemsChanged;c&&(c.removeHandler(d,this),f&&f.call(this,c,{deleted:c.getItems()}));a&&(a.addHandler(d,this),f&&f.call(this,a,{inserted:a.getItems()}))}this.emit_sourceChanged(c)}},clear:function(){this.setSource()},destroy:function(){s.prototype.destroy.call(this);this.sourceMap_=null}}),F=z(D,{className:v+".MapFilter",map:q,filter:A,rule:aa(Q),ruleEvents:u(function(a){var c=this.map?this.map(a):object;if(!1==c instanceof S||this.filter(c))c=null;var d=this.sourceMap_[a.basisObjectId],
f=d.member;if(f!==c){var e=this.members_,p,h,m;d.member=c;f&&(d=f.basisObjectId,this.removeMemberRef&&this.removeMemberRef(f,a),0==--e[d]&&(delete e[d],m=[f]));c&&(f=c.basisObjectId,this.addMemberRef&&this.addMemberRef(c,a),e[f]?e[f]++:(e[f]=1,h=[c]));(p=t(h,m))&&this.emit_itemsChanged(p)}},"update"),addMemberRef:null,removeMemberRef:null,listen:{source:{itemsChanged:function(a,c){var d=this.sourceMap_,f=this.members_,e=[],p=[],h,m,g,s=this.ruleEvents;J.setAccumulateState(!0);if(c.inserted)for(var u=
0;h=c.inserted[u];u++){g=this.map?this.map(h):h;if(!1==g instanceof S||this.filter(g))g=null;s&&h.addHandler(s,this);d[h.basisObjectId]={sourceObject:h,member:g};g&&(m=g.basisObjectId,f[m]?f[m]++:(f[m]=1,e.push(g)),this.addMemberRef&&this.addMemberRef(g,h))}if(c.deleted)for(u=0;h=c.deleted[u];u++)m=h.basisObjectId,g=d[m].member,s&&h.removeHandler(s,this),delete d[m],g&&(m=g.basisObjectId,0==--f[m]&&(delete f[m],p.push(g)),this.removeMemberRef&&this.removeMemberRef(g,h));J.setAccumulateState(!1);(c=
t(e,p))&&this.emit_itemsChanged(c)}}},setMap:function(a){"function"!=typeof a&&(a=q);if(this.map!==a)return this.map=a,this.applyRule()},setFilter:function(a){"function"!=typeof a&&(a=A);if(this.filter!==a)return this.filter=a,this.applyRule()},setRule:function(a){"function"!=typeof a&&(a=Q);if(this.rule!==a)return this.rule=a,this.applyRule()},applyRule:function(){var a=this.sourceMap_,c=this.members_,d,f,e,p,h,g=[],s=[],u,q;for(q in a){h=a[q];p=h.sourceObject;d=h.member;f=this.map?this.map(p):p;
if(!1==f instanceof S||this.filter(f))f=null;d!=f&&(h.member=f,d&&(e=d.basisObjectId,this.removeMemberRef&&this.removeMemberRef(d,p),c[e]--),f&&(d=f.basisObjectId,this.addMemberRef&&this.addMemberRef(f,p),d in c?c[d]++:(c[d]=1,g.push(f))))}for(e in this.items_)0==c[e]&&(delete c[e],s.push(this.items_[e]));(u=t(g,s))&&this.emit_itemsChanged(u);return u}});y=z(F,{className:v+".Subset",filter:function(a){return!this.rule(a)}});G=z(F,{className:v+".Split",subsetClass:s,subsetWrapperClass:$,keyMap:null,
map:function(a){return this.keyMap.resolve(a)},setRule:function(a){"function"!=typeof a&&(a=Q);if(this.rule!==a)return this.rule=a,this.keyMap.keyGetter=a,this.applyRule()},addMemberRef:function(a,c){a.dataset.emit_itemsChanged({inserted:[c]})},removeMemberRef:function(a,c){a.dataset.emit_itemsChanged({deleted:[c]})},init:function(){this.keyMap&&!1!=this.keyMap instanceof O||(this.keyMap=K(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));F.prototype.init.call(this)},getSubset:function(a,
c){return this.keyMap.get(a,c)},destroy:function(){F.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});H=z(D,{className:v+".Slice",rule:aa(Q),ruleEvents:u(function(a){var c=this.sourceMap_[a.basisObjectId];a=this.rule(a);var d=this.index_;if(a!==c.value){var f=N(d,c),e=d[f-1],g=d[f+1];c.value=a;if(e&&(e.value>a||e.value==a&&e.object.basisObjectId>c.object.basisObjectId)||g&&(g.value<a||g.value==a&&g.object.basisObjectId<c.object.basisObjectId))d.splice(f,1),d.splice(N(d,c),0,
c),this.applyRule()}},"update"),index_:null,orderDesc:!1,offset:0,limit:10,listen:{source:{itemsChanged:function(a,c){var d=this.sourceMap_,f=this.index_,e=this.ruleEvents,g=!1,h=!1,m,t=c.inserted,u=c.deleted;if(u){u.length>f.length-u.length&&(g=!0,h=u.length!=f.length,f.length=0);for(var s=0,q;q=u[s];s++)g||(m=d[q.basisObjectId],f.splice(N(f,m),1)),delete d[q.basisObjectId],e&&q.removeHandler(e,this);if(h)for(var v in d)m=d[v],f.splice(N(f,m),0,m)}if(t){h=!f.length;for(s=0;q=t[s];s++)m={object:q,
value:this.rule(q)},d[q.basisObjectId]=m,h?f.push(m):f.splice(N(f,m),0,m),e&&q.addHandler(e,this);h&&f.sort(V)}this.applyRule()}}},emit_rangeChanged:H("rangeChanged","oldOffset","oldLimit"),init:function(){this.index_=[];D.prototype.init.call(this)},setRange:function(a,c){var d=this.offset,f=this.limit,e=!1;if(d!=a||f!=c)this.offset=a,this.limit=c,e=this.applyRule(),this.emit_rangeChanged(d,f);return e},setOffset:function(a){return this.setRange(a,this.limit)},setLimit:function(a){return this.setRange(this.offset,
a)},setRule:function(a,c){a=aa(a);this.orderDesc=!!c;if(this.rule!=a){for(var d=this.index_,f=0;f<d.length;f++)d[f].value=a(d[f].object);this.rule=a;d.sort(V)}return this.applyRule()},applyRule:function(){var a=this.offset,c=a+this.limit;this.orderDesc&&(a=this.index_.length-c,c=a+this.limit);for(var d=e.object.slice(this.members_),a=this.index_.slice(Math.max(0,a),Math.max(0,c)),c=[],f,g=0,p;p=a[g];g++){var h=p.object.basisObjectId;d[h]?delete d[h]:(c.push(p.object),this.members_[h]=p.object)}for(h in d)delete this.members_[h];
(f=t(c,L(d)))&&this.emit_itemsChanged(f);return f},destroy:function(){D.prototype.destroy.call(this);this.index_=null}});v=z(D,{className:v+".Cloud",subsetClass:s,subsetWrapperClass:$,rule:aa(A),ruleEvents:u(function(a){var c=this.sourceMap_,d=this.members_,f=a.basisObjectId,e=c[f].list,c=c[f].list={},f=this.rule(a),g,h=[],m=[],u;if(Array.isArray(f))for(var s=0;s<f.length;s++)(u=this.keyMap.get(f[s],!0))&&!u.has(a)&&(q=u.basisObjectId,c[q]=u,e[q]||(u.dataset.emit_itemsChanged({inserted:[a]}),d[q]?
d[q]++:(h.push(u),d[q]=1)));for(var q in e)c[q]||(u=e[q],u.dataset.emit_itemsChanged({deleted:[a]}),--d[q]||(delete d[q],m.push(u)));(g=t(h,m))&&this.emit_itemsChanged(g)},"update"),keyMap:null,map:q,listen:{source:{itemsChanged:function(a,c){var d=this.sourceMap_,f=this.members_,e=this.ruleEvents,g,h,m,u=[],s=[];J.setAccumulateState(!0);if(g=c.inserted)for(var q=0,v;v=g[q];q++){var K=this.rule(v),x={object:v,list:{}};d[v.basisObjectId]=x;if(Array.isArray(K))for(var b=0,y={};b<K.length;b++)(h=this.keyMap.get(K[b],
!0))&&!y[h.basisObjectId]&&(m=h.basisObjectId,y[m]=!0,x.list[m]=h,h.dataset.emit_itemsChanged({inserted:[v]}),f[m]?f[m]++:(u.push(h),f[m]=1));e&&v.addHandler(e,this)}if(g=c.deleted)for(q=0;v=g[q];q++){h=v.basisObjectId;K=d[h].list;delete d[h];for(m in K)h=K[m],h.dataset.emit_itemsChanged({deleted:[v]}),--f[m]||(delete f[m],s.push(h));e&&v.removeHandler(e,this)}J.setAccumulateState(!1);(c=t(u,s))&&this.emit_itemsChanged(c)}}},init:function(){this.keyMap&&!1!=this.keyMap instanceof O||(this.keyMap=
K(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));D.prototype.init.call(this)},getSubset:function(a,c){return this.keyMap.get(a,c)},destroy:function(){D.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});x.exports={createRuleEvents:u,Merge:I,Subtract:g,SourceDataset:D,MapFilter:F,Subset:y,Split:G,Slice:H,Cloud:v}},"4.js":function(g,x,e,y,G,v,z,$){function t(e){if(0<e.basisGetterId_){var g="getter(";if("string"==typeof e.base)g+='"'+e.base.replace(/"/g,'\\"')+'"';
else if(e.mod)g+=t(e.base);else return t(e.base);e.mod&&(g="string"==typeof e.mod?g+(', "'+e.mod.replace(/"/g,'\\"')+'"'):g+(", "+t(e.mod)));return g+")"}return Function.prototype.toString.call(e)}x.exports={fn:function(g){var v=Function.prototype.toString.call(g),x=v.match(/^\s*function(\s+\S+)?\s*\((\s*(?:\S+|\/\*[^*]+\*\/)(\s*(?:,\s*\S+|\/\*[^*]+\*\/))*\s*)?\)/),y=v.replace(/^\s*\(?\s*function[^(]*\([^\)]*\)[^{]*\{|\}\s*\)?\s*$/g,"");g=t(g);var z=(x&&x[2]||"").replace(/\s*,\s*/g,", ");x||e.dev.log("Function parse error: "+
v);return{source:v,name:(x&&x[1]||"anonymous").trim(),fullname:name+"("+z+")",args:z,body:y,getter:g!=v?g:!1}}}},"5.js":function(g,x,e,y,G,v,z,$){var t="undefined"!==typeof performance?performance:Date,u="webkitNow"in t?"webkitNow":"now";x.exports={time:function(e){return arguments.length?parseInt(t[u]()-e):t[u]()},test:function(e,g){for(var t=this.time(),u=0;u<e;u++)g(u);return this.time(t)}}}};(function(g){function x(a,b){for(var c in b)a[c]=b[c];return a}function e(a,b){for(var c in b)!1==c in
a&&(a[c]=b[c]);return a}function y(a){var b=[],c;for(c in a)b.push(c);return b}function G(a,b){var c={};if(!b)return x(c,a);for(var d=0,e;e=b[d++];)e in a&&(c[e]=a[e]);return c}function v(){return L(arguments).reduce(x,{})}function z(a,b,c){var d=[],e;for(e in a)d.push(b.call(c,e,a[e]));return d}function $(a){return a}function t(){}function u(a){var b=d[a.url];if(b)for(var c=0;c<b.length;c++)b[c](a.get(),a.url)}function K(a,b,c){try{return new Function(b,c)}catch(d){H.error("Compilation error at "+
a+("line"in d?":"+(d.line-1):"")+": "+d)}}function N(a){var b=a.split(".")[0],c=a.replace(/\./g,"/")+".js";!1==a in m&&(!1==b in R&&(R[b]=s.baseURI),b==a&&(Z[R[b]+c]=b),m[a]=R[b]+c);return m[a]}function V(a){a=a.split(".");var b;b=a[0];var c=h[b];c||(c=h[b]=new ca(b),c.namespaces_={},c.namespaces_[b]=c,J.noConflict||(g[b]=c));for(var c=b=c,d=1,e;e=a[d];d++){if(!c[e]){var f=a.slice(0,d+1).join(".");c[e]=new ca(f);b.namespaces_[f]=c[e]}c=c[e]}return h[a.join(".")]=c}function ba(a,b){if(J.extProto)for(var c in b)a.prototype[c]=
function(a,c){return function(){var c=[this];Array.prototype.push.apply(c,arguments);return b[a].apply(b,c)}}(c,a.name||a.toString().match(/^\s*function\s*(\w*)\s*\(/)[1])}function L(a,c){if(null!=a){var b=a.length;if("undefined"==typeof b||"[object Function]"==Q.call(a))return[a];c||(c=0);if(0<b-c){for(var d=[],e=0,f=c;f<b;)d[e++]=a[f++];return d}}return[]}function aa(a,c,b){for(var d=[],e="function"==typeof c,f=0;f<a;f++)d[f]=e?c.call(b,f,d):c;return d}var q=g.document,Q=Object.prototype.toString,
A=function(){function a(c){if(b.test(c)){var k=c.split("."),d=k[0],e=k[1],r=k[2];switch(k.length){case 1:c=function(a){return null!=a?a[d]:a};break;case 2:c=function(a){return null!=a?a[d][e]:a};break;case 3:c=function(a){return null!=a?a[d][e][r]:a};break;default:c=function(a){if(null!=a){a=a[d][e][r];for(var c=3,b;b=k[c];c++)a=a[b]}return a}}return c}return new Function("object","return object != null ? object."+c+" : object")}var c=1,b=/^[a-z$_][a-z$_0-9]*(\.[a-z$_][a-z$_0-9]*)*$/i,d=[],e={},f=
{};return function(b,w){var g,h,m;if(!b||b===C)return C;"function"==typeof b?(m=b.basisGetterId_)?g=d[Math.abs(m)-1]:(g=function(a){return b(a)},g.base=b,g.__extend__=A,m=d.push(g),b.basisGetterId_=-m,g.basisGetterId_=m):(g=e[b])?m=g.basisGetterId_:(g=a(b),g.base=b,g.__extend__=A,m=d.push(g),g.basisGetterId_=m,e[b]=g);h=null!=w&&typeof w;if(!h)return g;var n=f[m],p;if("string"==h)p=h+w;else if("function"==h)p=w.basisModId_;else if("object"!=h)return g;if(p&&n&&n[p])return n[p];"function"==typeof g.base&&
(g=g.base);switch(h){case "string":h=function(a){return l.format(w,g(a))};break;case "function":p||(p=h+c++,w.basisModId_=p);h=function(a){return w(g(a))};break;default:h=function(a){return w[g(a)]}}h.base=g.base||g;h.__extend__=A;p&&(n||(n={},f[m]=n),n[p]=h,h.mod=w,h.basisGetterId_=d.push(h));return h}}(),C=x(function(){},{__extend__:A}),H=function(){var a={log:t,info:t,warn:t,error:t};"undefined"!=typeof console&&z(a,function(c){a[c]="bind"in Function.prototype&&"function"==typeof console[c]?Function.prototype.bind.call(console[c],
console):function(){Function.prototype.apply.call(console[c],console,arguments)}});return a}(),E=g.setImmediate||g.msSetImmediate,S=g.clearImmediate||g.msSetImmediate;E&&(E=E.bind(g));S&&(S=S.bind(g));E||function(){var a=function(){var a={},c=1;E=function(){a[++c]={fn:arguments[0],args:L(arguments,1)};b(c);return c};S=function(c){delete a[c]};return function(c){var b=a[c];if(b)try{"function"==typeof b.fn?b.fn.apply(void 0,b.args):(g.execScript||function(a){g.eval.call(g,a)})(String(b.fn))}finally{delete a[c]}}}(),
c=function(c){setTimeout(function(){a(c)},0)},b=c;if(g.process&&"function"==typeof process.nextTick)b=function(c){process.nextTick(function(){a(c)})};else if(g.MessageChannel)b=function(c){var b=new g.MessageChannel;b.port1.onmessage=function(){a(c)};b.port2.postMessage("")};else{var d=g.postMessage&&!g.importScripts;if(d){var e=g.onmessage;g.onmessage=function(){d=!1};g.postMessage("","*");g.onmessage=e}d?(e=function(c){c&&c.source==g&&(c=String(c.data).split("basisjs.setImmediate")[1])&&a(c)},g.addEventListener?
g.addEventListener("message",e,!0):g.attachEvent("onmessage",e),b=function(a){g.postMessage("basisjs.setImmediate"+a,"*")}):q&&"onreadystatechange"in q.createElement("script")&&(b=function na(d){"undefined"!=typeof T&&(b=c,T.head.ready(function(){b=function(c){var b=q.createElement("script");b.onreadystatechange=function(){a(c);b.onreadystatechange=null;T.remove(b);b=null};T.head.add(b)}}));b===na?c(d):b(d)})}}();var O="object"==typeof process&&"[object process]"==Q.call(process),s=function(){var a=
/^([^\/]+:|\/)/,c=/^[a-zA-Z0-9\-]+:\/?/,b=/^(?:[a-zA-Z0-9\-]+:)?\/\/[^\/]+\/?/,d=/[\?#].*$/,e={},f="",g;O?(f=require("path").resolve(".").replace(/\\/g,"/"),g=f.replace(/^[^\/]*/,""),f=f.replace(/\/.*/,"")):(g=location.pathname.replace(/[^\/]+$/,""),f=location.protocol+"//"+location.host);return e={baseURI:g,origin:f,normalize:function(a){a=(a||"").replace(c,"/").replace(b,"/").replace(d,"");for(var k=[],e=a.split("/"),f=0;f<e.length;f++)".."==e[f]?(1<k.length||k[0])&&k.pop():!e[f]&&f||"."==e[f]||
k.push(e[f]);return k.join("/")||("/"===a[0]?"/":"")},dirname:function(a){a=e.normalize(a);return a.replace(/\/([^\/]*)$|^[^\/]+$/,"")||("/"==a[0]?"/":".")},extname:function(a){return(a=e.normalize(a).match(/[^\/](\.[^\/\.]*)$/))?a[1]:""},basename:function(a,c){var b=e.normalize(a).match(/[^\\\/]*$/),b=b?b[0]:"";c==e.extname(b)&&(b=b.substring(0,b.length-c.length));return b},resolve:function(c,b){for(var d=L(arguments).reverse(),f=[],r=!1,w=0;!r&&w<d.length;w++)"string"==typeof d[w]&&(f.unshift(d[w]),
r=a.test(d[w]));r||f.unshift("/"==g?"":g);return e.normalize(f.join("/"))},relative:function(a,c){"string"!=typeof c&&(c=a,a=g);a=e.normalize(a);c=e.normalize(c);if("/"==a[0]&&"/"!=c[0])return a;if("/"==c[0]&&"/"!=a[0])return c;for(var b=a.replace(/^\/$/,"").split(/\//),k=c.replace(/^\/$/,"").split(/\//),d=[],f=0;k[f]==b[f]&&"string"==typeof b[f];)f++;for(b=b.length-f;0<b;b--)d.push("..");return d.concat(k.slice(f).filter(Boolean)).join("/")}}}(),J={path:{basis:""}},I=function(){function a(c){return"function"==
typeof c&&!!c.basisClassId_}function c(a){for(var b=this;b&&b!==a;)b=b.superClass_;return b===a}function b(h,m){var n=f++;"function"!=typeof h&&(h=l);var p=function(){};p.prototype=h.prototype;for(var p=new p,n={basisClassId_:n,superClass_:h,extendConstructor_:!!h.extendConstructor_,isSubclassOf:c,subclass:function(){return b.apply(null,[q].concat(L(arguments)))},extend:d,__extend__:function(c){return c&&c!==g&&("object"==typeof c||"function"==typeof c&&!a(c))?l.create.call(null,q,c):c},prototype:p},
s=1,t;t=arguments[s];s++)n.extend(t);var q=n.extendConstructor_?function(a){this.basisObjectId=e.id++;var c,b;for(b in a)c=this[b],this[b]=c&&c.__extend__?c.__extend__(a[b]):a[b];this.init();this.postInit()}:function(){this.basisObjectId=e.id++;this.init.apply(this,arguments);this.postInit()};p.constructor=q;for(var u in p)p[u]===g&&(p[u]=q);x(q,n);return q}function d(c){var b=this.prototype;"function"!=typeof c||a(c)||(c=c(this.superClass_.prototype));c.prototype&&(c=c.prototype);for(var e in c){var f=
c[e],r=b[e];"className"==e||"extendConstructor_"==e?this[e]=f:b[e]=r&&r.__extend__?r.__extend__(f):f}h&&c[e="toString"]!==Q&&(b[e]=c[e]);return this}var e={id:1},f=1,g={},h=function(){for(var a in{toString:1})return!1;return!0}(),l=x(b,{className:"basis.Class",extendConstructor_:!1,prototype:{basisObjectId:0,constructor:null,init:function(){},postInit:function(){},destroy:function(){for(var a in this)hasOwnProperty.call(this,a)&&(this[a]=null);this.destroy=t}}}),m=function(a,c,b){return{__extend__:function(a){if(!a||
a&&a.__extend__)return a;var b=function(){};b.prototype=this;b=new b;c(b,a);return b}}.__extend__(a||{})},n=function(a){return m(a,x,"extensibleProperty")};return x(l,{SELF:g,create:b,isClass:a,customExtendProperty:m,extensibleProperty:n,nestedExtendProperty:function(a){return m(a,function(a,c){for(var b in c){var k=a[b];a[b]=k&&k.__extend__?k.__extend__(c[b]):n(c[b])}},"nestedExtendProperty")},oneFunctionProperty:function(a,c){var b=function(c){var k={__extend__:b};if(c){if(c.__extend__)return c;
for(var d in c)c[d]&&(k[d]=a)}return k};return b(c||{})}})}(),B=I(null,{className:"basis.Token",value:null,handler:null,deferredToken:null,bindingBridge:{attach:function(a,c,b){a.attach(c,b)},detach:function(a,c,b){a.detach(c,b)},get:function(a){return a.get()}},init:function(a){this.value=a},get:function(){return this.value},set:function(a){this.value!==a&&(this.value=a,this.apply())},attach:function(a,c){this.handler={fn:a,context:c,handler:this.handler}},detach:function(a,c){for(var b=this,d;d=
b,b=b.handler;)if(b.fn===a&&b.context===c){b.fn=t;d.handler=b.handler;break}},apply:function(){for(var a=this.get(),c=this;c=c.handler;)c.fn.call(c.context,a)},deferred:function(){var a=this.deferredToken;a||(a=this.deferredToken=new M.DeferredToken(this.value),this.attach(a.set,a));return a},destroy:function(){this.deferredToken&&(this.deferredToken.destroy(),this.deferredToken=null);this.value=this.handler=null;this.detach=this.attach=t}}),D=function(){function a(){var k=c;c={};b=null;for(var d in k)k[d].apply()}
var c={},b;return function(d){d.basisObjectId in c||(c[d.basisObjectId]=d,b||E(a))}}(),F=B.subclass({className:"basis.DeferredToken",set:function(a){this.value!==a&&(this.value=a,D(this))},deferred:function(){return this}}),a={},c={},d={};(function(){var a="undefined"!=typeof la?la:null;if(a){for(var b in a)c[s.resolve(b)]=a[b];la=null}})();var f=function(a,b){if(b||!c.hasOwnProperty(a)){var d="";if(O)try{d=require("fs").readFileSync(a,"utf-8")}catch(e){}else{var f=new XMLHttpRequest;f.open("GET",
a,!1);f.setRequestHeader("If-Modified-Since",(new Date(0)).toGMTString());f.setRequestHeader("X-Basis-Resource",1);f.send("");200<=f.status&&400>f.status&&(d=f.responseText)}c[a]=d}return c[a]},n=function(b){b=s.resolve(b);if(!a[b]){var d=n.extensions[s.extname(b)],e=!1,g=!1,h,l=function(){if(e)return h;var a=f(b);d?g||(g=!0,h=d(a,b)):h=a;e=!0;u(l);l.apply();return h};x(l,x(new B,{url:b,fetch:function(){return l()},toString:function(){return"[basis.resource "+b+"]"},isResolved:function(){return e},
update:function(a){a=String(a);e&&a==c[b]||(c[b]=a,d?g&&!d.permanent&&(h=d(a,b),u(l),l.apply()):(h=a,e=!0,u(l),l.apply()))},reload:function(){var a=c[b],d=f(b,!0);d!=a&&(e=!1,l.update(d))},get:function(a){return a?f(b):l()},ready:function(a,b){if(e&&(a.call(b,l()),d&&d.permanent))return;l.attach(a,b);return l}}));a[b]=l}return a[b]};x(n,{isResource:function(b){return b?a[b.url]===b:!1},isResolved:function(a){return(a=n.get(a))?a.isResolved():!1},exists:function(b){return a.hasOwnProperty(s.resolve(b))},
get:function(a){a=s.resolve(a);return n.exists(a)?n(a):null},getFiles:function(b){return y(b?c:a).map(s.relative)},extensions:{".js":x(function(a,b){var c=Z[b];if(!c){var d=!0,c=s.dirname(b)+"/"+s.basename(b,s.extname(b)),f;for(f in J.path){var g=J.path[f]+f+"/";if(b.substr(0,g.length)==g){d=!1;c=c.substr(J.path[f].length);break}}c=c.replace(/\./g,"_").replace(/^\//g,"").replace(/\//g,".");d&&(c="implicit."+c)}h[c]||(f=V(c),f.exports=p({path:f.path,exports:f.exports},b,a).exports,f.exports&&f.exports.constructor===
Object&&e(f,f.exports));return h[c].exports},{permanent:!0}),".css":function(a,b){var c=U.resources[b];c?c.updateCssText(a):c=new U(b);return c},".json":function(a,b){if("object"==typeof a)return a;var c;try{a=String(a),c=M.json.parse(a)}catch(d){}return c||null}}});var p=function(a,b,c){var d=s.dirname(b)+"/",e=c;a.exports||(a.exports={});"function"!=typeof e&&(e=K(b,"exports module basis global __filename __dirname resource require".split(" "),'"use strict";\n'+c));"function"==typeof e&&e.call(a.exports,
a.exports,a,M,g,b,d,function(a){return n(d+a)},function(a,b){return W(a,b||d)});return a},h={},m={},Z={},R=G(J.path);(function(a){if(a="undefined"!=typeof ma?ma:null)for(var b in a){var c=s.resolve(b),d=a[b];Z[c]=d;m[d]=c}})();var ca=I(null,{className:"basis.Namespace",init:function(a){this.name=a;this.exports={path:this.name}},toString:function(){return"[basis.namespace "+this.path+"]"},extend:function(a){x(this.exports,a);return e(this,a)}}),W=function(){if(O){var a=module.constructor.prototype;
return function(b,c){if(/[^a-z0-9_\.]/i.test(b)&&".js"!=s.extname(b))return b=s.resolve(c,b),require(b);var d=a._compile,f=V(b);a._compile=function(a,b){this.basis=M;a='var node_require = require;\nvar basis = module.basis;\nvar resource = function(filename){ return basis.resource(__dirname + "/" + filename) };\nvar require = function(filename, baseURI){ return basis.require(filename, baseURI || __dirname) };\n'+a;d.call(x(this,f),a,b)};var g=require(__dirname+"/"+b.replace(/\./g,"/"));(f.exports=
g)&&g.constructor===Object&&e(f,g);a._compile=d;return g}}return function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==s.extname(a)?s.resolve(b,a):N(a);return n(a).fetch()}}();e(Function.prototype,{bind:function(a){var b=this,c=L(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});e(Array,{isArray:function(a){return"[object Array]"===Q.call(a)}});e(Array.prototype,{indexOf:function(a,b){b=parseInt(b,10)||0;if(0>b)return-1;for(;b<
this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){var c=this.length;b=parseInt(b,10);for(b=isNaN(b)||b>=c?c-1:(b+c)%c;0<=b;b--)if(this[b]===a)return b;return-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0},some:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1},
filter:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);return c},map:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c},reduce:function(a,b){var c=this.length,d=arguments.length;if(0==c&&1==d)throw 1;var e,f=0;1<d&&(e=b,f=1);for(d=0;d<c;d++)d in this&&(e=f++?a.call(null,e,this[d],d,this):this[d]);return e}});var X={flatten:function(a){return a.concat.apply([],a)},repeat:function(a,b){return X.flatten(aa(parseInt(b,
10)||0,a))},search:function(a,b,c,d){a.lastSearchIndex=-1;c=A(c||$);d=parseInt(d,10)||0;for(var e=a.length;d<e;d++)if(c(a[d])===b)return a[a.lastSearchIndex=d]},lastSearch:function(a,b,c,d){a.lastSearchIndex=-1;c=A(c||$);var e=a.length;d=isNaN(d)||null==d?e:parseInt(d,10);for(e=d>e?e:d;0<e--;)if(c(a[e])===b)return a[a.lastSearchIndex=e]},add:function(a,b){return-1==a.indexOf(b)&&!!a.push(b)},remove:function(a,b){var c=a.indexOf(b);return-1!=c&&!!a.splice(c,1)},has:function(a,b){return-1!=a.indexOf(b)},
sortAsObject:function(a,b,c,d){b=A(b);d=d?-1:1;return a.map(function(a,c){return{i:c,v:b(a)}}).sort(c||function(a,b){return d*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(b){return a[b.i]},a)}};ba(Array,X);if(![1,2].splice(1).length){var ga=Array.prototype.splice;Array.prototype.splice=function(){var a=L(arguments);2>a.length&&(a[1]=this.length);return ga.apply(this,a)}}var b=/([\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$])/g,da=/\{([a-z\d_]+)(?::([\.0])(\d+)|:(\?))?\}/gi;e(String,{toLowerCase:function(a){return String(a).toLowerCase()},
toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()}});e(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});var l={toObject:function(a,b){try{return(new Function("return 0,"+a))()}catch(c){if(b)throw 2;}},repeat:function(a,b){return Array(parseInt(b,
10)+1||0).join(a)},qw:function(a){return(a=a.trim())?a.split(/\s+/):[]},forRegExp:function(a){return a.replace(b,"\\$1")},format:function(a,b){var c=L(arguments,1);"object"==typeof b&&x(c,b);return a.replace(da,function(a,b,d,e,f){a=b in c?c[b]:f?"":a;return d&&!isNaN(a)?(a=Number(a),"."==d?a.toFixed(e):ha.lead(a,e)):a})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},camelize:function(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})},dasherize:function(a){return a.replace(/[A-Z]/g,
function(a){return"-"+a.toLowerCase()})}};ba(String,l);if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length){var ea=String.prototype.split;String.prototype.split=function(a,b){if(!a||!1==a instanceof RegExp||""==a.source)return ea.apply(this,arguments);var c=[],d=0,e;for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));e=a.exec(this);)e[0]=this.substring(d,e.index),c.push.apply(c,e),d=a.lastIndex;c.push(this.substr(d));return c}}if("2"!="12".substr(-1)){var ia=String.prototype.substr;
String.prototype.substr=function(a,b){return ia.call(this,0>a?Math.max(0,this.length+a):a,b)}}var ha={fit:function(a,b,c){return!isNaN(b)&&a<b?Number(b):!isNaN(c)&&a>c?Number(c):a},lead:function(a,b,c){return String(a).replace(/\d+/,function(a){return 1<(b-=a.length-1)?Array(b).join(c||0)+a:a})},group:function(a,b,c){return String(a).replace(/\d+/,function(a){return a.replace(/\d/g,function(d,e){return!e+(a.length-e)%(b||3)?d:(c||" ")+d})})},format:function(a,b,c,d,e,f){a=a.toFixed(b);if(c||f)a=a.replace(/(\d+)(\.?)/,
function(a,b,d){return(c?M.number.group(Number(b),3,c):b)+(d?f||d:"")});d&&(a=a.replace(/^-?/,"$&"+(d||"")));return a+(e||"")}};ba(Number,ha);e(Date,{now:function(){return Number(new Date)}});var fa=function(){function a(){if("complete"==q.readyState&&q.body&&!c++)for(;d;)d.callback.call(d.context),d=d.next}function b(){try{q.documentElement.doScroll("left"),a()}catch(c){setTimeout(b,1)}}var c=!q||"complete"==q.readyState&&!!q.body,d;if(!c)if(q.addEventListener)q.addEventListener("DOMContentLoaded",
a,!1),g.addEventListener("load",a,!1);else{q.attachEvent("onreadystatechange",a);g.attachEvent("onload",a);try{!g.frameElement&&q.documentElement.doScroll&&b()}catch(e){}}return function(a,b){c?a.call(b):d={callback:a,context:b,next:d}}}(),T=function(){function a(b){if(q&&!f[b]&&(f[b]=q[b]||q.getElementsByTagName(b)[0],f[b])){var c=g[b];delete g[b];for(var d=0,e;e=c[d];d++)e[0].call(e[1],f[b])}return f[b]}function b(){var d=this[0],e=this[1],f=this[2];c(e);var h=a(d);h?(!0===f&&(f=h.firstChild),f&&
f.parentNode===h||(f=null),h.insertBefore(e,f)):g[d].push([b,[d,e,f]])}function c(a){for(var b in g){var d=X.search(g[b],a,function(a){return a[1]&&a[1][1]});d&&X.remove(g[b],d)}a&&a.parentNode&&1==a.parentNode.nodeType&&a.parentNode.removeChild(a)}function d(){e&&a("head")&&a("body")&&(e=clearInterval(e))}var e,f={},g={head:[],body:[]};!q||a("head")&&a("body")||(e=setInterval(d,5),fa(d));return{head:{ready:function(a,b){g.head?g.head.push([a,b]):a.call(b,f.head)},add:function(a,c){b.call(["head",
a,c])}},body:{ready:function(a,b){g.body?g.body.push([a,b]):a.call(b,f.body)},add:function(a,c){b.call(["body",a,c])}},remove:c}}(),Y=function(){function a(d){c.globalDestroy=!0;c.add=t;for(c.remove=t;d=b.pop();)if("function"==typeof d.destroy)try{d.destroy()}catch(e){}else for(var f in d)d[f]=null;b.length=0}var b=[];if("attachEvent"in g)g.attachEvent("onunload",a);else if("addEventListener"in g)g.addEventListener("unload",a,!1);else return{add:t,remove:t};var c={add:function(a){null!=a&&b.push(a)},
remove:function(a){X.remove(b,a)}};return c}(),U=function(){function a(b){h.setAttribute("href",b);T.head.add(h,!0)}function b(){h.setAttribute("href",location.href);T.remove(h)}function c(){a(this.baseURI);this.element||(this.element=q.createElement("style"),f||(this.textNode=this.element.appendChild(q.createTextNode(""))));T.head.add(this.element);this.syncCssText();b()}var d={},e=!0,f;try{f=!q.createElement("style").appendChild(q.createTextNode(""))}catch(g){f=!0}Y.add({destroy:function(){e=!1;
for(var a in d)d[a].destroy();d=null}});var h=q&&q.createElement("base"),l=I(null,{className:"basis.CssResource",inUse:0,url:"",baseURI:"",cssText:"",resource:null,element:null,textNode:null,init:function(a){this.url=s.resolve(a);this.baseURI=s.dirname(a)+"/";d[a]=this},updateCssText:function(c){this.cssText!=c&&(this.cssText=c,this.inUse&&this.element&&(a(this.baseURI),this.syncCssText(),b()))},syncCssText:function(){this.textNode?this.textNode.nodeValue=this.cssText:this.element.styleSheet.cssText=
this.cssText},startUse:function(){if(!this.inUse){if(!this.resource){var a=n(this.url);this.resource=a;this.cssText=a.get(!0)}T.head.ready(c,this)}this.inUse+=1},stopUse:function(){this.inUse&&(this.inUse-=1,!this.inUse&&this.element&&T.remove(this.element))},destroy:function(){this.element&&e&&T.remove(this.element);this.cssText=this.resource=this.textNode=this.element=null}});l.resources=d;return l}(),M=V("basis").extend({version:"1.2.0-dev",NODE_ENV:O,config:J,platformFeature:{},resolveNSFilename:N,
patch:function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==s.extname(a)?s.resolve(a):N(a);d[a]?d[a].push(b):d[a]=[b];var c=n.get(a);c&&c.isResolved()&&b(c.get(),c.url)},namespace:V,require:W,resource:n,asset:function(a){return a},setImmediate:E,clearImmediate:S,nextTick:function(){E.apply(null,arguments)},Class:I,Token:B,DeferredToken:F,getter:A,ready:fa,cleaner:Y,console:H,path:s,doc:T,object:{extend:x,complete:e,keys:y,values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},slice:G,splice:function(a,
b){var c={};if(!b)return x(c,a);for(var d=0,e;e=b[d++];)e in a&&(c[e]=a[e],delete a[e]);return c},merge:v,iterate:z},fn:{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:function(a){return null==a||void 0==a},$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:$,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},$null:function(){return null},
$undef:t,getter:A,nullGetter:C,wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,d,e;return d=function(){c++||(d.inited=!0,d.data=e=a.apply(b||this,arguments));return e}},lazyInitAndRun:function(a,b,c){var d=0,e,f;return e=function(){d++||(e.inited=!0,e.data=f=a.call(c||this));b.apply(f,arguments);return f}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}},array:x(L,v(X,{from:L,create:aa})),string:v(l,{isEmpty:function(a){return null==
a||""==String(a)},isNotEmpty:function(a){return null!=a&&""!=String(a)}}),number:ha,bool:{invert:function(a){return!a}},json:{parse:"undefined"!=typeof JSON?JSON.parse:function(a){return l.toObject(a,!0)}}});V("basis.dev").extend(H);J.autoload&&W(J.autoload)})(this)}).call(this)