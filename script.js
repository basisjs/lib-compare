(function(){var ma={"0.js":"basis.data","1.js":"basis.event","2.js":"basis.entity","3.js":"basis.data.dataset","4.js":"basis.utils.info","5.js":"basis.utils.benchmark","6.js":"basis.utils.highlight"},la={"0.css":"","0.js":function(h,w,f,E,F,A,H,Z){function v(c,a){return function(){c.apply(this,arguments);a.apply(this,arguments)}}function C(c){var a=S[c];if(!a)for(var x=[],b={},g=1,a=S[c]={actions:x,handler:b};c;){if(c&1){var d=J[g];x.push(d.action);for(var p in d.handler)b[p]=b[p]?v(b[p],d.handler[p]):
d.handler[p]}g<<=1;c>>=1}return a}function Q(c,a){for(;a&&a!==c&&a!==a.delegate;)a=a.delegate;return a===c}function I(c,a,x){var b=c.delegate;b&&(c.root=b.root,c.target=b.target,c.data=b.data,c.state=b.state);if(c.root!==a){if(b=c.listen.root)a&&a!==c&&a.removeHandler(b,c),c.root&&c.root!==c&&c.root.addHandler(b,c);c.emit_rootChanged(a)}if(c.target!==x){if(b=c.listen.target)x&&x!==c&&x.removeHandler(b,c),c.target&&c.target!==c&&c.target.addHandler(b,c);c.emit_targetChanged(x)}for(c=c.delegates_;c;)c.delegate&&
I(c.delegate,a,x),c=c.next}function U(c,a){var x={},b;c&&c.length&&(b=x.inserted=c);a&&a.length&&(b=x.deleted=a);if(b)return x}function X(c,a){if(c&&c.itemCount){if(a&&a.itemCount){var x=[],b=[],g;for(g in c.items_){var d=c.items_[g];!1==d.basisObjectId in a.items_&&b.push(d)}for(g in a.items_)d=a.items_[g],!1==d.basisObjectId in c.items_&&x.push(d);return U(x,b)}if(c.itemCount)return{deleted:c.getItems()}}else if(a&&a.itemCount)return{inserted:a.getItems()}}function u(c,a,x,b){var g=c[b]||null,d=
null;"function"==typeof x&&(x=x.call(c,c));x instanceof $&&(d=new Y(c,a,x,fa),x=x.dataset);x instanceof f.Token&&(x=z.from(x));x instanceof z&&(d=new Y(c,a,x,ca),x=u(d,d.proxy,x.value,"adapter_"));!1==x instanceof T&&(x=null);b&&g!==d&&(g&&(g.source.removeHandler(g.handler,g),g.adapter_&&u(g,null,null,"adapter_")),d&&d.source.addHandler(d.handler,d),c[b]=d);return x}function t(c){return Array.isArray(c)?c.map(function(c){return{data:c}}):{data:c}}function k(c){c&&c.constructor===Object||(c={value:c});
return new K({data:c})}f.require("./1.js");h=this.path;E=f.Class;var s=f.cleaner,P=f.object.values;H=f.fn.$self;var q=f.event.Emitter;F=f.event.create;var B=f.event.events,y={},O=[],n={},r={priority:[],values:{},add:function(c,a){var x=c.toLowerCase();r[c]=x;n[x]=c;this.values[x]=c;a=a?this.priority.indexOf(a):-1;-1==a?this.priority.push(x):this.priority.splice(a,0,x)},getList:function(){return P(n)}};r.add("READY");r.add("DEPRECATED");r.add("UNDEFINED");r.add("ERROR");r.add("PROCESSING");var J={},
L=1,D={NONE:0,ALL:0,link:function(c,a,x){c+=a.basisObjectId;var b=x.subscribers_;b||(b=x.subscribers_={});b[c]||(b[c]=a,1==(x.subscriberCount+=1)&&x.emit_subscribersChanged(1))},unlink:function(c,a,b){c+=a.basisObjectId;(a=b.subscribers_)&&a[c]&&(delete a[c],0==(b.subscriberCount-=1)&&(b.emit_subscribersChanged(-1),b.subscribers_=null))},add:function(c,a,b){J[L]={handler:a,action:b};D[c]=L;D.ALL|=L;L<<=1},addProperty:function(c,a){var b={};b[a||c+"Changed"]=function(a,b){b&&D.unlink(c,a,b);a[c]&&
D.link(c,a,a[c])};this.add(c.toUpperCase(),b,function(a,b){b[c]&&a(c,b,b[c])})}},S={};D.addProperty("delegate");D.addProperty("target");D.addProperty("dataset");var M=E(q,{className:h+".AbstractData",state:r.UNDEFINED,emit_stateChanged:F("stateChanged","oldState"),active:!1,emit_activeChanged:F("activeChanged"),subscribeTo:D.NONE,subscriberCount:0,subscribers_:null,emit_subscribersChanged:F("subscribersChanged","delta"),syncEvents:E.oneFunctionProperty(function(){this.isSyncRequired()&&this.syncAction()},
{stateChanged:!0,subscribersChanged:!0}),syncAction:null,init:function(){q.prototype.init.call(this);this.active&&this.addHandler(C(this.subscribeTo).handler);var c=this.syncAction;c&&(this.syncAction=null,this.setSyncAction(c))},setState:function(c,a){var b=String(c);if(!n[b])throw 142;if(this.state!=b||this.state.data!=a){var d=this.state;this.state=Object(b);this.state.data=a;this.emit_stateChanged(d);return!0}return!1},deprecate:function(){this.state!=r.PROCESSING&&this.setState(r.DEPRECATED)},
setActive:function(c){c=!!c;if(this.active!=c){this.active=c;this.emit_activeChanged();if(c){c=C(this.subscribeTo);for(var a=0,b;b=c.actions[a];a++)b(D.link,this);this.addHandler(c.handler)}else{c=C(this.subscribeTo);for(a=0;b=c.actions[a++];)b(D.unlink,this);this.removeHandler(c.handler)}return!0}return!1},setSubscription:function(c){var a=this.subscribeTo,b=c&D.ALL;if(c=a^b){this.subscribeTo=b;if(this.active){var d=C(a),b=C(b);this.removeHandler(d.handler);this.addHandler(b.handler);for(d=1;c;)c&
1&&(b=J[d],a&d?b.action(D.unlink,this):b.action(D.link,this)),d<<=1,c>>=1}return!0}return!1},isSyncRequired:function(){return 0<this.subscriberCount&&(this.state==r.UNDEFINED||this.state==r.DEPRECATED)},setSyncAction:function(c){var a=this.syncAction;"function"!=typeof c&&(c=null);(this.syncAction=c)?(a||this.addHandler(this.syncEvents),this.isSyncRequired()&&this.syncAction()):a&&this.removeHandler(this.syncEvents)},destroy:function(){if(this.active)for(var c=C(this.subscribeTo),a=0,b;b=c.actions[a];a++)b(D.unlink,
this);q.prototype.destroy.call(this);this.state=r.UNDEFINED}}),a={},b={},d=function(c){this.set(this.fn(c))},g={destroy:function(c){this.value.unlink(c,this.fn)}},p={destroy:function(c){this.set(null)}},z=E(M,{className:h+".Value",emit_change:F("change","oldValue")&&function(c){B.change.call(this,c);for(var a=this;a=a.links_;)a.fn.call(a.context,this.value,c)},value:null,initValue:null,proxy:null,locked:!1,lockedValue_:null,links_:null,setNullOnEmitterDestroy:!0,bindingBridge:{attach:function(c,a,
b){c.link(b,a,!0)},detach:function(c,a,b){c.unlink(b,a)},get:function(c){return c.value}},init:function(){M.prototype.init.call(this);this.proxy&&(this.value=this.proxy(this.value));this.setNullOnEmitterDestroy&&this.value instanceof q&&this.value.addHandler(p,this);this.initValue=this.value},set:function(c){var a=this.value;c=this.proxy?this.proxy(c):c;var b=c!==a;b&&(this.setNullOnEmitterDestroy&&(a instanceof q&&a.removeHandler(p,this),c instanceof q&&c.addHandler(p,this)),this.value=c,this.locked||
this.emit_change(a));return b},reset:function(){this.set(this.initValue)},lock:function(){this.locked||(this.locked=!0,this.lockedValue_=this.value)},unlock:function(){if(this.locked){var c=this.lockedValue_;this.lockedValue_=null;this.locked=!1;this.value!==c&&this.emit_change(c)}},compute:function(c,b){b||(b=c,c=null);var x=this,d=f.event.createHandler(c,function(c){this.set(b(c,x.value))}),g=d.events.concat(String(b),this.basisObjectId).join("_"),p=a[g];if(!p){var m={};d.destroy=function(c){delete m[c.basisObjectId];
this.destroy()};this.addHandler({change:function(){for(var c in m){var a=m[c];a.token.set(b(a.object,this.value))}},destroy:function(){for(var c in m){var a=m[c];a.object.removeHandler(d,a.token);a.token.destroy()}x=m=null}});p=a[g]=function(c){var a=c.basisObjectId,g=m[a];g||(g=new f.Token(b(c,x.value)),c.addHandler(d,g),g=m[a]={token:g,object:c});return g.token};p.deferred=function(){return function(c){return p(c).deferred()}}}return p},as:function(c,a){if(this.links_)for(var b=this;b=b.links_;)if(b.context instanceof
f.Token&&b.context.fn==String(c))return a?b.context.deferred():b.context;b=new f.Token;b.fn=c;this.link(b,d);return a?b.deferred():b},deferred:function(c){return this.as(c,!0)},link:function(c,a,d){if("function"!=typeof a){var p=String(a);(a=b[p])||(a=b[p]=function(c){this[p]=c})}this.links_={value:this,context:c,fn:a,links_:this.links_};c instanceof q&&c.addHandler(g,this.links_);d||a.call(c,this.value);return c},unlink:function(c,a){for(var b=this,d;d=b,b=b.links_;)b.context!==c||a&&b.fn!==a||(b.fn=
f.fn.$undef,d.links_=b.links_,b.context instanceof q&&b.context.removeHandler(g,b))},destroy:function(){M.prototype.destroy.call(this);this.setNullOnEmitterDestroy&&this.value instanceof q&&this.value.removeHandler(p,this);for(var c=this;c=c.links_;)c.context instanceof q&&c.context.removeHandler(g,c);this.links_=this.lockedValue_=this.value=this.initValue=this.proxy=null}}),m={};z.from=function(c,a,b){var d;if(!c)return null;if(c instanceof q){b||(b=a,a=null);a=f.event.createHandler(a,function(c){this.set(b(c))});
var g=a.events.concat(String(b),c.basisObjectId).join("_");d=m[g];d||(b=f.getter(b),d=m[g]=new z({value:b(c)}),a.destroy=function(c){delete m[g];this.destroy()},c.addHandler(a,d))}d||(g=c.basisObjectId,a=c.bindingBridge,g&&a&&(d=m[g],d||(d=m[g]=new z({value:a.get(c)}),a.attach(c,d.set,d))));if(!d)throw 143;return d};z.factory=function(c,a){return function(b){return z.from(b,c,a)}};var K=E(M,{className:h+".Object",subscribeTo:D.DELEGATE+D.TARGET,data:null,emit_update:F("update","delta")&&function(c){var a=
this.delegates_;for(B.update.call(this,c);a;)a.delegate&&a.delegate.emit_update(c),a=a.next},emit_stateChanged:function(c){var a=this.delegates_;for(M.prototype.emit_stateChanged.call(this,c);a;)a.delegate&&(a.delegate.state=this.state,a.delegate.emit_stateChanged(c)),a=a.next},delegate:null,delegates_:null,emit_delegateChanged:F("delegateChanged","oldDelegate"),target:null,emit_targetChanged:F("targetChanged","oldTarget"),root:null,emit_rootChanged:F("rootChanged","oldRoot"),init:function(){this.root=
this;M.prototype.init.call(this);var c=this.delegate;c?(this.target=this.delegate=null,this.data=c.data,this.state=c.state,this.setDelegate(c)):(this.data||(this.data={}),null!==this.target&&(this.target=this))},setDelegate:function(c){if(c&&c instanceof K){if(c.delegate&&Q(this,c))return!1}else c=null;if(this.delegate!==c){var a=this.state,b=this.data,d=this.delegate,g=this.target,p=this.root,m={},f=!1,k=this.listen.delegate;if(d){k&&d.removeHandler(k,this);for(var z=d.delegates_;z;){if(z.delegate===
this){z.delegate=null;d===d?d.delegates_=z.next:d.next=z.next;break}z=z.next}}if(c){this.delegate=c;c.delegates_={delegate:this,next:c.delegates_};for(var e in c.data)!1===e in b&&(f=!0,m[e]=void 0);for(e in b)b[e]!==c.data[e]&&(f=!0,m[e]=b[e]);k&&c.addHandler(k,this)}else for(e in this.target=this.delegate=null,this.root=this,this.data={},b)this.data[e]=b[e];I(this,p,g);f&&this.emit_update(m);a===this.state||String(a)==this.state&&a.data===this.state.data||this.emit_stateChanged(a);this.emit_delegateChanged(d);
return!0}return!1},setState:function(c,a){return this.delegate?this.root.setState(c,a):M.prototype.setState.call(this,c,a)},update:function(c){if(this.delegate)return this.root.update(c);if(c){var a={},b=!1,d;for(d in c)this.data[d]!==c[d]&&(b=!0,a[d]=this.data[d],this.data[d]=c[d]);if(b)return this.emit_update(a),a}return!1},destroy:function(){M.prototype.destroy.call(this);var a=this.delegates_;for(this.delegates_=null;a;)a.delegate.setDelegate(),a=a.next;this.delegate&&this.setDelegate();this.data=
y;this.target=this.root=null}});A=E(K,{className:h+".Slot"});var ea={destroy:function(){delete this.map[this.itemId]}};H=E(null,{className:h+".KeyObjectMap",itemClass:K,keyGetter:H,map_:null,extendConstructor_:!0,init:function(){this.map_={};s.add(this)},resolve:function(a){return this.get(this.keyGetter(a),a)},create:function(a,b){var d={};a instanceof K?d.delegate=a:d.data={id:a,title:a};return new this.itemClass(d)},get:function(a,b){var d=a instanceof K?a.basisObjectId:a,g=this.map_[d];!g&&b&&
(g=this.map_[d]=this.create(a,b),g.addHandler(ea,{map:this.map_,itemId:d}));return g},destroy:function(){s.remove(this);for(var a=P(this.map_),b=0,d;d=a[b++];)d.destroy()}});var $=E(K,{className:h+".DatasetWrapper",subscribeTo:K.prototype.subscribeTo+D.DATASET,listen:{dataset:{itemsChanged:function(a,b){this.itemCount=a.itemCount;this.emit_itemsChanged(b)},destroy:function(){this.setDataset()}}},dataset:null,datasetAdapter_:null,emit_datasetChanged:F("datasetChanged","oldDataset"),emit_itemsChanged:F("itemsChanged",
"delta"),init:function(){K.prototype.init.call(this);var a=this.dataset;a&&(this.dataset=null,this.setDataset(a))},setDataset:function(a){a=u(this,this.setDataset,a,"datasetAdapter_");if(this.dataset!==a){var b=this.listen.dataset,d=this.dataset,g;b&&(d&&d.removeHandler(b,this),a&&a.addHandler(b,this));this.itemCount=a?a.itemCount:0;(g=X(d,a))&&this.emit_itemsChanged(g);this.dataset=a;this.emit_datasetChanged(d)}},has:function(a){return this.dataset?this.dataset.has(a):null},getItems:function(){return this.dataset?
this.dataset.getItems():[]},pick:function(){return this.dataset?this.dataset.pick():null},top:function(a){return this.dataset?this.dataset.top(a):[]},forEach:function(a){if(this.dataset)return this.dataset.forEach(a)},destroy:function(){(this.dataset||this.datasetAdapter_)&&this.setDataset();K.prototype.destroy.call(this)}}),T=E(M,{className:h+".AbstractDataset",itemCount:0,items_:null,members_:null,cache_:null,emit_itemsChanged:F("itemsChanged","delta")&&function(a){var b,d=0,g=0,p;if(b=a.inserted)for(;p=
b[d];)this.items_[p.basisObjectId]=p,d++;if(b=a.deleted)for(;p=b[g];)delete this.items_[p.basisObjectId],g++;this.itemCount+=d-g;this.cache_=d==this.itemCount?a.inserted:null;B.itemsChanged.call(this,a)},init:function(){M.prototype.init.call(this);this.members_={};this.items_={}},has:function(a){return!(!a||!this.items_[a.basisObjectId])},getItems:function(){this.cache_||(this.cache_=P(this.items_));return this.cache_},pick:function(){for(var a in this.items_)return this.items_[a];return null},top:function(a){var b=
[];if(a)for(var d in this.items_)if(b.push(this.items_[d])>=a)break;return b},forEach:function(a){for(var b=this.getItems(),d=0;d<b.length;d++)a(b[d])},clear:function(){},destroy:function(){this.clear();M.prototype.destroy.call(this);this.cache_=O;this.itemCount=0;this.items_=this.members_=null}}),V=E(T,{className:h+".Dataset",listen:{item:{destroy:function(a){this.remove([a])}}},init:function(){T.prototype.init.call(this);var a=this.items;a&&(this.items=null,this.set(a))},add:function(a){var b=this.members_,
d=this.listen.item,g=[],p;a&&!Array.isArray(a)&&(a=[a]);for(var m=0;m<a.length;m++){var f=a[m];if(f instanceof K){var k=f.basisObjectId;b[k]||(b[k]=f,d&&f.addHandler(d,this),g.push(f))}}g.length&&this.emit_itemsChanged(p={inserted:g});return p},remove:function(a){var b=this.members_,d=this.listen.item,g=[],p;a&&!Array.isArray(a)&&(a=[a]);for(var m=0;m<a.length;m++){var f=a[m];if(f instanceof K){var k=f.basisObjectId;b[k]&&(d&&f.removeHandler(d,this),delete b[k],g.push(f))}}g.length&&this.emit_itemsChanged(p=
{deleted:g});return p},set:function(a){if(!this.itemCount)return this.add(a);if(!a||!a.length)return this.clear();for(var b=this.members_,d=this.listen.item,g={},p=[],m=[],f,k,z,h=0;h<a.length;h++)f=a[h],f instanceof K&&(k=f.basisObjectId,g[k]=f,b[k]||(b[k]=f,d&&f.addHandler(d,this),m.push(f)));for(k in b)g[k]||(f=b[k],d&&f.removeHandler(d,this),delete b[k],p.push(f));(z=U(m,p))&&this.emit_itemsChanged(z);return z},sync:function(a){a=this.set(a)||{};var b=a.deleted;V.setAccumulateState(!0);if(b)for(var d=
0,g;g=b[d];d++)g.destroy();V.setAccumulateState(!1);return a.inserted},clear:function(){var a=this.getItems(),b=this.listen.item,d;if(a.length){if(b)for(d=0;d<a.length;d++)a[d].removeHandler(b,this);this.emit_itemsChanged(d={deleted:a});this.members_={}}return d}}),Y=function(a,b,d,g){this.context=a;this.fn=b;this.source=d;this.handler=g};Y.prototype.adapter_=null;Y.prototype.proxy=function(){this.fn.call(this.context,this.source)};var fa={datasetChanged:function(a){this.fn.call(this.context,a)},
destroy:function(){this.fn.call(this.context,null)}},ca={change:function(a){this.fn.call(this.context,a)},destroy:function(){this.fn.call(this.context,null)}};V.setAccumulateState=function(){function a(){var b=z;z={};for(var c in b){var e=b[c];p.call(e.dataset,e)}}function b(a){var c=this.basisObjectId,e=a.inserted,N=a.deleted,l=z[c];if(e&&N)l&&(delete z[c],p.call(l.dataset,l)),p.call(this,a);else{if(l){var d=l[e?"inserted":"deleted"];if(d){d.push.apply(d,e||N);return}p.call(l.dataset,l)}z[c]=a;a.dataset=
this}}function d(){k=null;m&&(m=0,g.emit_itemsChanged=p,a())}var g=T.prototype,p=g.emit_itemsChanged,m=0,k,z={};return function(z){z?(0==m&&(g.emit_itemsChanged=b,k||(k=f.setImmediate(d))),m++):(m-=0<m,0==m&&(g.emit_itemsChanged=p,a()))}}();w.exports={STATE:r,SUBSCRIPTION:D,AbstractData:M,Value:z,Object:K,Slot:A,KeyObjectMap:H,AbstractDataset:T,Dataset:V,DatasetWrapper:$,DatasetAdapter:Y,isConnected:Q,getDatasetDelta:X,resolveDataset:u,wrapData:t,wrapObject:k,wrap:function(a,b){var d=b?k:t;return Array.isArray(a)?
a.map(d):d(a)}}},"1.js":function(h,w,f,E,F,A,H,Z){function v(f){var h=Q[f];h||(h=function(){for(var h=this,t,k;h=h.handler;){k=h.callbacks[f];if("function"==typeof k){if(!t){t=[this];for(var s=0;s<arguments.length;s++)t.push(arguments[s])}k.apply(h.context||this,t)}k=h.callbacks["*"];if("function"==typeof k){if(!t)for(t=[this],s=0;s<arguments.length;s++)t.push(arguments[s]);k.call(h.context||this,{sender:this,type:f,args:t})}}},Q[f]=h);return h}h=f.Class;var C={},Q={},I=function(){};h=h(null,{className:this.path+
".Emitter",extendConstructor_:!0,handler:null,emit_destroy:v("destroy"),listen:h.nestedExtendProperty(),init:function(){this.handler&&!this.handler.callbacks&&(this.handler={callbacks:this.handler,context:this,handler:null})},addHandler:function(f,h){this.handler={callbacks:f,context:h||this,handler:this.handler}},removeHandler:function(f,h){var u=this,t;for(h=h||this;t=u,u=u.handler;)if(u.callbacks===f&&u.context===h){u.callbacks=C;t.handler=u.handler;break}},destroy:function(){this.destroy=I;this.emit_destroy();
this.handler=null}});w.exports={create:v,createHandler:function(f,h){var u={events:[]};if(f){f=String(f).trim().split(/\s+|\s*,\s*/).sort();for(var u={events:f},t=0,k;k=f[t];t++)"destroy"!=k&&(u[k]=h)}return u},events:Q,Emitter:h}},"2.js":function(h,w,f,E,F,A,H,Z){function v(e){$[e]=$[e]||0;return e+$[e]++}function C(e,a){var l=V[e];if(l){for(var b=0,c;c=l[b];b++)c[0][c[1]]=a;delete V[e]}T[e]=a}function Q(e,a,l){if(T[e])return T[e];var b=V[e];b||(b=V[e]=[]);b.push([a,l]);return Y}function I(){var e=
L(arguments),a=e.pop(),l=e[0],b=e[1],c=e[2],d;if("function"!=typeof a)throw 145;switch(e.length){case 0:d=function(){return a()};break;case 1:d=function(e,b,c){return l in e?a(b[l]):c};break;case 2:d=function(e,c,d){return l in e||b in e?a(c[l],c[b]):d};break;case 3:d=function(e,d,g){return l in e||b in e||c in e?a(d[l],d[b],d[c]):g};break;default:d=function(l,b,c){for(var d=!1,G=[],R=0,g;g=e[R];R++)d=d||g in l,G.push(b[g]);return d?a.apply(null,G):c}}d.args=e;return d.calc=d}function U(){return I.apply(null,
L(arguments).concat(function(){for(var e=[],a=arguments.length;0<a--;){if(null==arguments[a])return null;e.push(arguments[a])}return e.join("-")}))}function X(e,a){var l=["has"],b=[O],c=[],d;for(d in e)if(O.call(e,d)){var g="v"+c.length,ha="f"+c.length,p=e[d];l.push(g,ha);b.push(p,a[d]);c.push('"'+d+'":has.call(data,"'+d+'")?'+ha+'(data["'+d+'"],'+g+"):"+g+("function"==typeof p?"(data)":""))}c=c.sort().join(",");(d=ja[c])||(d=ja[c]=new Function(l,"return function(data){return {"+c+"};};"));return d.apply(null,
b)}function u(e,a){if(!Array.isArray(e))return null;if(!Array.isArray(a)||e.length!=a.length)return e||null;for(var l=0;l<e.length;l++)if(e[l]!==a[l])return e;return a}function t(e,a,l){e.aliases[a]=a;l="string"==typeof l||Array.isArray(l)||"function"==typeof l&&l.calc!==l?{type:l}:f.object.slice(l);if("type"in l){"string"==typeof l.type&&(l.type=Q(l.type,e.fields,a));if(Array.isArray(l.type)){var b=l.type.slice();1==b.length?(l.type=f.fn.$const(b[0]),l.defValue=b[0]):(l.type=function(e,a){return-1!=
b.indexOf(e)?e:a},l.defValue=-1!=b.indexOf(l.defValue)?l.defValue:b[0])}l.type===Array&&(l.type=u);"function"!=typeof l.type&&(l.type=J)}var c=l.type||J;-1!=[z,m,K,ea].indexOf(c)&&(l.id=!0);l.id&&(e.index||(e.index=new fa(String)),e.idFields[a]=!0,e.idField||e.compositeKey?(e.idField=null,e.compositeKey=U.apply(null,n(e.idFields))):e.idField=a);l.calc?(s(e,a,l.calc),e.fields[a]=W):e.fields[a]=c;e.defaults[a]="defValue"in l?l.defValue:c();aa[a]||(aa[a]={destroy:function(){this.set(a,null)}})}function k(e,
a,l){!1!=l in e.fields&&(a in e.aliases||(e.aliases[a]=l))}function s(e,a,l){e.calcs||(e.calcs=[]);var b=e.calcs,c=e.deps,d=l.args||[],g={args:d,wrapper:l},ha=e.calcs.length,p=0;if(d)for(var m=0,k;k=b[m];m++)-1!=d.indexOf(k.key)&&(p=m+1);if(a){g.key=a;for(m=0;k=b[m];m++)if(-1!=k.args.indexOf(a)){ha=m;break}if(p>ha)return;e.idField&&a==e.idField&&(e.compositeKey=l);c[a]=d.reduce(function(e,a){for(var l=c[a]||[a],b=0;b<l.length;b++)f.array.add(e,l[b]);return e},[]);for(var na in c)e=c[na].indexOf(a),
-1!=e&&Array.prototype.splice.apply(c[na],[e,1].concat(c[a]))}else ha=p;b.splice(Math.min(ha,p),0,g)}function P(e){return function(a){return a&&this.modified&&e in this.modified?this.modified[e]:this.data[e]}}function q(e){return function(a,l){return this.set(e,a,l)}}f.require("./1.js");f.require("./0.js");f.require("./3.js");var B=this.path,y=f.Class,O=Object.prototype.hasOwnProperty,n=f.object.keys,r=f.object.extend,J=f.fn.$self,L=f.array.from,D=f.event.Emitter;h=f.event.create;var S=f.data.Object,
M=f.data.Slot,a=f.data.Dataset;A=f.data.dataset.Subset;var b=f.data.dataset.Split,d={},g=[],p={string:!0,number:!0},z=function(e){return isNaN(e)?null:Number(e)},m=function(e){return isNaN(e)?null:Number(e)},K=function(e){return isNaN(e)?null:parseInt(e,10)},ea=function(e){return null==e?null:String(e)},$={},T={},V={},Y=function(){},fa=y(null,{className:B+".Index",items:null,fn:String,init:function(e){this.items={};"function"==typeof e&&(this.fn=e)},calcWrapper:function(e,a){var l=this.fn(e,a);if(l!==
a&&O.call(this.items,l))throw 144;return l},get:function(e,a){var l=O.call(this.items,e)&&this.items[e];if(l&&(!a||l.entityType===a))return l},add:function(e,a){var l=O.call(this.items,e)&&this.items[e];if(a&&(!l||l===a))return this.items[e]=a,!0},remove:function(e,a){if(this.items[e]===a)return delete this.items[e],!0},destroy:function(){this.items=null}});H=function(e,a){return function(l){return e.prototype[a].call(this,l&&l.map(this.wrapper))}};E=function(e,a){return function(){this.name||(this.name=
v(a));e.prototype.init.call(this)}};F=function(e){return function(e){var l=f.object.slice(this.items_),b=[];if(e){a.setAccumulateState(!0);for(var c=0;c<e.length;c++){var d=this.wrapper(e[c]);d&&(l[d.basisObjectId]=!1)}a.setAccumulateState(!1)}for(var g in this.items_)!1==g in l&&b.push(this.items_[g]);a.setAccumulateState(!0);for(g in l)l[g]&&l[g].destroy();a.setAccumulateState(!1);return b.length?b:null}};var ca=y(a,{className:B+".EntitySet",name:null,wrapper:J,init:E(a,"EntitySet"),sync:F(a),set:H(a,
"set"),add:H(a,"add"),remove:H(a,"remove"),destroy:function(){a.prototype.destroy.call(this);this.wrapper=null}}),c=y(ca,{className:B+".ReadOnlyEntitySet",set:f.fn.$false,add:f.fn.$false,remove:f.fn.$false,clear:f.fn.$false});A=y(A,{className:B+".EntityCollection",name:null,init:E(A,"EntityCollection"),sync:F(A)});E=y(b,{className:B+".EntityGrouping",name:null,subsetClass:c,init:E(b,"EntityGrouping"),sync:F(b),getSubset:function(e,a){var l=b.prototype.getSubset.call(this,e,a);l&&l.dataset&&(l.dataset.wrapper=
this.wrapper);return l}});var ba=function(e,b){if(this instanceof ba){e||(e=J);if(!b||T[b])b=v("UntitledEntitySetType");var l=new x({entitySetClass:{wrapper:e}}),c=l.entitySetClass,d=function(e,b){return null!=e?(!1==b instanceof ca&&(b=l.createEntitySet()),b.set(e instanceof a?e.getItems():L(e)),b):null};"string"==typeof e&&(c.prototype.wrapper=Q(e,c.prototype,"wrapper"));C(b,d);r(d,{type:l,typeName:b,toString:function(){return this.typeName+"()"},entitySetType:l,extend:function(){return c.extend.apply(c,
arguments)},extendClass:function(){c.extend.apply(c,arguments);return d},reader:function(e){if(Array.isArray(e)){var a=c.prototype.wrapper;return e.map(a.reader||a)}return e},extendReader:function(e){var a=d.reader;d.reader=function(b){Array.isArray(b)&&e(b);return a(b)}}});return d}},x=y(null,{className:B+".EntitySetConstructor",entitySetClass:ca,extendConstructor_:!0,createEntitySet:function(){return new this.entitySetClass}}),ia=function(e){if(this instanceof ia){var a;a=e.singleton?function(e){var a=
b.get();a?e&&a.update(e):a=new c(e||{});return a}:function(e,a){if(null!=e){if(e===a||e.entityType===b)return e;var d,N=b.idField;if(p[typeof e]){if(!N)return;if(a=b.index.get(e,b))return a;d=e;e={};e[N]=d}else b.compositeKey?d=b.compositeKey(e,e):N&&(d=e[N]),null!=d&&(a=b.index.get(d,b));a&&a.entityType===b?a.update(e):a=new c(e);return a}};var b=new ka(e||{},a),c=b.entityClass;C(b.name,a);r(a,{all:b.all,type:b,typeName:b.name,entityType:b,toString:function(){return this.typeName+"()"},reader:function(e){return b.reader(e)},
get:function(e){return b.get(e)},getSlot:function(e,a){return b.getSlot(e,a)},extend:function(){return c.extend.apply(c,arguments)},extendClass:function(){return c.extend.apply(c,arguments)},extendReader:function(e){var b=a.reader;a.reader=function(a){a&&"object"==typeof a&&e(a);return b(a)}}});return a}},aa={},ja={},W=function(e,a){return a},ka=y(null,{className:B+".EntityType",wrapper:null,all:null,fields:null,idFields:null,defaults:null,aliases:null,slots:null,singleton:!1,index:null,entityClass:null,
init:function(e,a){this.name=e.name;if(!this.name||T[this.name])this.name=v("UntitledEntityType");this.fields={};this.deps={};this.idFields={};this.defaults={};this.aliases={};this.slots={};var b=e.index;b&&b instanceof fa&&(this.index=b);this.wrapper=a;if(!1=="all"in e||e.all||e.singleton)this.all=new c(f.object.complete({wrapper:a},e.all));if(this.singleton=!!e.singleton){var d;this.get=function(){return d};this.all.addHandler({itemsChanged:function(e,a){d=a.inserted?a.inserted[0]:null}},this)}for(var R in e.fields)t(this,
R,e.fields[R]);for(R in e.aliases)k(this,R,e.aliases[R]);e.constrains&&e.constrains.forEach(function(e){s(this,null,e)},this);b={};for(R in this.defaults)b[R]=void 0;this.entityClass=da(this,this.all,this.fields,this.slots);this.entityClass.extend({entityType:this,type:a,typeName:this.name,state:e.state||this.entityClass.prototype.state,generateData:X(this.defaults,this.fields),initDelta:b});for(var p in this.fields)this.entityClass.prototype["get_"+p]=P(p),this.fields[p]!==W&&(this.entityClass.prototype["set_"+
p]=q(p));g.push(this)},reader:function(e){var a={};if(p[typeof e])return this.idField?e:null;if(!e||null==e)return null;for(var b in e){var c=this.aliases[b];if(c){var d=this.fields[c].reader;a[c]=d?d(e[b]):e[b]}}return a},get:function(e){e=this.getId(e);if(null!=e)return this.index.get(e,this)},getId:function(e){if((this.idField||this.compositeKey)&&null!=e){if(p[typeof e])return e;if(e&&e.entityType===this)return e.__id__;e instanceof S&&(e=e.data);return this.compositeKey?this.compositeKey(e,e):
e[this.idField]}},getSlot:function(e){var a=this.getId(e);if(null!=a){var b=O.call(this.slots,a)&&this.slots[a];b||(p[typeof e]&&(b={},this.idField&&!this.compositeKey&&(b[this.idField]=e),e=b),b=this.slots[a]=new M({delegate:this.get(a)||null,data:e}));return b}}}),ga=y(S,{className:B+".BaseEntity",target:!0,setDelegate:function(){},modified:null,emit_rollbackUpdate:h("rollbackUpdate")}),da=function(e,a,b,c){function g(a,b,l){var c=e.calcs,d=a.data,N=!1,G=a.__id__,R;try{if(c)for(var f=0,m;m=c[f];f++){var k=
m.key,z=d[k],h=m.wrapper(b,d,z);k&&h!==z&&(d[k]=h,b[k]=z,N=!0)}R=e.compositeKey?e.compositeKey(b,d,G):e.idField&&e.idField in b?d[e.idField]:G;R!==G&&e.index.calcWrapper(R,G)}catch(K){N=!1;R=G;for(k in b)a.data[k]=b[k];if(l&&!a.modified)for(k in l){a.modified=l;break}}R!==G&&(a.__id__=R,p(a,G,R));return N}function p(a,b,l){var d=e.index;null!=b&&(d.remove(b,a),O.call(c,b)&&c[b].setDelegate());null!=l&&(d.add(l,a),O.call(c,l)&&c[l].setDelegate(a))}return y(ga,{className:B+".Entity",extendConstructor_:!1,
fieldHandlers_:null,init:function(e){this.delegate=null;this.data=this.generateData(e);ga.prototype.init.call(this);for(var b in this.data)(e=this.data[b])&&e!==this&&e instanceof D&&(e.addHandler(aa[b],this),this.fieldHandlers_||(this.fieldHandlers_={}),this.fieldHandlers_[b]=!0);g(this,this.initDelta);a&&a.emit_itemsChanged({inserted:[this]})},toString:function(){return"[object "+this.constructor.className+"("+this.entityType.name+")]"},getId:function(){return this.__id__},get:function(e,a){return a&&
this.modified&&e in this.modified?this.modified[e]:this.data[e]},set:function(a,c,d,N){var G=b[a];if(!G)return!1;var p,f=this.modified;G===u&&f&&a in f&&(c=u(c,f[a]));c=G(c,this.data[a]);G=this.data[a];if(c===G||c&&G&&c.constructor===Date&&G.constructor===Date&&+c===+G)!d&&f&&a in f&&(p={rollback:{key:a,value:f[a]}},delete f[a],n(f).length||(this.modified=null));else a:{p={};if(!e.idFields[a])if(d)f||(this.modified=f={}),!1===a in f?(p.rollback={key:a,value:void 0},f[a]=G):f[a]===c&&(p.rollback={key:a,
value:c},delete f[a],n(f).length||(this.modified=null));else if(f&&a in f)if(f[a]!==c){p.rollback={key:a,value:f[a]};f[a]=c;break a}else return!1;this.data[a]=c;this.fieldHandlers_&&this.fieldHandlers_[a]&&(G.removeHandler(aa[a],this),this.fieldHandlers_[a]=!1);c&&c!==this&&c instanceof D&&(c.addHandler(aa[a],this),this.fieldHandlers_||(this.fieldHandlers_={}),this.fieldHandlers_[a]=!0);p.key=a;p.value=G;p.delta={};p.delta[a]=G}if(!N&&p){a=p.key;d=p.delta||{};var m;p.rollback&&(m={},m[p.rollback.key]=
p.rollback.value);g(this,d,m)&&(a=!0);a&&(this.emit_update(d),p.delta=d);m&&this.emit_rollbackUpdate(m)}return p||!1},update:function(a,e){var b=!1,l={};if(a){var c,d={},N,G;for(G in a)if(N=this.set(G,a[G],e,!0))N.key&&(b=!0,l[N.key]=N.value),N.rollback&&(c=!0,d[N.rollback.key]=N.rollback.value);g(this,l,d)&&(b=!0);b&&this.emit_update(l);c&&this.emit_rollbackUpdate(d)}return b?l:!1},generateData:function(){return{}},reset:function(){this.update(this.generateData({}))},clear:function(){var a={},e;
for(e in this.data)a[e]=void 0;return this.update(a)},commit:function(a){var e=this.modified;this.modified=null;a&&this.update(a);e&&this.emit_rollbackUpdate(e)},rollback:function(a){var b=this.modified;b&&a&&(Array.isArray(a)||(a=[a]),b=f.object.slice(b,a.reduce(function(a,b){return a.concat(e.deps[b]||b)},[])));this.update(b,!0)},destroy:function(){if(this.fieldHandlers_){for(var e in this.fieldHandlers_)this.fieldHandlers_[e]&&this.data[e].removeHandler(aa[e],this);this.fieldHandlers_=null}null!=
this.__id__&&p(this,this.__id__,null);S.prototype.destroy.call(this);a&&a.emit_itemsChanged({deleted:[this]});this.data=d;this.modified=null}})};w.exports={isEntity:function(a){return a&&a instanceof ga},createType:function(a,b){var l=a||{};"string"==typeof a?l={name:l,fields:b||{}}:b&&(l=f.object.merge(l,{fields:b}));return new ia(l)},createSetType:function(a,b){return 1<arguments.length?new ba(b,a):new ba(a)},validate:function(){for(var a in V)f.dev.warn(B+": type `"+a+"` is not defined, but used by "+
V[a].length+" type(s)")},getTypeByName:function(a){return T[a]},get:function(a,b){var l=T[a];if(l)return l.get(b)},NumericId:z,NumberId:m,IntId:K,StringId:ea,Index:fa,CalculateField:I,calc:I,EntityType:ia,Entity:da,BaseEntity:ga,EntitySetType:ba,EntitySet:ca,ReadOnlyEntitySet:c,Collection:A,Grouping:E}},"3.js":function(h,w,f,E,F,A,H,Z){function v(a,b){var d={},g;a&&a.length&&(g=d.inserted=a);b&&b.length&&(g=d.deleted=b);if(g)return d}function C(a,b){return function g(b){if(!b)return null;if(b.__extend__)return b;
"string"==typeof b||Array.isArray(b)||(b="object"==typeof b?f.object.keys(b):null);return X(f.event.createHandler(b,a),{__extend__:g})}(b)}function Q(a,b,d,g){return new n(X({keyGetter:b,itemClass:d,create:function(a,b){var d=n.prototype.create.call(this,a,b);d.setDataset(new g({ruleValue:a}));return d}},a))}function I(a,b){if(!a.length)return 0;var d=b.value,g=b.object.basisObjectId,p,f,m,k,h=0,n=a.length-1;do if(m=h+n>>1,k=a[m],p=k.value,d<p)n=m-1;else if(d>p)h=m+1;else if(f=k.object.basisObjectId,
g<f)n=m-1;else if(g>f)h=m+1;else return m;while(h<=n);return m+(p==d?f<g:p<d)}function U(a,b){return+(a.value>b.value)||-(a.value<b.value)||a.object.basisObjectId-b.object.basisObjectId}f.require("./1.js");f.require("./0.js");A=this.path;H=f.Class;var X=f.object.extend,u=f.object.values,t=f.getter,k=f.fn.$self,s=f.fn.$true,P=f.fn.$false,q=f.array.from,B=f.event.create,y=f.data.SUBSCRIPTION,O=f.data.Object,n=f.data.KeyObjectMap,r=f.data.AbstractDataset,J=f.data.Dataset;Z=f.data.DatasetWrapper;y.add("SOURCE",
{sourceChanged:function(a,b){b&&y.unlink("source",a,b);a.source&&y.link("source",a,a.source)},sourcesChanged:function(a,b){var d;if(d=b.inserted)for(var g=0;d[g];g++)y.link("source",a,d[g]);if(d=b.deleted)for(g=0;d[g];g++)y.unlink("source",a,d[g])}},function(a,b){for(var d=b.sources||(b.source?[b.source]:[]),g=0,f;f=d[g++];)a("source",b,f)});y.addProperty("minuend");y.addProperty("subtrahend");var L=H(r,{className:A+".Merge",subscribeTo:y.SOURCE,emit_sourcesChanged:B("sourcesChanged","delta"),sources:null,
rule:function(a,b){return 0<a},listen:{source:{itemsChanged:function(a,b){var d=this.members_,g={},f,k;if(b.inserted)for(var m=0;f=b.inserted[m];m++)k=f.basisObjectId,d[k]?d[k].count++:d[k]={count:1,object:f},g[k]=d[k];if(b.deleted)for(m=0;f=b.deleted[m];m++)k=f.basisObjectId,g[k]=d[k],d[k].count--;this.applyRule(g)},destroy:function(a){this.removeSource(a)}}},init:function(){r.prototype.init.call(this);var a=this.sources;this.sources=[];a&&a.forEach(this.addSource,this)},setRule:function(a){"function"!=
typeof a&&(a=L.UNION);this.rule!==a&&(this.rule=a,this.applyRule())},applyRule:function(a){var b=this.members_,d=this.rule,g=this.sources.length,f=[],k=[],m,h;a||(a=b);for(var n in a)a=b[n],m=g&&a.count&&d(a.count,g),m!=!!this.items_[n]&&(m?f:k).push(a.object),0==a.count&&delete b[n];(h=v(f,k))&&this.emit_itemsChanged(h);return h},addSource:function(a){if(a instanceof r&&f.array.add(this.sources,a)){this.listen.source&&a.addHandler(this.listen.source,this);var b=this.members_,d;for(d in a.items_)b[d]?
b[d].count++:b[d]={count:1,object:a.items_[d]};this.applyRule();this.emit_sourcesChanged({inserted:[a]});return!0}},removeSource:function(a){if(f.array.remove(this.sources,a)){this.listen.source&&a.removeHandler(this.listen.source,this);var b=this.members_,d;for(d in a.items_)b[d].count--;this.applyRule();this.emit_sourcesChanged({deleted:[a]});return!0}},setSources:function(a){for(var b=q(this.sources),d=0,g;g=a[d];d++)g instanceof r&&(f.array.remove(b,g)||this.addSource(g));b.forEach(this.removeSource,
this)},clear:function(){q(this.sources).forEach(this.removeSource,this)},destroy:function(){r.prototype.destroy.call(this);this.sources=null}});L.UNION=L.prototype.rule;L.INTERSECTION=function(a,b){return a==b};L.DIFFERENCE=function(a,b){return 1==a};L.MORE_THAN_ONE_INCLUDE=function(a,b){return 1==b||1<a};L.AT_LEAST_ONE_EXCLUDE=function(a,b){return 1==b||a<b};var D=function(a){return!this.has(a)};h=H(r,{className:A+".Subtract",subscribeTo:y.MINUEND+y.SUBTRAHEND,minuend:null,emit_minuendChanged:B("minuendChanged",
"oldMinuend"),subtrahend:null,emit_subtrahendChanged:B("subtrahendChanged","oldSubtrahend"),listen:{minuend:{itemsChanged:function(a,b){if(this.subtrahend){var d=v(b.inserted&&b.inserted.filter(D,this.subtrahend),b.deleted&&b.deleted.filter(this.has,this));d&&this.emit_itemsChanged(d)}},destroy:function(){this.setOperands(null,this.subtrahend)}},subtrahend:{itemsChanged:function(a,b){if(this.minuend){var d=v(b.deleted&&b.deleted.filter(D,this),b.inserted&&b.inserted.filter(this.has,this));d&&this.emit_itemsChanged(d)}},
destroy:function(){this.setOperands(this.minuend,null)}}},init:function(){r.prototype.init.call(this);var a=this.minuend,b=this.subtrahend;this.subtrahend=this.minuend=null;(a||b)&&this.setOperands(a,b)},setOperands:function(a,b){var d,g=!1;!1==a instanceof r&&(a=null);!1==b instanceof r&&(b=null);var f=this.minuend,k=this.subtrahend;if(f!==a){g=!0;this.minuend=a;var m=this.listen.minuend;m&&(f&&f.removeHandler(m,this),a&&a.addHandler(m,this));this.emit_minuendChanged(f)}if(k!==b){g=!0;this.subtrahend=
b;if(m=this.listen.subtrahend)k&&k.removeHandler(m,this),b&&b.addHandler(m,this);this.emit_subtrahendChanged(k)}if(!g)return!1;if(a&&b){var g=[],f=[],h;for(h in this.items_)a.items_[h]&&!b.items_[h]||g.push(this.items_[h]);for(h in a.items_)this.items_[h]||b.items_[h]||f.push(a.items_[h]);(d=v(f,g))&&this.emit_itemsChanged(d)}else this.itemCount&&this.emit_itemsChanged(d={deleted:this.getItems()});return d},setMinuend:function(a){return this.setOperands(a,this.subtrahend)},setSubtrahend:function(a){return this.setOperands(this.minuend,
a)},clear:function(){this.setOperands()}});var S=H(r,{className:A+".SourceDataset",subscribeTo:y.SOURCE,source:null,emit_sourceChanged:B("sourceChanged","oldSource"),sourceAdapter_:null,sourceMap_:null,listen:{source:{destroy:function(){this.sourceAdapter_||this.setSource()}}},init:function(){this.sourceMap_={};r.prototype.init.call(this);var a=this.source;a&&(this.source=null,this.setSource(a))},setSource:function(a){a=f.data.resolveDataset(this,this.setSource,a,"sourceAdapter_");if(this.source!==
a){var b=this.source,d=this.listen.source;this.source=a;if(d){var g=d.itemsChanged;b&&(b.removeHandler(d,this),g&&g.call(this,b,{deleted:b.getItems()}));a&&(a.addHandler(d,this),g&&g.call(this,a,{inserted:a.getItems()}))}this.emit_sourceChanged(b)}},clear:function(){this.setSource()},destroy:function(){r.prototype.destroy.call(this);this.sourceMap_=null}}),M=H(S,{className:A+".MapFilter",map:k,filter:P,rule:t(s),ruleEvents:C(function(a){var b=this.map?this.map(a):object;if(!1==b instanceof O||this.filter(b))b=
null;var d=this.sourceMap_[a.basisObjectId],g=d.member;if(g!==b){var f=this.members_,k,m,h;d.member=b;g&&(d=g.basisObjectId,this.removeMemberRef&&this.removeMemberRef(g,a),0==--f[d]&&(delete f[d],h=[g]));b&&(g=b.basisObjectId,this.addMemberRef&&this.addMemberRef(b,a),f[g]?f[g]++:(f[g]=1,m=[b]));(k=v(m,h))&&this.emit_itemsChanged(k)}},"update"),addMemberRef:null,removeMemberRef:null,listen:{source:{itemsChanged:function(a,b){var d=this.sourceMap_,g=this.members_,f=[],k=[],m,h,n,r=this.ruleEvents;J.setAccumulateState(!0);
if(b.inserted)for(var q=0;m=b.inserted[q];q++){n=this.map?this.map(m):m;if(!1==n instanceof O||this.filter(n))n=null;r&&m.addHandler(r,this);d[m.basisObjectId]={sourceObject:m,member:n};n&&(h=n.basisObjectId,g[h]?g[h]++:(g[h]=1,f.push(n)),this.addMemberRef&&this.addMemberRef(n,m))}if(b.deleted)for(q=0;m=b.deleted[q];q++)h=m.basisObjectId,n=d[h].member,r&&m.removeHandler(r,this),delete d[h],n&&(h=n.basisObjectId,0==--g[h]&&(delete g[h],k.push(n)),this.removeMemberRef&&this.removeMemberRef(n,m));J.setAccumulateState(!1);
(b=v(f,k))&&this.emit_itemsChanged(b)}}},setMap:function(a){"function"!=typeof a&&(a=k);if(this.map!==a)return this.map=a,this.applyRule()},setFilter:function(a){"function"!=typeof a&&(a=P);if(this.filter!==a)return this.filter=a,this.applyRule()},setRule:function(a){"function"!=typeof a&&(a=s);if(this.rule!==a)return this.rule=a,this.applyRule()},applyRule:function(){var a=this.sourceMap_,b=this.members_,d,g,f,k,m,h=[],n=[],q,r;for(r in a){m=a[r];k=m.sourceObject;d=m.member;g=this.map?this.map(k):
k;if(!1==g instanceof O||this.filter(g))g=null;d!=g&&(m.member=g,d&&(f=d.basisObjectId,this.removeMemberRef&&this.removeMemberRef(d,k),b[f]--),g&&(d=g.basisObjectId,this.addMemberRef&&this.addMemberRef(g,k),d in b?b[d]++:(b[d]=1,h.push(g))))}for(f in this.items_)0==b[f]&&(delete b[f],n.push(this.items_[f]));(q=v(h,n))&&this.emit_itemsChanged(q);return q}});E=H(M,{className:A+".Subset",filter:function(a){return!this.rule(a)}});F=H(M,{className:A+".Split",subsetClass:r,subsetWrapperClass:Z,keyMap:null,
map:function(a){return this.keyMap.resolve(a)},setRule:function(a){"function"!=typeof a&&(a=s);if(this.rule!==a)return this.rule=a,this.keyMap.keyGetter=a,this.applyRule()},addMemberRef:function(a,b){a.dataset.emit_itemsChanged({inserted:[b]})},removeMemberRef:function(a,b){a.dataset.emit_itemsChanged({deleted:[b]})},init:function(){this.keyMap&&!1!=this.keyMap instanceof n||(this.keyMap=Q(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));M.prototype.init.call(this)},getSubset:function(a,
b){return this.keyMap.get(a,b)},destroy:function(){M.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});B=H(S,{className:A+".Slice",rule:t(s),ruleEvents:C(function(a){var b=this.sourceMap_[a.basisObjectId];a=this.rule(a);var d=this.index_;if(a!==b.value){var g=I(d,b),f=d[g-1],k=d[g+1];b.value=a;if(f&&(f.value>a||f.value==a&&f.object.basisObjectId>b.object.basisObjectId)||k&&(k.value<a||k.value==a&&k.object.basisObjectId<b.object.basisObjectId))d.splice(g,1),d.splice(I(d,b),0,b),
this.applyRule()}},"update"),index_:null,orderDesc:!1,offset:0,limit:10,listen:{source:{itemsChanged:function(a,b){var d=this.sourceMap_,g=this.index_,f=this.ruleEvents,k=!1,m=!1,h,n=b.inserted,q=b.deleted;if(q){q.length>g.length-q.length&&(k=!0,m=q.length!=g.length,g.length=0);for(var r=0,s;s=q[r];r++)k||(h=d[s.basisObjectId],g.splice(I(g,h),1)),delete d[s.basisObjectId],f&&s.removeHandler(f,this);if(m)for(var t in d)h=d[t],g.splice(I(g,h),0,h)}if(n){m=!g.length;for(r=0;s=n[r];r++)h={object:s,value:this.rule(s)},
d[s.basisObjectId]=h,m?g.push(h):g.splice(I(g,h),0,h),f&&s.addHandler(f,this);m&&g.sort(U)}this.applyRule()}}},emit_rangeChanged:B("rangeChanged","oldOffset","oldLimit"),init:function(){this.index_=[];S.prototype.init.call(this)},setRange:function(a,b){var d=this.offset,g=this.limit,f=!1;if(d!=a||g!=b)this.offset=a,this.limit=b,f=this.applyRule(),this.emit_rangeChanged(d,g);return f},setOffset:function(a){return this.setRange(a,this.limit)},setLimit:function(a){return this.setRange(this.offset,a)},
setRule:function(a,b){a=t(a);this.orderDesc=!!b;if(this.rule!=a){for(var d=this.index_,g=0;g<d.length;g++)d[g].value=a(d[g].object);this.rule=a;d.sort(U)}return this.applyRule()},applyRule:function(){var a=this.offset,b=a+this.limit;this.orderDesc&&(a=this.index_.length-b,b=a+this.limit);for(var d=f.object.slice(this.members_),a=this.index_.slice(Math.max(0,a),Math.max(0,b)),b=[],g,k=0,h;h=a[k];k++){var m=h.object.basisObjectId;d[m]?delete d[m]:(b.push(h.object),this.members_[m]=h.object)}for(m in d)delete this.members_[m];
(g=v(b,u(d)))&&this.emit_itemsChanged(g);return g},destroy:function(){S.prototype.destroy.call(this);this.index_=null}});A=H(S,{className:A+".Cloud",subsetClass:r,subsetWrapperClass:Z,rule:t(P),ruleEvents:C(function(a){var b=this.sourceMap_,d=this.members_,g=a.basisObjectId,f=b[g].list,b=b[g].list={},g=this.rule(a),k,h=[],n=[],q;if(Array.isArray(g))for(var r=0;r<g.length;r++)(q=this.keyMap.get(g[r],!0))&&!q.has(a)&&(s=q.basisObjectId,b[s]=q,f[s]||(q.dataset.emit_itemsChanged({inserted:[a]}),d[s]?
d[s]++:(h.push(q),d[s]=1)));for(var s in f)b[s]||(q=f[s],q.dataset.emit_itemsChanged({deleted:[a]}),--d[s]||(delete d[s],n.push(q)));(k=v(h,n))&&this.emit_itemsChanged(k)},"update"),keyMap:null,map:k,listen:{source:{itemsChanged:function(a,b){var d=this.sourceMap_,g=this.members_,f=this.ruleEvents,k,h,n,q=[],s=[];J.setAccumulateState(!0);if(k=b.inserted)for(var r=0,t;t=k[r];r++){var u=this.rule(t),y={object:t,list:{}};d[t.basisObjectId]=y;if(Array.isArray(u))for(var C=0,c={};C<u.length;C++)(h=this.keyMap.get(u[C],
!0))&&!c[h.basisObjectId]&&(n=h.basisObjectId,c[n]=!0,y.list[n]=h,h.dataset.emit_itemsChanged({inserted:[t]}),g[n]?g[n]++:(q.push(h),g[n]=1));f&&t.addHandler(f,this)}if(k=b.deleted)for(r=0;t=k[r];r++){h=t.basisObjectId;u=d[h].list;delete d[h];for(n in u)h=u[n],h.dataset.emit_itemsChanged({deleted:[t]}),--g[n]||(delete g[n],s.push(h));f&&t.removeHandler(f,this)}J.setAccumulateState(!1);(b=v(q,s))&&this.emit_itemsChanged(b)}}},init:function(){this.keyMap&&!1!=this.keyMap instanceof n||(this.keyMap=
Q(this.keyMap,this.rule,this.subsetWrapperClass,this.subsetClass));S.prototype.init.call(this)},getSubset:function(a,b){return this.keyMap.get(a,b)},destroy:function(){S.prototype.destroy.call(this);this.keyMap.destroy();this.keyMap=null}});w.exports={createRuleEvents:C,Merge:L,Subtract:h,SourceDataset:S,MapFilter:M,Subset:E,Split:F,Slice:B,Cloud:A}},"4.js":function(h,w,f,E,F,A,H,Z){function v(f){if(0<f.basisGetterId_){var h="getter(";if("string"==typeof f.base)h+='"'+f.base.replace(/"/g,'\\"')+'"';
else if(f.mod)h+=v(f.base);else return v(f.base);f.mod&&(h="string"==typeof f.mod?h+(', "'+f.mod.replace(/"/g,'\\"')+'"'):h+(", "+v(f.mod)));return h+")"}return Function.prototype.toString.call(f)}w.exports={fn:function(h){var w=Function.prototype.toString.call(h),I=w.match(/^\s*function(\s+\S+)?\s*\((\s*(?:\S+|\/\*[^*]+\*\/)(\s*(?:,\s*\S+|\/\*[^*]+\*\/))*\s*)?(?:[\r\n]+[^\)]*)?\)/),U=w.replace(/^\s*\(?\s*function[^(]*\([^\)]*\)[^{]*\{|\}\s*\)?\s*$/g,"");h=v(h);var X=(I&&I[2]||"").replace(/\s*,\s*/g,
", ");I||f.dev.log("Function parse error: "+w);return{source:w,name:(I&&I[1]||"anonymous").trim(),fullname:name+"("+X+")",args:X,body:U,getter:h!=w?h:!1}}}},"5.js":function(h,w,f,E,F,A,H,Z){var v="undefined"!==typeof performance?performance:Date,C="webkitNow"in v?"webkitNow":"now";w.exports={time:function(f){return arguments.length?parseInt(v[C]()-f):v[C]()},test:function(f,h){for(var v=this.time(),w=0;w<f;w++)h(w);return this.time(v)}}},"6.js":function(h,w,f,E,F,A,H,Z){var v=f.number.lead,C=f.string.repeat,
Q={};h={add:function(f,h){Q[f]=h}};h.add("text",f.array);h.add("js",function(){var f=RegExp("\\b(break|case|catch|continue|default|delete|do|else|false|for|function|if|in|instanceof|new|null|return|super|switch|this|throw|true|try|typeof|var|while|with)\\b","g");return function(h){function v(k,q,t,n){s!=q&&u.push(h.substring(s,q).replace(f,'<span class="token-keyword">$1</span>'));s=t+1;k&&u.push('<span class="token-'+k+'">'+h.substring(q,t+1)+"</span>"+(n||""))}for(var u=[],t=h.split(""),k,s=0,w,
q=0;q<t.length;q++)if("'"==t[q]||'"'==t[q])for(w=t[q],k=q;++q<t.length;){"\\"==t[q]&&("\n"==t[q+1]?(v("string",k,q),k=++q+1):q+=2);if(t[q]==w){v("string",k,q);break}if("\n"==t[q])break}else if("/"==t[q])if(k=q,q++,"/"==t[q]){for(;++q<t.length&&"\n"!=t[q];);v("comment",k,q-1)}else if("*"==t[q])for(;++q<t.length;)if("*"==t[q]&&"/"==t[q+1]){v("comment",k,++q);break}else"\n"==t[q]&&(v("comment",k,q-1,"\n"),s=k=q+1);v(null,h.length);return u}}());h.add("css",function(){var f=RegExp("(^|[^a-z0-9-])((?:-webkit-|-o-|-ms-|-moz-|-khtml-)?(?:transition|transition-delay|transition-duration|transition-property|transition-timing-function|transform|transform-origin|background-origin|background-clip|background-size|border-image|border-image-outset|border-image-repeat|border-image-slice|border-image-source|border-image-width|border-radius|border-top-right-radius|border-bottom-right-radius|border-bottom-left-radius|border-top-left-radius|box-decoration-break|box-shadow|column-count|column-fill|column-gap|column-rule|column-rule-color|column-rule-style|column-rule-width|columns|column-span|column-width)|(?:azimuth|background-attachment|background-color|background-image|background-position|background-repeat|background|border-collapse|border-color|border-spacing|border-style|border-top|border-right|border-bottom|border-left|border-top-color|border-right-color|border-bottom-color|border-left-color|border-top-style|border-right-style|border-bottom-style|border-left-style|border-top-width|border-right-width|border-bottom-width|border-left-width|border-width|border|bottom|caption-side|clear|clip|color|content|counter-increment|counter-reset|cue-after|cue-before|cue|cursor|direction|display|elevation|empty-cells|float|font-family|font-size|font-style|font-variant|font-weight|font|height|left|letter-spacing|line-height|list-style-image|list-style-position|list-style-type|list-style|margin-right|margin-left|margin-top|margin-bottom|margin|max-height|max-width|min-height|min-width|orphans|outline-color|outline-style|outline-width|outline|overflow|padding-top|padding-right|padding-bottom|padding-left|padding|page-break-after|page-break-before|page-break-inside|pause-after|pause-before|pause|pitch-range|pitch|play-during|position|quotes|richness|right|speak-header|speak-numeral|speak-punctuation|speak|speech-rate|stress|table-layout|text-align|text-decoration|text-indent|text-transform|top|unicode-bidi|vertical-align|visibility|voice-family|volume|white-space|widows|width|word-spacing|z-index))(s|:|$)",
"gi"),h=RegExp("\\b(left-side|far-left|left|center-left|center-right|center|far-right|right-side|right|behind|leftwards|rightwards|inherit|scroll|fixed|transparent|none|repeat-x|repeat-y|repeat|no-repeat|collapse|separate|auto|top|bottom|both|open-quote|close-quote|no-open-quote|no-close-quote|crosshair|default|pointer|move|e-resize|ne-resize|nw-resize|n-resize|se-resize|sw-resize|s-resize|text|wait|help|ltr|rtl|inline|block|list-item|run-in|compact|marker|table|inline-table|table-row-group|table-header-group|table-footer-group|table-row|table-column-group|table-column|table-cell|table-caption|below|level|above|higher|lower|show|hide|caption|icon|menu|message-box|small-caption|status-bar|normal|wider|narrower|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded|italic|oblique|small-caps|bold|bolder|lighter|inside|outside|disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman|lower-greek|lower-alpha|lower-latin|upper-alpha|upper-latin|hebrew|armenian|georgian|cjk-ideographic|hiragana|katakana|hiragana-iroha|katakana-iroha|crop|cross|invert|visible|hidden|always|avoid|x-low|low|medium|high|x-high|static|relative|absolute|portrait|landscape|spell-out|once|digits|continuous|code|x-slow|slow|fast|x-fast|faster|slower|justify|underline|overline|line-through|blink|capitalize|uppercase|lowercase|embed|bidi-override|baseline|sub|super|text-top|middle|text-bottom|silent|x-soft|soft|loud|x-loud|pre|nowrap|serif|sans-serif|cursive|fantasy|monospace|empty|string|strict|loose|char|true|false|dotted|dashed|solid|double|groove|ridge|inset|outset|larger|smaller|xx-small|x-small|small|large|x-large|xx-large|all|newspaper|distribute|distribute-all-lines|distribute-center-last|inter-word|inter-ideograph|inter-cluster|kashida|ideograph-alpha|ideograph-numeric|ideograph-parenthesis|ideograph-space|keep-all|break-all|break-word|lr-tb|tb-rl|thin|thick|inline-block|w-resize|hand|distribute-letter|distribute-space|whitespace|ignore)\\b",
"g");return function(v){function u(k,n,q,s){if(w!=n){var u=v.substring(w,n);B&&(u=y?u.replace(h,'<span class="token-value">$1</span>'):u.replace(f,'$1<span class="token-key">$2</span>$3'));t.push(u)}w=q+1;k&&t.push('<span class="token-'+k+'">'+v.substring(n,q+1)+"</span>"+(s||""))}for(var t=[],k=v.split(""),s=0,w=0,q,B=!1,y=!1,A=!1,n=0;n<k.length;n++)if("'"==k[n]||'"'==k[n])for(q=k[n],s=n;++n<k.length;){if(k[n]==q){u("string",s,n);break}if("\n"==k[n])break;"\\"==k[n]&&"\n"==k[n+1]&&(u("string",s,
n),s=++n+1)}else if("/"==k[n]){if(s=n,n++,"*"==k[n])for(;++n<k.length;)if("*"==k[n]&&"/"==k[n+1]){u("comment",s,++n);break}else"\n"==k[n]&&(u("comment",s,n-1,"\n"),w=s=n+1)}else"{"==k[n]?(B=!0,A=y=!1,s=n+1,u("",s,n)):"("==k[n]?y&&(A=!0):")"==k[n]?y&&(A=!1):":"==k[n]?B&&!A&&(s=n+1,u("",s,n),y=!0):";"==k[n]?B&&!A&&(s=n+1,u("",s,n),y=!1):"}"==k[n]&&(y=B=!1);u(null,v.length);return t}}());w.exports={highlight:function(f,h,w){w||(w={});f=(Q[h]||Q.text)(function(f){f=f.trimRight().replace(/\r\n|\n\r|\r/g,
"\n");w.keepFormat||(f=f.replace(/^(?:\s*[\n]+)+?([ \t]*)/,"$1"));f=f.replace(/\n[ \t]+/g,function(f){return f.replace(/\t/g,"  ")}).replace(/\n[ \t]+\n/g,"\n\n");if(!w.keepFormat){for(var h=1E3,k=f.split(/\n+/),t=Number(null!=f.match(/^function/));t<k.length;t++){var u=k[t].match(/^\s*/);u[0].length<h&&(h=u[0].length);if(0==h)break}0<h&&(f=f.replace(RegExp("(^|\\n) {"+h+"}","g"),"$1"))}return f=f.replace(RegExp("(^|\\n)( +)","g"),function(f,h,k){return h+C(" ",k.length)})}(f||"").replace(/</g,"&lt;")).join("").split("\n");
h=String(f.length).length;for(var u=[],t=w.noLineNumber?"":" hasLineNumber",k=0;k<f.length;k++)u.push('<div class="line '+(k%2?"odd":"even")+t+'"><span class="lineContent">'+(w.noLineNumber?"":'<input class="lineNumber" value="'+v(k+1,h)+'" type="none" unselectable="on" readonly="readonly" tabindex="-1" /><span class="over"></span>')+(f[k]+"\r\n")+"</span></div>");return u.join("")},useStyle:f.fn.runOnce(function(){f.resource("./0.css")().startUse()})}}};(function(h){function w(a,b){for(var l in b)a[l]=
b[l];return a}function f(a,b){for(var l in b)!1==l in a&&(a[l]=b[l]);return a}function E(a){var b=[],l;for(l in a)b.push(l);return b}function F(a,b){var l={};if(!b)return w(l,a);for(var c=0,d;d=b[c++];)d in a&&(l[d]=a[d]);return l}function A(){return u(arguments).reduce(w,{})}function H(a,b,l){var c=[],d;for(d in a)c.push(b.call(l,d,a[d]));return c}function Z(a){return a}function v(){}function C(a){var b=d[a.url];if(b)for(var c=0;c<b.length;c++)b[c](a.get(),a.url)}function Q(a,b,c){try{return new Function(b,
c)}catch(d){B.error("Compilation error at "+a+("line"in d?":"+(d.line-1):"")+": "+d)}}function I(a){var b=a.split(".")[0],c=a.replace(/\./g,"/")+".js";!1==a in K&&(!1==b in $&&($[b]=r.baseURI),b==a&&(ea[$[b]+c]=b),K[a]=$[b]+c);return K[a]}function U(a){a=a.split(".");var b;b=a[0];var c=m[b];c||(c=m[b]=new T(b),c.namespaces_={},c.namespaces_[b]=c,J.noConflict||(h[b]=c));for(var c=b=c,d=1,f;f=a[d];d++){if(!c[f]){var g=a.slice(0,d+1).join(".");c[f]=new T(g);b.namespaces_[g]=c[f]}c=c[f]}return m[a.join(".")]=
c}function X(a,b){if(J.extProto)for(var c in b)a.prototype[c]=function(a,e){return function(){var e=[this];Array.prototype.push.apply(e,arguments);return b[a].apply(b,e)}}(c,a.name||a.toString().match(/^\s*function\s*(\w*)\s*\(/)[1])}function u(a,b){if(null!=a){var c=a.length;if("undefined"==typeof c||"[object Function]"==s.call(a))return[a];b||(b=0);if(0<c-b){for(var d=[],f=0,g=b;g<c;)d[f++]=a[g++];return d}}return[]}function t(a,b,c){for(var d=[],f="function"==typeof b,g=0;g<a;g++)d[g]=f?b.call(c,
g,d):b;return d}var k=h.document,s=Object.prototype.toString,P=function(){function a(e){if(c.test(e)){var b=e.split("."),d=b[0],f=b[1],g=b[2];switch(b.length){case 1:e=function(a){return null!=a?a[d]:a};break;case 2:e=function(a){return null!=a?a[d][f]:a};break;case 3:e=function(a){return null!=a?a[d][f][g]:a};break;default:e=function(a){if(null!=a){a=a[d][f][g];for(var e=3,c;c=b[e];e++)a=a[c]}return a}}return e}return new Function("object","return object != null ? object."+e+" : object")}var b=1,
c=/^[a-z$_][a-z$_0-9]*(\.[a-z$_][a-z$_0-9]*)*$/i,d=[],f={},g={};return function(c,l){var h,k,m;if(!c||c===q)return q;"function"==typeof c?(m=c.basisGetterId_)?h=d[Math.abs(m)-1]:(h=function(a){return c(a)},h.base=c,h.__extend__=P,m=d.push(h),c.basisGetterId_=-m,h.basisGetterId_=m):(h=f[c])?m=h.basisGetterId_:(h=a(c),h.base=c,h.__extend__=P,m=d.push(h),h.basisGetterId_=m,f[c]=h);k=null!=l&&typeof l;if(!k)return h;var n=g[m],p;if("string"==k)p=k+l;else if("function"==k)p=l.basisModId_;else if("object"!=
k)return h;if(p&&n&&n[p])return n[p];"function"==typeof h.base&&(h=h.base);switch(k){case "string":k=function(a){return ba.format(l,h(a))};break;case "function":p||(p=k+b++,l.basisModId_=p);k=function(a){return l(h(a))};break;default:k=function(a){return l[h(a)]}}k.base=h.base||h;k.__extend__=P;p&&(n||(n={},g[m]=n),n[p]=k,k.mod=l,k.basisGetterId_=d.push(k));return k}}(),q=w(function(){},{__extend__:P}),B=function(){var a={log:v,info:v,warn:v,error:v};"undefined"!=typeof console&&H(a,function(b){a[b]=
"bind"in Function.prototype&&"function"==typeof console[b]?Function.prototype.bind.call(console[b],console):function(){Function.prototype.apply.call(console[b],console,arguments)}});return a}(),y=h.setImmediate||h.msSetImmediate,O=h.clearImmediate||h.msSetImmediate;y&&(y=y.bind(h));O&&(O=O.bind(h));y||function(){var a=function(){var a={},e=1;y=function(){a[++e]={fn:arguments[0],args:u(arguments,1)};b(e);return e};O=function(e){delete a[e]};return function(e){var b=a[e];if(b)try{"function"==typeof b.fn?
b.fn.apply(void 0,b.args):(h.execScript||function(a){h.eval.call(h,a)})(String(b.fn))}finally{delete a[e]}}}(),b=function(b){setTimeout(function(){a(b)},0)};if(h.process&&"function"==typeof process.nextTick)b=function(b){process.nextTick(function(){a(b)})};else if(h.MessageChannel)b=function(b){var c=new h.MessageChannel;c.port1.onmessage=function(){a(b)};c.port2.postMessage("")};else{var c=h.postMessage&&!h.importScripts;if(c){var d=h.onmessage;h.onmessage=function(){c=!1};h.postMessage("","*");
h.onmessage=d}if(c)d=function(b){b&&b.source==h&&(b=String(b.data).split("basisjs.setImmediate")[1])&&a(b)},h.addEventListener?h.addEventListener("message",d,!0):h.attachEvent("onmessage",d),b=function(a){h.postMessage("basisjs.setImmediate"+a,"*")};else if(k&&"onreadystatechange"in k.createElement("script"))var f=b,b=function oa(c){"undefined"!=typeof W&&(b=f,W.head.ready(function(){b=function(b){var c=k.createElement("script");c.onreadystatechange=function(){a(b);c.onreadystatechange=null;W.remove(c);
c=null};W.head.add(c)}}));b===oa?f(c):b(c)}}}();var n="object"==typeof process&&"[object process]"==s.call(process),r=function(){var a=/^([^\/]+:|\/)/,b=/^[a-zA-Z0-9\-]+:\/?/,c=/^(?:[a-zA-Z0-9\-]+:)?\/\/[^\/]+\/?/,d=/[\?#].*$/,f={},g="",h;n?(g=require("path").resolve(".").replace(/\\/g,"/"),h=g.replace(/^[^\/]*/,""),g=g.replace(/\/.*/,"")):(h=location.pathname.replace(/[^\/]+$/,""),g=location.protocol+"//"+location.host);return f={baseURI:h,origin:g,normalize:function(a){a=(a||"").replace(b,"/").replace(c,
"/").replace(d,"");for(var e=[],f=a.split("/"),g=0;g<f.length;g++)".."==f[g]?(1<e.length||e[0])&&e.pop():!f[g]&&g||"."==f[g]||e.push(f[g]);return e.join("/")||("/"===a[0]?"/":"")},dirname:function(a){a=f.normalize(a);return a.replace(/\/([^\/]*)$|^[^\/]+$/,"")||("/"==a[0]?"/":".")},extname:function(a){return(a=f.normalize(a).match(/[^\/](\.[^\/\.]*)$/))?a[1]:""},basename:function(a,e){var b=f.normalize(a).match(/[^\\\/]*$/),b=b?b[0]:"";e==f.extname(b)&&(b=b.substring(0,b.length-e.length));return b},
resolve:function(b,c){for(var d=u(arguments).reverse(),l=[],g=!1,k=0;!g&&k<d.length;k++)"string"==typeof d[k]&&(l.unshift(d[k]),g=a.test(d[k]));g||l.unshift("/"==h?"":h);return f.normalize(l.join("/"))},relative:function(a,e){"string"!=typeof e&&(e=a,a=h);a=f.normalize(a);e=f.normalize(e);if("/"==a[0]&&"/"!=e[0])return a;if("/"==e[0]&&"/"!=a[0])return e;for(var b=a.replace(/^\/$/,"").split(/\//),c=e.replace(/^\/$/,"").split(/\//),d=[],l=0;c[l]==b[l]&&"string"==typeof b[l];)l++;for(b=b.length-l;0<
b;b--)d.push("..");return d.concat(c.slice(l).filter(Boolean)).join("/")}}}(),J={path:{basis:""}},L=function(){function a(e){return"function"==typeof e&&!!e.basisClassId_}function b(a){for(var e=this;e&&e!==a;)e=e.superClass_;return e===a}function c(k,n){var p=g++;"function"!=typeof k&&(k=m);var q=function(){};q.prototype=k.prototype;for(var q=new q,p={basisClassId_:p,superClass_:k,extendConstructor_:!!k.extendConstructor_,isSubclassOf:b,subclass:function(){return c.apply(null,[s].concat(u(arguments)))},
extend:d,__extend__:function(b){return b&&b!==h&&("object"==typeof b||"function"==typeof b&&!a(b))?m.create.call(null,s,b):b},prototype:q},r=1,t;t=arguments[r];r++)p.extend(t);var s=p.extendConstructor_?function(a){this.basisObjectId=f.id++;var e,b;for(b in a)e=this[b],this[b]=e&&e.__extend__?e.__extend__(a[b]):a[b];this.init();this.postInit()}:function(){this.basisObjectId=f.id++;this.init.apply(this,arguments);this.postInit()};q.constructor=s;for(var v in q)q[v]===h&&(q[v]=s);w(s,p);return s}function d(b){var c=
this.prototype;"function"!=typeof b||a(b)||(b=b(this.superClass_.prototype));b.prototype&&(b=b.prototype);for(var l in b){var f=b[l],g=c[l];"className"==l||"extendConstructor_"==l?this[l]=f:c[l]=g&&g.__extend__?g.__extend__(f):f}k&&b[l="toString"]!==s&&(c[l]=b[l]);return this}var f={id:1},g=1,h={},k=function(){for(var a in{toString:1})return!1;return!0}(),m=w(c,{className:"basis.Class",extendConstructor_:!1,prototype:{basisObjectId:0,constructor:null,init:function(){},postInit:function(){},destroy:function(){for(var a in this)hasOwnProperty.call(this,
a)&&(this[a]=null);this.destroy=v}}}),n=function(a,b,e){return{__extend__:function(a){if(!a||a&&a.__extend__)return a;var e=function(){};e.prototype=this;e=new e;b(e,a);return e}}.__extend__(a||{})},p=function(a){return n(a,w,"extensibleProperty")};return w(m,{SELF:h,create:c,isClass:a,customExtendProperty:n,extensibleProperty:p,nestedExtendProperty:function(a){return n(a,function(a,b){for(var e in b){var c=a[e];a[e]=c&&c.__extend__?c.__extend__(b[e]):p(b[e])}},"nestedExtendProperty")},oneFunctionProperty:function(a,
b){var e=function(b){var c={__extend__:e};if(b){if(b.__extend__)return b;for(var d in b)b[d]&&(c[d]=a)}return c};return e(b||{})}})}(),D=L(null,{className:"basis.Token",value:null,handler:null,deferredToken:null,bindingBridge:{attach:function(a,b,c){a.attach(b,c)},detach:function(a,b,c){a.detach(b,c)},get:function(a){return a.get()}},init:function(a){this.value=a},get:function(){return this.value},set:function(a){this.value!==a&&(this.value=a,this.apply())},attach:function(a,b){this.handler={fn:a,
context:b,handler:this.handler}},detach:function(a,b){for(var c=this,d;d=c,c=c.handler;)if(c.fn===a&&c.context===b){c.fn=v;d.handler=c.handler;break}},apply:function(){for(var a=this.get(),b=this;b=b.handler;)b.fn.call(b.context,a)},deferred:function(){var a=this.deferredToken;a||(a=this.deferredToken=new da.DeferredToken(this.value),this.attach(a.set,a));return a},destroy:function(){this.deferredToken&&(this.deferredToken.destroy(),this.deferredToken=null);this.value=this.handler=null;this.detach=
this.attach=v}}),S=function(){function a(){var e=b;b={};c=null;for(var d in e)e[d].apply()}var b={},c;return function(d){d.basisObjectId in b||(b[d.basisObjectId]=d,c||y(a))}}(),M=D.subclass({className:"basis.DeferredToken",set:function(a){this.value!==a&&(this.value=a,S(this))},deferred:function(){return this}}),a={},b={},d={};(function(){var a="undefined"!=typeof la?la:null;if(a){for(var c in a)b[r.resolve(c)]=a[c];la=null}})();var g=function(a,c){if(c||!b.hasOwnProperty(a)){var d="";if(n)try{d=
require("fs").readFileSync(a,"utf-8")}catch(f){}else{var g=new XMLHttpRequest;g.open("GET",a,!1);g.setRequestHeader("If-Modified-Since",(new Date(0)).toGMTString());g.setRequestHeader("X-Basis-Resource",1);g.send("");200<=g.status&&400>g.status&&(d=g.responseText)}b[a]=d}return b[a]},p=function(e){e=r.resolve(e);if(!a[e]){var c=p.extensions[r.extname(e)],d=!1,f=!1,h,k=function(){if(d)return h;var a=g(e);c?f||(f=!0,h=c(a,e)):h=a;d=!0;C(k);k.apply();return h};w(k,w(new D,{url:e,fetch:function(){return k()},
toString:function(){return"[basis.resource "+e+"]"},isResolved:function(){return d},update:function(a){a=String(a);d&&a==b[e]||(b[e]=a,c?f&&!c.permanent&&(h=c(a,e),C(k),k.apply()):(h=a,d=!0,C(k),k.apply()))},reload:function(){var a=b[e],c=g(e,!0);c!=a&&(d=!1,k.update(c))},get:function(a){return a?g(e):k()},ready:function(a,b){if(d&&(a.call(b,k()),c&&c.permanent))return;k.attach(a,b);return k}}));a[e]=k}return a[e]};w(p,{isResource:function(b){return b?a[b.url]===b:!1},isResolved:function(a){return(a=
p.get(a))?a.isResolved():!1},exists:function(b){return a.hasOwnProperty(r.resolve(b))},get:function(a){a=r.resolve(a);return p.exists(a)?p(a):null},getFiles:function(e){return E(e?b:a).map(r.relative)},extensions:{".js":w(function(a,b){var c=ea[b];if(!c){var d=!0,c=r.dirname(b)+"/"+r.basename(b,r.extname(b)),g;for(g in J.path){var h=J.path[g]+g+"/";if(b.substr(0,h.length)==h){d=!1;c=c.substr(J.path[g].length);break}}c=c.replace(/\./g,"_").replace(/^\//g,"").replace(/\//g,".");d&&(c="implicit."+c)}m[c]||
(g=U(c),g.exports=z({path:g.path,exports:g.exports},b,a).exports,g.exports&&g.exports.constructor===Object&&f(g,g.exports));return m[c].exports},{permanent:!0}),".css":function(a,b){var c=ga.resources[b];c?c.updateCssText(a):c=new ga(b);return c},".json":function(a,b){if("object"==typeof a)return a;var c;try{a=String(a),c=da.json.parse(a)}catch(d){}return c||null}}});var z=function(a,b,c){var d=r.dirname(b)+"/",f=c;a.exports||(a.exports={});"function"!=typeof f&&(f=Q(b,"exports module basis global __filename __dirname resource require".split(" "),
'"use strict";\n'+c));"function"==typeof f&&f.call(a.exports,a.exports,a,da,h,b,d,function(a){return p(r.resolve(d,a))},function(a,b){return V(a,b||d)});return a},m={},K={},ea={},$=F(J.path);(function(a){if(a="undefined"!=typeof ma?ma:null)for(var b in a){var c=r.resolve(b),d=a[b];ea[c]=d;K[d]=c}})();var T=L(null,{className:"basis.Namespace",init:function(a){this.name=a;this.exports={path:this.name}},toString:function(){return"[basis.namespace "+this.path+"]"},extend:function(a){w(this.exports,a);
return f(this,a)}}),V=function(){if(n){var a=module.constructor.prototype;return function(b,c){if(/[^a-z0-9_\.]/i.test(b)&&".js"!=r.extname(b))return b=r.resolve(c,b),require(b);var d=a._compile,g=U(b);a._compile=function(a,b){this.basis=da;a='var node_require = require;\nvar basis = module.basis;\nvar resource = function(filename){ return basis.resource(__dirname + "/" + filename) };\nvar require = function(filename, baseURI){ return basis.require(filename, baseURI || __dirname) };\n'+a;d.call(w(this,
g),a,b)};var h=require(__dirname+"/"+b.replace(/\./g,"/"));(g.exports=h)&&h.constructor===Object&&f(g,h);a._compile=d;return h}}return function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==r.extname(a)?r.resolve(b,a):I(a);return p(a).fetch()}}();f(Function.prototype,{bind:function(a){var b=this,c=u(arguments,1);return c.length?function(){return b.apply(a,c.concat.apply(c,arguments))}:function(){return b.apply(a,arguments)}}});f(Array,{isArray:function(a){return"[object Array]"===s.call(a)}});f(Array.prototype,
{indexOf:function(a,b){b=parseInt(b,10)||0;if(0>b)return-1;for(;b<this.length;b++)if(this[b]===a)return b;return-1},lastIndexOf:function(a,b){var c=this.length;b=parseInt(b,10);for(b=isNaN(b)||b>=c?c-1:(b+c)%c;0<=b;b--)if(this[b]===a)return b;return-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},every:function(a,b){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0},some:function(a,b){for(var c=0,d=this.length;c<
d;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1},filter:function(a,b){for(var c=[],d=0,f=this.length;d<f;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);return c},map:function(a,b){for(var c=[],d=0,f=this.length;d<f;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c},reduce:function(a,b){var c=this.length,d=arguments.length;if(0==c&&1==d)throw 1;var f,g=0;1<d&&(f=b,g=1);for(d=0;d<c;d++)d in this&&(f=g++?a.call(null,f,this[d],d,this):this[d]);return f}});var Y={flatten:function(a){return a.concat.apply([],
a)},repeat:function(a,b){return Y.flatten(t(parseInt(b,10)||0,a))},search:function(a,b,c,d){a.lastSearchIndex=-1;c=P(c||Z);d=parseInt(d,10)||0;for(var f=a.length;d<f;d++)if(c(a[d])===b)return a[a.lastSearchIndex=d]},lastSearch:function(a,b,c,d){a.lastSearchIndex=-1;c=P(c||Z);var f=a.length;d=isNaN(d)||null==d?f:parseInt(d,10);for(f=d>f?f:d;0<f--;)if(c(a[f])===b)return a[a.lastSearchIndex=f]},add:function(a,b){return-1==a.indexOf(b)&&!!a.push(b)},remove:function(a,b){var c=a.indexOf(b);return-1!=c&&
!!a.splice(c,1)},has:function(a,b){return-1!=a.indexOf(b)},sortAsObject:function(a,b,c,d){b=P(b);d=d?-1:1;return a.map(function(a,c){return{i:c,v:b(a)}}).sort(c||function(a,b){return d*(a.v>b.v||-(a.v<b.v)||(a.i>b.i?1:-1))}).map(function(b){return a[b.i]},a)}};X(Array,Y);if(![1,2].splice(1).length){var fa=Array.prototype.splice;Array.prototype.splice=function(){var a=u(arguments);2>a.length&&(a[1]=this.length);return fa.apply(this,a)}}var ca=/([\/\\\(\)\[\]\?\{\}\|\*\+\-\.\^\$])/g,c=/\{([a-z\d_]+)(?::([\.0])(\d+)|:(\?))?\}/gi;
f(String,{toLowerCase:function(a){return String(a).toLowerCase()},toUpperCase:function(a){return String(a).toUpperCase()},trim:function(a){return String(a).trim()},trimLeft:function(a){return String(a).trimLeft()},trimRight:function(a){return String(a).trimRight()}});f(String.prototype,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});var ba={toObject:function(a,b){try{return(new Function("return 0,"+
a))()}catch(c){if(b)throw 2;}},repeat:function(a,b){return Array(parseInt(b,10)+1||0).join(a)},qw:function(a){return(a=a.trim())?a.split(/\s+/):[]},forRegExp:function(a){return a.replace(ca,"\\$1")},format:function(a,b){var d=u(arguments,1);"object"==typeof b&&w(d,b);return a.replace(c,function(a,b,c,e,f){a=b in d?d[b]:f?"":a;return c&&!isNaN(a)?(a=Number(a),"."==c?a.toFixed(e):aa.lead(a,e)):a})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},camelize:function(a){return a.replace(/-(.)/g,
function(a,b){return b.toUpperCase()})},dasherize:function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}};X(String,ba);if(11!="|||".split(/\|/).length+"|||".split(/(\|)/).length){var x=String.prototype.split;String.prototype.split=function(a,b){if(!a||!1==a instanceof RegExp||""==a.source)return x.apply(this,arguments);var c=[],d=0,f;for(a.global||(a=RegExp(a.source,/\/([mi]*)$/.exec(a)[1]+"g"));f=a.exec(this);)f[0]=this.substring(d,f.index),c.push.apply(c,f),d=a.lastIndex;
c.push(this.substr(d));return c}}if("2"!="12".substr(-1)){var ia=String.prototype.substr;String.prototype.substr=function(a,b){return ia.call(this,0>a?Math.max(0,this.length+a):a,b)}}var aa={fit:function(a,b,c){return!isNaN(b)&&a<b?Number(b):!isNaN(c)&&a>c?Number(c):a},lead:function(a,b,c){return String(a).replace(/\d+/,function(a){return 1<(b-=a.length-1)?Array(b).join(c||0)+a:a})},group:function(a,b,c){return String(a).replace(/\d+/,function(a){return a.replace(/\d/g,function(d,e){return!e+(a.length-
e)%(b||3)?d:(c||" ")+d})})},format:function(a,b,c,d,f,g){a=a.toFixed(b);if(c||g)a=a.replace(/(\d+)(\.?)/,function(a,b,d){return(c?da.number.group(Number(b),3,c):b)+(d?g||d:"")});d&&(a=a.replace(/^-?/,"$&"+(d||"")));return a+(f||"")}};X(Number,aa);f(Date,{now:function(){return Number(new Date)}});var ja=function(){function a(){if("complete"==k.readyState&&k.body&&!c++)for(;d;)d.callback.call(d.context),d=d.next}function b(){try{k.documentElement.doScroll("left"),a()}catch(c){setTimeout(b,1)}}var c=
!k||"complete"==k.readyState&&!!k.body,d;if(!c)if(k.addEventListener)k.addEventListener("DOMContentLoaded",a,!1),h.addEventListener("load",a,!1);else{k.attachEvent("onreadystatechange",a);h.attachEvent("onload",a);try{!h.frameElement&&k.documentElement.doScroll&&b()}catch(f){}}return function(a,b){c?a.call(b):d={callback:a,context:b,next:d}}}(),W=function(){function a(b){if(k&&!g[b]&&(g[b]=k[b]||k.getElementsByTagName(b)[0],g[b])){var c=h[b];delete h[b];for(var d=0,e;e=c[d];d++)e[0].call(e[1],g[b])}return g[b]}
function b(){var d=this[0],f=this[1],g=this[2];c(f);var k=a(d);k?(!0===g&&(g=k.firstChild),g&&g.parentNode===k||(g=null),k.insertBefore(f,g)):h[d].push([b,[d,f,g]])}function c(a){for(var b in h){var d=Y.search(h[b],a,function(a){return a[1]&&a[1][1]});d&&Y.remove(h[b],d)}a&&a.parentNode&&1==a.parentNode.nodeType&&a.parentNode.removeChild(a)}function d(){f&&a("head")&&a("body")&&(f=clearInterval(f))}var f,g={},h={head:[],body:[]};!k||a("head")&&a("body")||(f=setInterval(d,5),ja(d));return{head:{ready:function(a,
b){h.head?h.head.push([a,b]):a.call(b,g.head)},add:function(a,c){b.call(["head",a,c])}},body:{ready:function(a,b){h.body?h.body.push([a,b]):a.call(b,g.body)},add:function(a,c){b.call(["body",a,c])}},remove:c}}(),ka=function(){function a(d){c.globalDestroy=!0;c.add=v;for(c.remove=v;d=b.pop();)if("function"==typeof d.destroy)try{d.destroy()}catch(e){}else for(var f in d)d[f]=null;b.length=0}var b=[];if("attachEvent"in h)h.attachEvent("onunload",a);else if("addEventListener"in h)h.addEventListener("unload",
a,!1);else return{add:v,remove:v};var c={add:function(a){null!=a&&b.push(a)},remove:function(a){Y.remove(b,a)}};return c}(),ga=function(){function a(b){m.setAttribute("href",b);W.head.add(m,!0)}function b(){m.setAttribute("href",location.href);W.remove(m)}function c(){a(this.baseURI);this.element||(this.element=k.createElement("style"),g||(this.textNode=this.element.appendChild(k.createTextNode(""))));W.head.add(this.element);this.syncCssText();b()}var d={},f=!0,g;try{g=!k.createElement("style").appendChild(k.createTextNode(""))}catch(h){g=
!0}ka.add({destroy:function(){f=!1;for(var a in d)d[a].destroy();d=null}});var m=k&&k.createElement("base"),n=L(null,{className:"basis.CssResource",inUse:0,url:"",baseURI:"",cssText:"",resource:null,element:null,textNode:null,init:function(a){this.url=r.resolve(a);this.baseURI=r.dirname(a)+"/";d[a]=this},updateCssText:function(c){this.cssText!=c&&(this.cssText=c,this.inUse&&this.element&&(a(this.baseURI),this.syncCssText(),b()))},syncCssText:function(){this.textNode?this.textNode.nodeValue=this.cssText:
this.element.styleSheet.cssText=this.cssText},startUse:function(){if(!this.inUse){if(!this.resource){var a=p(this.url);this.resource=a;this.cssText=a.get(!0)}W.head.ready(c,this)}this.inUse+=1},stopUse:function(){this.inUse&&(this.inUse-=1,!this.inUse&&this.element&&W.remove(this.element))},destroy:function(){this.element&&f&&W.remove(this.element);this.cssText=this.resource=this.textNode=this.element=null}});n.resources=d;return n}(),da=U("basis").extend({version:"1.2.0-dev",NODE_ENV:n,config:J,
platformFeature:{},resolveNSFilename:I,patch:function(a,b){a=/[^a-z0-9_\.]/i.test(a)||".js"==r.extname(a)?r.resolve(a):I(a);d[a]?d[a].push(b):d[a]=[b];var c=p.get(a);c&&c.isResolved()&&b(c.get(),c.url)},namespace:U,require:V,resource:p,asset:function(a){return a},setImmediate:y,clearImmediate:O,nextTick:function(){y.apply(null,arguments)},Class:L,Token:D,DeferredToken:M,getter:P,ready:ja,cleaner:ka,console:B,path:r,doc:W,object:{extend:w,complete:f,keys:E,values:function(a){var b=[],c;for(c in a)b.push(a[c]);
return b},slice:F,splice:function(a,b){var c={};if(!b)return w(c,a);for(var d=0,f;f=b[d++];)f in a&&(c[f]=a[f],delete a[f]);return c},merge:A,iterate:H},fn:{$undefined:function(a){return void 0==a},$defined:function(a){return void 0!=a},$isNull:function(a){return null==a||void 0==a},$isNotNull:function(a){return null!=a&&void 0!=a},$isSame:function(a){return a===this},$isNotSame:function(a){return a!==this},$self:Z,$const:function(a){return function(){return a}},$false:function(){return!1},$true:function(){return!0},
$null:function(){return null},$undef:v,getter:P,nullGetter:q,wrapper:function(a){return function(b){var c={};c[a]=b;return c}},lazyInit:function(a,b){var c=0,d,f;return d=function(){c++||(d.inited=!0,d.data=f=a.apply(b||this,arguments));return f}},lazyInitAndRun:function(a,b,c){var d=0,f,g;return f=function(){d++||(f.inited=!0,f.data=g=a.call(c||this));b.apply(g,arguments);return g}},runOnce:function(a,b){var c=0;return function(){if(!c++)return a.apply(b||this,arguments)}}},array:w(u,A(Y,{from:u,
create:t})),string:A(ba,{isEmpty:function(a){return null==a||""==String(a)},isNotEmpty:function(a){return null!=a&&""!=String(a)}}),number:aa,bool:{invert:function(a){return!a}},json:{parse:"undefined"!=typeof JSON?JSON.parse:function(a){return ba.toObject(a,!0)}}});U("basis.dev").extend(B);J.autoload&&V(J.autoload)})(this)}).call(this)